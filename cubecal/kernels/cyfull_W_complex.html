<!DOCTYPE html>
<!-- Generated by Cython 0.23.4 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: cyfull_W_complex.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.23.4</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="cyfull_W_complex.c">cyfull_W_complex.c</a></p>
<div class="cython"><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">001</span>: from cython.parallel import prange, parallel</pre>
<pre class='cython code score-11 '>  __pyx_t_17 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_17) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">002</span>: import numpy as np</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">003</span>: cimport numpy as np</pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: import cython</pre>
<pre class="cython line score-19" onclick='toggleDiv(this)'>+<span class="">005</span>: from scipy.optimize import fsolve</pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_fsolve);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_fsolve);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_fsolve);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_optimize, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_fsolve);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_fsolve, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick='toggleDiv(this)'>+<span class="">006</span>: from scipy import special</pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_special);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_special);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_special);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy, __pyx_t_2, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_special);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_special, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">007</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: ctypedef fused complex3264:</pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>:     np.complex64_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">010</span>:     np.complex128_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">011</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>: @cython.cdivision(True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">013</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">014</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">015</span>: @cython.nonecheck(False)</pre>
<pre class="cython line score-705" onclick='toggleDiv(this)'>+<span class="">016</span>: def cycompute_residual(np.ndarray[complex3264, ndim=8] m,</pre>
<pre class='cython code score-705 '>/* Python wrapper */
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_1cycompute_residual(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_cycompute_residual[] = "\n    This computes the residual, resulting in large matrix indexed by \n    (direction, model, time, frequency, antenna, antenna, correlation, correlation).\n    ";
static PyMethodDef __pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_1cycompute_residual = {"cycompute_residual", (PyCFunction)__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_1cycompute_residual, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_cycompute_residual};
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_1cycompute_residual(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_signatures = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED PyObject *__pyx_v_defaults = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fused_cpdef (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_signatures,&amp;__pyx_n_s_args,&amp;__pyx_n_s_kwargs,&amp;__pyx_n_s_defaults,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_signatures)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_args)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_kwargs)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_defaults)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_fused_cpdef") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_signatures = values[0];
    __pyx_v_args = values[1];
    __pyx_v_kwargs = values[2];
    __pyx_v_defaults = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_cycompute_residual(__pyx_self, __pyx_v_signatures, __pyx_v_args, __pyx_v_kwargs, __pyx_v_defaults);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_cycompute_residual(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_signatures, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs, CYTHON_UNUSED PyObject *__pyx_v_defaults) {
  PyObject *__pyx_v_dest_sig = NULL;
  PyTypeObject *__pyx_v_ndarray = 0;
  PyObject *__pyx_v_numpy = NULL;
  __Pyx_memviewslice __pyx_v_memslice;
  Py_ssize_t __pyx_v_itemsize;
  CYTHON_UNUSED int __pyx_v_dtype_signed;
  char __pyx_v_kind;
  PyObject *__pyx_v_arg = NULL;
  PyObject *__pyx_v_dtype = NULL;
  PyObject *__pyx_v_arg_base = NULL;
  PyObject *__pyx_v_candidates = NULL;
  PyObject *__pyx_v_sig = NULL;
  int __pyx_v_match_found;
  PyObject *__pyx_v_src_type = NULL;
  PyObject *__pyx_v_dst_type = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_residual", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kwargs);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, Py_None);
  __pyx_v_dest_sig = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_2 = (__pyx_v_kwargs == Py_None);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kwargs, __pyx_t_1);
    __pyx_t_1 = 0;
  }
  {
    /*try:*/ {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_v_numpy = __pyx_t_1;
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_numpy, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!(likely(<span class='py_c_api'>PyType_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "type", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      __pyx_v_ndarray = ((PyTypeObject*)__pyx_t_1);
      __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L11_try_end;
    __pyx_L4_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_ImportError) || <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_AttributeError) || <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_TypeError);
    if (__pyx_t_7) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_1, &amp;__pyx_t_8, &amp;__pyx_t_9) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L6_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ndarray, ((PyTypeObject*)Py_None));
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L5_exception_handled;
    }
    goto __pyx_L6_except_error;
    __pyx_L6_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    goto __pyx_L1_error;
    __pyx_L5_exception_handled:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    __pyx_L11_try_end:;
  }
  __pyx_v_itemsize = -1L;
  if (unlikely(__pyx_v_args == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = ((0 &lt; __pyx_t_10) != 0);
  if (__pyx_t_3) {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(((PyObject*)__pyx_v_args), 0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
    __pyx_v_arg = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L14;
  }
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyDict_ContainsTF</span>(__pyx_n_s_m, ((PyObject*)__pyx_v_kwargs), Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {
    if (unlikely(__pyx_v_kwargs == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_kwargs), __pyx_n_s_m);<span class='error_goto'> if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_v_arg = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L14;
  }
  /*else*/ {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_Expected_at_least_d_arguments, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_L14:;
  while (1) {
    __pyx_t_2 = (__pyx_v_ndarray != ((PyTypeObject*)Py_None));
    __pyx_t_3 = (__pyx_t_2 != 0);
    if (__pyx_t_3) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_arg, __pyx_v_ndarray); 
      __pyx_t_2 = (__pyx_t_3 != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_v_dtype = __pyx_t_8;
        __pyx_t_8 = 0;
        goto __pyx_L18;
      }
      __pyx_t_2 = (__pyx_memoryview_check(__pyx_v_arg) != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_base);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_v_arg_base = __pyx_t_8;
        __pyx_t_8 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_arg_base, __pyx_v_ndarray); 
        __pyx_t_3 = (__pyx_t_2 != 0);
        if (__pyx_t_3) {
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg_base, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_v_dtype = __pyx_t_8;
          __pyx_t_8 = 0;
          goto __pyx_L19;
        }
        /*else*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
          __pyx_v_dtype = Py_None;
        }
        __pyx_L19:;
        goto __pyx_L18;
      }
      /*else*/ {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
        __pyx_v_dtype = Py_None;
      }
      __pyx_L18:;
      __pyx_v_itemsize = -1L;
      __pyx_t_3 = (__pyx_v_dtype != Py_None);
      __pyx_t_2 = (__pyx_t_3 != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dtype, __pyx_n_s_itemsize);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_itemsize = __pyx_t_10;
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dtype, __pyx_n_s_kind);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Ord</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(__pyx_t_11 == (long)(Py_UCS4)-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_kind = __pyx_t_11;
        __pyx_v_dtype_signed = (__pyx_v_kind == 'i');
        switch (__pyx_v_kind) {
          case 'i':
          case 'u':
          break;
          case 'f':
          break;
          case 'c':
          __pyx_t_3 = (((sizeof(__pyx_t_float_complex)) == __pyx_v_itemsize) != 0);
          if (__pyx_t_3) {
          } else {
            __pyx_t_2 = __pyx_t_3;
            goto __pyx_L22_bool_binop_done;
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_3 = ((((Py_ssize_t)__pyx_t_10) == 8) != 0);
          __pyx_t_2 = __pyx_t_3;
          __pyx_L22_bool_binop_done:;
          if (__pyx_t_2) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            goto __pyx_L16_break;
          }
          __pyx_t_3 = (((sizeof(__pyx_t_double_complex)) == __pyx_v_itemsize) != 0);
          if (__pyx_t_3) {
          } else {
            __pyx_t_2 = __pyx_t_3;
            goto __pyx_L25_bool_binop_done;
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_3 = ((((Py_ssize_t)__pyx_t_10) == 8) != 0);
          __pyx_t_2 = __pyx_t_3;
          __pyx_L25_bool_binop_done:;
          if (__pyx_t_2) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            goto __pyx_L16_break;
          }
          break;
          case 'O':
          break;
          default: break;
        }
      }
    }
    __pyx_t_3 = ((__pyx_v_itemsize == -1L) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L28_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_itemsize == (sizeof(__pyx_t_float_complex))) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L28_bool_binop_done:;
    if (__pyx_t_2) {
      __pyx_v_memslice = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsdsdsdsds___pyx_t_float_complex</span>(__pyx_v_arg);
      __pyx_t_2 = (__pyx_v_memslice.memview != 0);
      if (__pyx_t_2) {
        __PYX_XDEC_MEMVIEW((&amp;__pyx_v_memslice), 1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L16_break;
      }
      /*else*/ {
        <span class='py_c_api'>PyErr_Clear</span>();
      }
    }
    __pyx_t_3 = ((__pyx_v_itemsize == -1L) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L32_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_itemsize == (sizeof(__pyx_t_double_complex))) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L32_bool_binop_done:;
    if (__pyx_t_2) {
      __pyx_v_memslice = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsdsdsdsds___pyx_t_double_complex</span>(__pyx_v_arg);
      __pyx_t_2 = (__pyx_v_memslice.memview != 0);
      if (__pyx_t_2) {
        __PYX_XDEC_MEMVIEW((&amp;__pyx_v_memslice), 1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L16_break;
      }
      /*else*/ {
        <span class='py_c_api'>PyErr_Clear</span>();
      }
    }
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, Py_None, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L16_break;
  }
  __pyx_L16_break:;
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_v_candidates = ((PyObject*)__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_10 = 0;
  if (unlikely(__pyx_v_signatures == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_9 = __Pyx_dict_iterator(((PyObject*)__pyx_v_signatures), 1, ((PyObject *)NULL), (&amp;__pyx_t_12), (&amp;__pyx_t_7));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __pyx_t_8 = __pyx_t_9;
  __pyx_t_9 = 0;
  while (1) {
    __pyx_t_13 = __Pyx_dict_iter_next(__pyx_t_8, __pyx_t_12, &amp;__pyx_t_10, &amp;__pyx_t_9, NULL, NULL, __pyx_t_7);
    if (unlikely(__pyx_t_13 == 0)) break;
    if (unlikely(__pyx_t_13 == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_sig, __pyx_t_9);
    __pyx_t_9 = 0;
    __pyx_v_match_found = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_sig, __pyx_n_s_strip);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_split);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dest_sig);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dest_sig);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_dest_sig);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_9 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_14 = 0;
      __pyx_t_15 = NULL;
    } else {
      __pyx_t_14 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_15 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_15)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_15(__pyx_t_9);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        PyObject* sequence = __pyx_t_1;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_16 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_17 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_16 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_17 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
        #else
        __pyx_t_16 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        __pyx_t_17 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_18 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_19 = Py_TYPE(__pyx_t_18)-&gt;tp_iternext;
        index = 0; __pyx_t_16 = __pyx_t_19(__pyx_t_18); if (unlikely(!__pyx_t_16)) goto __pyx_L39_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        index = 1; __pyx_t_17 = __pyx_t_19(__pyx_t_18); if (unlikely(!__pyx_t_17)) goto __pyx_L39_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_19(__pyx_t_18), 2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_19 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        goto __pyx_L40_unpacking_done;
        __pyx_L39_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_t_19 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_L40_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_src_type, __pyx_t_16);
      __pyx_t_16 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dst_type, __pyx_t_17);
      __pyx_t_17 = 0;
      __pyx_t_2 = (__pyx_v_dst_type != Py_None);
      __pyx_t_3 = (__pyx_t_2 != 0);
      if (__pyx_t_3) {
        __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_src_type, __pyx_v_dst_type, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (__pyx_t_3) {
          __pyx_v_match_found = 1;
          goto __pyx_L42;
        }
        /*else*/ {
          __pyx_v_match_found = 0;
          goto __pyx_L38_break;
        }
        __pyx_L42:;
      }
    }
    __pyx_L38_break:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_3 = (__pyx_v_match_found != 0);
    if (__pyx_t_3) {
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_candidates, __pyx_v_sig);<span class='error_goto'> if (unlikely(__pyx_t_20 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_3 = (__pyx_v_candidates != Py_None) &amp;&amp; (<span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates) != 0);
  __pyx_t_2 = ((!__pyx_t_3) != 0);
  if (__pyx_t_2) {
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s__3);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_12 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates);<span class='error_goto'> if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = ((__pyx_t_12 &gt; 1) != 0);
  if (__pyx_t_2) {
  __pyx_tuple__5 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_No_matching_signature_found);<span class='error_goto'> if (unlikely(!__pyx_tuple__5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__5);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(__pyx_v_signatures == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_signatures), <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_candidates, 0));<span class='error_goto'> if (unlikely(__pyx_t_8 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_r = __pyx_t_8;
    __pyx_t_8 = 0;
    goto __pyx_L0;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dest_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_numpy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dtype);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg_base);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_candidates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_src_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dst_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_17cycompute_residual(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_fuse_0__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_17cycompute_residual = {"__pyx_fuse_0cycompute_residual", (PyCFunction)__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_17cycompute_residual, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_cycompute_residual};
static PyObject *__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_17cycompute_residual(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_m = 0;
  PyArrayObject *__pyx_v_g = 0;
  PyArrayObject *__pyx_v_gh = 0;
  PyArrayObject *__pyx_v_o = 0;
  PyArrayObject *__pyx_v_r = 0;
  int __pyx_v_t_int;
  int __pyx_v_f_int;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_residual (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_m,&amp;__pyx_n_s_g,&amp;__pyx_n_s_gh,&amp;__pyx_n_s_o,&amp;__pyx_n_s_r,&amp;__pyx_n_s_t_int,&amp;__pyx_n_s_f_int,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_m)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_g)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_residual", 1, 7, 7, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_gh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_residual", 1, 7, 7, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_o)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_residual", 1, 7, 7, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_residual", 1, 7, 7, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_t_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_residual", 1, 7, 7, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_residual", 1, 7, 7, 6); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cycompute_residual") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_m = ((PyArrayObject *)values[0]);
    __pyx_v_g = ((PyArrayObject *)values[1]);
    __pyx_v_gh = ((PyArrayObject *)values[2]);
    __pyx_v_o = ((PyArrayObject *)values[3]);
    __pyx_v_r = ((PyArrayObject *)values[4]);
    __pyx_v_t_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_t_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_f_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]);<span class='error_goto'> if (unlikely((__pyx_v_f_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 22; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_residual", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_residual", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_m), __pyx_ptype_5numpy_ndarray, 1, "m", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_gh), __pyx_ptype_5numpy_ndarray, 1, "gh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_o), __pyx_ptype_5numpy_ndarray, 1, "o", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_r), __pyx_ptype_5numpy_ndarray, 1, "r", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_16cycompute_residual(__pyx_self, __pyx_v_m, __pyx_v_g, __pyx_v_gh, __pyx_v_o, __pyx_v_r, __pyx_v_t_int, __pyx_v_f_int);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_16cycompute_residual(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_m, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_gh, PyArrayObject *__pyx_v_o, PyArrayObject *__pyx_v_r, int __pyx_v_t_int, int __pyx_v_f_int) {
  int __pyx_v_d;
  int __pyx_v_i;
  int __pyx_v_t;
  int __pyx_v_f;
  int __pyx_v_aa;
  int __pyx_v_ab;
  int __pyx_v_rr;
  int __pyx_v_rc;
  int __pyx_v_n_dir;
  int __pyx_v_n_mod;
  int __pyx_v_n_tim;
  int __pyx_v_n_fre;
  int __pyx_v_n_ant;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_g;
  __Pyx_Buffer __pyx_pybuffer_g;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_gh;
  __Pyx_Buffer __pyx_pybuffer_gh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_m;
  __Pyx_Buffer __pyx_pybuffer_m;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_o;
  __Pyx_Buffer __pyx_pybuffer_o;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_r;
  __Pyx_Buffer __pyx_pybuffer_r;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_0cycompute_residual", 0);
  __pyx_pybuffer_m.pybuffer.buf = NULL;
  __pyx_pybuffer_m.refcount = 0;
  __pyx_pybuffernd_m.data = NULL;
  __pyx_pybuffernd_m.rcbuffer = &amp;__pyx_pybuffer_m;
  __pyx_pybuffer_g.pybuffer.buf = NULL;
  __pyx_pybuffer_g.refcount = 0;
  __pyx_pybuffernd_g.data = NULL;
  __pyx_pybuffernd_g.rcbuffer = &amp;__pyx_pybuffer_g;
  __pyx_pybuffer_gh.pybuffer.buf = NULL;
  __pyx_pybuffer_gh.refcount = 0;
  __pyx_pybuffernd_gh.data = NULL;
  __pyx_pybuffernd_gh.rcbuffer = &amp;__pyx_pybuffer_gh;
  __pyx_pybuffer_o.pybuffer.buf = NULL;
  __pyx_pybuffer_o.refcount = 0;
  __pyx_pybuffernd_o.data = NULL;
  __pyx_pybuffernd_o.rcbuffer = &amp;__pyx_pybuffer_o;
  __pyx_pybuffer_r.pybuffer.buf = NULL;
  __pyx_pybuffer_r.refcount = 0;
  __pyx_pybuffernd_r.data = NULL;
  __pyx_pybuffernd_r.rcbuffer = &amp;__pyx_pybuffer_r;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_m.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_m, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 8, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_m.diminfo[0].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_m.diminfo[0].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_m.diminfo[1].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_m.diminfo[1].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_m.diminfo[2].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_m.diminfo[2].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_m.diminfo[3].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_m.diminfo[3].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_m.diminfo[4].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_m.diminfo[4].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_m.diminfo[5].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_m.diminfo[5].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_m.diminfo[6].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_m.diminfo[6].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[6]; __pyx_pybuffernd_m.diminfo[7].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[7]; __pyx_pybuffernd_m.diminfo[7].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[7];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_g, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_g.diminfo[0].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_g.diminfo[0].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_g.diminfo[1].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_g.diminfo[1].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_g.diminfo[2].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_g.diminfo[2].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_g.diminfo[3].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_g.diminfo[3].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_g.diminfo[4].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_g.diminfo[4].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_g.diminfo[5].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_g.diminfo[5].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_gh, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_gh.diminfo[0].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_gh.diminfo[0].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_gh.diminfo[1].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_gh.diminfo[1].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_gh.diminfo[2].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_gh.diminfo[2].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_gh.diminfo[3].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_gh.diminfo[3].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_gh.diminfo[4].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_gh.diminfo[4].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_gh.diminfo[5].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_gh.diminfo[5].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_o.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_o, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 7, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_o.diminfo[0].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_o.diminfo[0].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_o.diminfo[1].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_o.diminfo[1].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_o.diminfo[2].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_o.diminfo[2].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_o.diminfo[3].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_o.diminfo[3].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_o.diminfo[4].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_o.diminfo[4].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_o.diminfo[5].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_o.diminfo[5].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_o.diminfo[6].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_o.diminfo[6].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[6];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_r, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 7, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_r.diminfo[0].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_r.diminfo[0].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_r.diminfo[1].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_r.diminfo[1].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_r.diminfo[2].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_r.diminfo[2].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_r.diminfo[3].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_r.diminfo[3].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_r.diminfo[4].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_r.diminfo[4].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_r.diminfo[5].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_r.diminfo[5].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_r.diminfo[6].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_r.diminfo[6].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[6];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_m.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_o.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_residual", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_m.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_o.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_19cycompute_residual(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_fuse_1__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_19cycompute_residual = {"__pyx_fuse_1cycompute_residual", (PyCFunction)__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_19cycompute_residual, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_cycompute_residual};
static PyObject *__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_19cycompute_residual(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_m = 0;
  PyArrayObject *__pyx_v_g = 0;
  PyArrayObject *__pyx_v_gh = 0;
  PyArrayObject *__pyx_v_o = 0;
  PyArrayObject *__pyx_v_r = 0;
  int __pyx_v_t_int;
  int __pyx_v_f_int;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_residual (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_m,&amp;__pyx_n_s_g,&amp;__pyx_n_s_gh,&amp;__pyx_n_s_o,&amp;__pyx_n_s_r,&amp;__pyx_n_s_t_int,&amp;__pyx_n_s_f_int,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_m)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_g)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_residual", 1, 7, 7, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_gh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_residual", 1, 7, 7, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_o)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_residual", 1, 7, 7, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_residual", 1, 7, 7, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_t_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_residual", 1, 7, 7, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_residual", 1, 7, 7, 6); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cycompute_residual") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_m = ((PyArrayObject *)values[0]);
    __pyx_v_g = ((PyArrayObject *)values[1]);
    __pyx_v_gh = ((PyArrayObject *)values[2]);
    __pyx_v_o = ((PyArrayObject *)values[3]);
    __pyx_v_r = ((PyArrayObject *)values[4]);
    __pyx_v_t_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_t_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_f_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]);<span class='error_goto'> if (unlikely((__pyx_v_f_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 22; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_residual", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_residual", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_m), __pyx_ptype_5numpy_ndarray, 1, "m", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_gh), __pyx_ptype_5numpy_ndarray, 1, "gh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_o), __pyx_ptype_5numpy_ndarray, 1, "o", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_r), __pyx_ptype_5numpy_ndarray, 1, "r", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_18cycompute_residual(__pyx_self, __pyx_v_m, __pyx_v_g, __pyx_v_gh, __pyx_v_o, __pyx_v_r, __pyx_v_t_int, __pyx_v_f_int);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_18cycompute_residual(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_m, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_gh, PyArrayObject *__pyx_v_o, PyArrayObject *__pyx_v_r, int __pyx_v_t_int, int __pyx_v_f_int) {
  int __pyx_v_d;
  int __pyx_v_i;
  int __pyx_v_t;
  int __pyx_v_f;
  int __pyx_v_aa;
  int __pyx_v_ab;
  int __pyx_v_rr;
  int __pyx_v_rc;
  int __pyx_v_n_dir;
  int __pyx_v_n_mod;
  int __pyx_v_n_tim;
  int __pyx_v_n_fre;
  int __pyx_v_n_ant;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_g;
  __Pyx_Buffer __pyx_pybuffer_g;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_gh;
  __Pyx_Buffer __pyx_pybuffer_gh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_m;
  __Pyx_Buffer __pyx_pybuffer_m;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_o;
  __Pyx_Buffer __pyx_pybuffer_o;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_r;
  __Pyx_Buffer __pyx_pybuffer_r;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_1cycompute_residual", 0);
  __pyx_pybuffer_m.pybuffer.buf = NULL;
  __pyx_pybuffer_m.refcount = 0;
  __pyx_pybuffernd_m.data = NULL;
  __pyx_pybuffernd_m.rcbuffer = &amp;__pyx_pybuffer_m;
  __pyx_pybuffer_g.pybuffer.buf = NULL;
  __pyx_pybuffer_g.refcount = 0;
  __pyx_pybuffernd_g.data = NULL;
  __pyx_pybuffernd_g.rcbuffer = &amp;__pyx_pybuffer_g;
  __pyx_pybuffer_gh.pybuffer.buf = NULL;
  __pyx_pybuffer_gh.refcount = 0;
  __pyx_pybuffernd_gh.data = NULL;
  __pyx_pybuffernd_gh.rcbuffer = &amp;__pyx_pybuffer_gh;
  __pyx_pybuffer_o.pybuffer.buf = NULL;
  __pyx_pybuffer_o.refcount = 0;
  __pyx_pybuffernd_o.data = NULL;
  __pyx_pybuffernd_o.rcbuffer = &amp;__pyx_pybuffer_o;
  __pyx_pybuffer_r.pybuffer.buf = NULL;
  __pyx_pybuffer_r.refcount = 0;
  __pyx_pybuffernd_r.data = NULL;
  __pyx_pybuffernd_r.rcbuffer = &amp;__pyx_pybuffer_r;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_m.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_m, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES, 8, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_m.diminfo[0].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_m.diminfo[0].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_m.diminfo[1].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_m.diminfo[1].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_m.diminfo[2].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_m.diminfo[2].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_m.diminfo[3].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_m.diminfo[3].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_m.diminfo[4].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_m.diminfo[4].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_m.diminfo[5].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_m.diminfo[5].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_m.diminfo[6].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_m.diminfo[6].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[6]; __pyx_pybuffernd_m.diminfo[7].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[7]; __pyx_pybuffernd_m.diminfo[7].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[7];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_g, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_g.diminfo[0].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_g.diminfo[0].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_g.diminfo[1].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_g.diminfo[1].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_g.diminfo[2].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_g.diminfo[2].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_g.diminfo[3].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_g.diminfo[3].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_g.diminfo[4].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_g.diminfo[4].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_g.diminfo[5].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_g.diminfo[5].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_gh, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_gh.diminfo[0].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_gh.diminfo[0].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_gh.diminfo[1].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_gh.diminfo[1].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_gh.diminfo[2].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_gh.diminfo[2].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_gh.diminfo[3].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_gh.diminfo[3].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_gh.diminfo[4].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_gh.diminfo[4].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_gh.diminfo[5].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_gh.diminfo[5].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_o.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_o, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES, 7, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_o.diminfo[0].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_o.diminfo[0].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_o.diminfo[1].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_o.diminfo[1].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_o.diminfo[2].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_o.diminfo[2].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_o.diminfo[3].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_o.diminfo[3].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_o.diminfo[4].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_o.diminfo[4].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_o.diminfo[5].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_o.diminfo[5].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_o.diminfo[6].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_o.diminfo[6].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[6];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_r, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 7, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_r.diminfo[0].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_r.diminfo[0].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_r.diminfo[1].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_r.diminfo[1].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_r.diminfo[2].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_r.diminfo[2].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_r.diminfo[3].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_r.diminfo[3].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_r.diminfo[4].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_r.diminfo[4].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_r.diminfo[5].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_r.diminfo[5].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_r.diminfo[6].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_r.diminfo[6].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[6];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_m.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_o.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_residual", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_m.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_o.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
  __pyx_tuple__6 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Function_call_with_ambiguous_arg);<span class='error_goto'> if (unlikely(!__pyx_tuple__6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__6);
/* … */
  __pyx_tuple__58 = <span class='py_c_api'>PyTuple_Pack</span>(20, __pyx_n_s_m, __pyx_n_s_g, __pyx_n_s_gh, __pyx_n_s_o, __pyx_n_s_r, __pyx_n_s_t_int, __pyx_n_s_f_int, __pyx_n_s_d, __pyx_n_s_i, __pyx_n_s_t, __pyx_n_s_f, __pyx_n_s_aa, __pyx_n_s_ab, __pyx_n_s_rr, __pyx_n_s_rc, __pyx_n_s_n_dir, __pyx_n_s_n_mod, __pyx_n_s_n_tim, __pyx_n_s_n_fre, __pyx_n_s_n_ant);<span class='error_goto'> if (unlikely(!__pyx_tuple__58)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__58);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__58);
/* … */
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_FusedFunction_NewEx(&amp;__pyx_fuse_0__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_17cycompute_residual, 0, __pyx_n_s_cycompute_residual, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__59));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_kp_s_float_complex, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_FusedFunction_NewEx(&amp;__pyx_fuse_1__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_19cycompute_residual, 0, __pyx_n_s_cycompute_residual, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__59));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_kp_s_double_complex, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_FusedFunction_NewEx(&amp;__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_1cycompute_residual, 0, __pyx_n_s_cycompute_residual, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__59));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_empty_tuple);
  ((__pyx_FusedFunctionObject *) __pyx_t_2)-&gt;__signatures__ = __pyx_t_1;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_cycompute_residual, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__59 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 20, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__58, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_ulrich_CubeCal_cubecal_ker, __pyx_n_s_cycompute_residual, 16, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__59)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">017</span>:                        np.ndarray[complex3264, ndim=6] g,</pre>
<pre class="cython line score-0">&#xA0;<span class="">018</span>:                        np.ndarray[complex3264, ndim=6] gh,</pre>
<pre class="cython line score-0">&#xA0;<span class="">019</span>:                        np.ndarray[complex3264, ndim=7] o,</pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>:                        np.ndarray[complex3264, ndim=7] r,</pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>:                        int t_int,</pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>:                        int f_int):</pre>
<pre class="cython line score-0">&#xA0;<span class="">023</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>:     This computes the residual, resulting in large matrix indexed by</pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>:     (direction, model, time, frequency, antenna, antenna, correlation, correlation).</pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">029</span>:     cdef int d, i, t, f, aa, ab, rr, rc = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_rc = 0;
/* … */
  __pyx_v_rc = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">030</span>:     cdef int n_dir, n_mod, n_tim, n_fre, n_ant</pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">032</span>:     n_dir = m.shape[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_dir = (__pyx_v_m-&gt;dimensions[0]);
/* … */
  __pyx_v_n_dir = (__pyx_v_m-&gt;dimensions[0]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">033</span>:     n_mod = m.shape[1]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_mod = (__pyx_v_m-&gt;dimensions[1]);
/* … */
  __pyx_v_n_mod = (__pyx_v_m-&gt;dimensions[1]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">034</span>:     n_tim = m.shape[2]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_tim = (__pyx_v_m-&gt;dimensions[2]);
/* … */
  __pyx_v_n_tim = (__pyx_v_m-&gt;dimensions[2]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">035</span>:     n_fre = m.shape[3]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_fre = (__pyx_v_m-&gt;dimensions[3]);
/* … */
  __pyx_v_n_fre = (__pyx_v_m-&gt;dimensions[3]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">036</span>:     n_ant = m.shape[4]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_ant = (__pyx_v_m-&gt;dimensions[4]);
/* … */
  __pyx_v_n_ant = (__pyx_v_m-&gt;dimensions[4]);
</pre><pre class="cython line score-0">&#xA0;<span class="">037</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">038</span>:     for d in xrange(n_dir):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_n_dir;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
/* … */
  __pyx_t_1 = __pyx_v_n_dir;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">039</span>:         for i in xrange(n_mod):</pre>
<pre class='cython code score-0 '>    __pyx_t_3 = __pyx_v_n_mod;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_i = __pyx_t_4;
/* … */
    __pyx_t_3 = __pyx_v_n_mod;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">040</span>:             for t in xrange(n_tim):</pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_n_tim;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_t = __pyx_t_6;
/* … */
      __pyx_t_5 = __pyx_v_n_tim;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_t = __pyx_t_6;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">041</span>:                 rr = t/t_int</pre>
<pre class='cython code score-0 '>        __pyx_v_rr = (__pyx_v_t / __pyx_v_t_int);
/* … */
        __pyx_v_rr = (__pyx_v_t / __pyx_v_t_int);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">042</span>:                 for f in xrange(n_fre):</pre>
<pre class='cython code score-0 '>        __pyx_t_7 = __pyx_v_n_fre;
        for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_f = __pyx_t_8;
/* … */
        __pyx_t_7 = __pyx_v_n_fre;
        for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_f = __pyx_t_8;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">043</span>:                     rc = f/f_int</pre>
<pre class='cython code score-0 '>          __pyx_v_rc = (__pyx_v_f / __pyx_v_f_int);
/* … */
          __pyx_v_rc = (__pyx_v_f / __pyx_v_f_int);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">044</span>:                     for aa in xrange(n_ant):</pre>
<pre class='cython code score-0 '>          __pyx_t_9 = __pyx_v_n_ant;
          for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
            __pyx_v_aa = __pyx_t_10;
/* … */
          __pyx_t_9 = __pyx_v_n_ant;
          for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
            __pyx_v_aa = __pyx_t_10;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">045</span>:                         for ab in xrange(n_ant):</pre>
<pre class='cython code score-0 '>            __pyx_t_11 = __pyx_v_n_ant;
            for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
              __pyx_v_ab = __pyx_t_12;
/* … */
            __pyx_t_11 = __pyx_v_n_ant;
            for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
              __pyx_v_ab = __pyx_t_12;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">046</span>:                             r[i,t,f,aa,ab,0,0] = o[i,t,f,aa,ab,0,0] - (</pre>
<pre class='cython code score-0 '>              __pyx_t_13 = __pyx_v_i;
              __pyx_t_14 = __pyx_v_t;
              __pyx_t_15 = __pyx_v_f;
              __pyx_t_16 = __pyx_v_aa;
              __pyx_t_17 = __pyx_v_ab;
              __pyx_t_18 = 0;
              __pyx_t_19 = 0;
/* … */
              __pyx_t_100 = __pyx_v_i;
              __pyx_t_101 = __pyx_v_t;
              __pyx_t_102 = __pyx_v_f;
              __pyx_t_103 = __pyx_v_aa;
              __pyx_t_104 = __pyx_v_ab;
              __pyx_t_105 = 0;
              __pyx_t_106 = 0;
              *__Pyx_BufPtrStrided7d(__pyx_t_float_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_100, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_101, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_102, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_103, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_104, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_105, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_106, __pyx_pybuffernd_r.diminfo[6].strides) = __Pyx_c_difff((*__Pyx_BufPtrStrided7d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_16, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_17, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_18, __pyx_pybuffernd_o.diminfo[5].strides, __pyx_t_19, __pyx_pybuffernd_o.diminfo[6].strides)), __Pyx_c_sumf(__Pyx_c_sumf(__Pyx_c_sumf(__Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_22, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_23, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_24, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_25, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_27, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_28, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_29, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_30, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_31, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_32, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_33, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_35, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_36, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_37, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_38, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_39, __pyx_pybuffernd_gh.diminfo[5].strides))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_40, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_41, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_42, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_43, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_44, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_45, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_46, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_47, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_48, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_49, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_50, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_51, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_52, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_53, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_54, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_55, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_56, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_57, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_58, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_59, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_60, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_61, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_62, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_63, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_64, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_65, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_66, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_67, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_68, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_69, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_70, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_71, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_72, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_73, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_74, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_75, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_76, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_77, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_78, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_79, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_80, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_81, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_82, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_83, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_84, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_85, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_86, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_87, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_88, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_89, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_90, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_91, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_92, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_93, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_94, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_95, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_96, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_97, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_98, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_99, __pyx_pybuffernd_gh.diminfo[5].strides)))));
/* … */
              __pyx_t_13 = __pyx_v_i;
              __pyx_t_14 = __pyx_v_t;
              __pyx_t_15 = __pyx_v_f;
              __pyx_t_16 = __pyx_v_aa;
              __pyx_t_17 = __pyx_v_ab;
              __pyx_t_18 = 0;
              __pyx_t_19 = 0;
/* … */
              __pyx_t_100 = __pyx_v_i;
              __pyx_t_101 = __pyx_v_t;
              __pyx_t_102 = __pyx_v_f;
              __pyx_t_103 = __pyx_v_aa;
              __pyx_t_104 = __pyx_v_ab;
              __pyx_t_105 = 0;
              __pyx_t_106 = 0;
              *__Pyx_BufPtrStrided7d(__pyx_t_double_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_100, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_101, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_102, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_103, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_104, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_105, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_106, __pyx_pybuffernd_r.diminfo[6].strides) = __Pyx_c_diff((*__Pyx_BufPtrStrided7d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_16, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_17, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_18, __pyx_pybuffernd_o.diminfo[5].strides, __pyx_t_19, __pyx_pybuffernd_o.diminfo[6].strides)), __Pyx_c_sum(__Pyx_c_sum(__Pyx_c_sum(__Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_22, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_23, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_24, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_25, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_27, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_28, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_29, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_30, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_31, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_32, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_33, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_35, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_36, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_37, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_38, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_39, __pyx_pybuffernd_gh.diminfo[5].strides))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_40, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_41, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_42, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_43, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_44, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_45, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_46, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_47, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_48, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_49, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_50, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_51, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_52, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_53, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_54, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_55, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_56, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_57, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_58, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_59, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_60, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_61, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_62, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_63, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_64, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_65, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_66, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_67, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_68, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_69, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_70, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_71, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_72, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_73, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_74, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_75, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_76, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_77, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_78, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_79, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_80, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_81, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_82, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_83, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_84, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_85, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_86, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_87, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_88, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_89, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_90, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_91, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_92, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_93, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_94, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_95, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_96, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_97, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_98, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_99, __pyx_pybuffernd_gh.diminfo[5].strides)))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">047</span>:                             g[d,rr,rc,aa,0,0]*m[d,i,t,f,aa,ab,0,0]*gh[d,rr,rc,ab,0,0] + \</pre>
<pre class='cython code score-0 '>              __pyx_t_20 = __pyx_v_d;
              __pyx_t_21 = __pyx_v_rr;
              __pyx_t_22 = __pyx_v_rc;
              __pyx_t_23 = __pyx_v_aa;
              __pyx_t_24 = 0;
              __pyx_t_25 = 0;
              __pyx_t_26 = __pyx_v_d;
              __pyx_t_27 = __pyx_v_i;
              __pyx_t_28 = __pyx_v_t;
              __pyx_t_29 = __pyx_v_f;
              __pyx_t_30 = __pyx_v_aa;
              __pyx_t_31 = __pyx_v_ab;
              __pyx_t_32 = 0;
              __pyx_t_33 = 0;
              __pyx_t_34 = __pyx_v_d;
              __pyx_t_35 = __pyx_v_rr;
              __pyx_t_36 = __pyx_v_rc;
              __pyx_t_37 = __pyx_v_ab;
              __pyx_t_38 = 0;
              __pyx_t_39 = 0;
/* … */
              __pyx_t_20 = __pyx_v_d;
              __pyx_t_21 = __pyx_v_rr;
              __pyx_t_22 = __pyx_v_rc;
              __pyx_t_23 = __pyx_v_aa;
              __pyx_t_24 = 0;
              __pyx_t_25 = 0;
              __pyx_t_26 = __pyx_v_d;
              __pyx_t_27 = __pyx_v_i;
              __pyx_t_28 = __pyx_v_t;
              __pyx_t_29 = __pyx_v_f;
              __pyx_t_30 = __pyx_v_aa;
              __pyx_t_31 = __pyx_v_ab;
              __pyx_t_32 = 0;
              __pyx_t_33 = 0;
              __pyx_t_34 = __pyx_v_d;
              __pyx_t_35 = __pyx_v_rr;
              __pyx_t_36 = __pyx_v_rc;
              __pyx_t_37 = __pyx_v_ab;
              __pyx_t_38 = 0;
              __pyx_t_39 = 0;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">048</span>:                             g[d,rr,rc,aa,0,1]*m[d,i,t,f,aa,ab,1,0]*gh[d,rr,rc,ab,0,0] + \</pre>
<pre class='cython code score-0 '>              __pyx_t_40 = __pyx_v_d;
              __pyx_t_41 = __pyx_v_rr;
              __pyx_t_42 = __pyx_v_rc;
              __pyx_t_43 = __pyx_v_aa;
              __pyx_t_44 = 0;
              __pyx_t_45 = 1;
              __pyx_t_46 = __pyx_v_d;
              __pyx_t_47 = __pyx_v_i;
              __pyx_t_48 = __pyx_v_t;
              __pyx_t_49 = __pyx_v_f;
              __pyx_t_50 = __pyx_v_aa;
              __pyx_t_51 = __pyx_v_ab;
              __pyx_t_52 = 1;
              __pyx_t_53 = 0;
              __pyx_t_54 = __pyx_v_d;
              __pyx_t_55 = __pyx_v_rr;
              __pyx_t_56 = __pyx_v_rc;
              __pyx_t_57 = __pyx_v_ab;
              __pyx_t_58 = 0;
              __pyx_t_59 = 0;
/* … */
              __pyx_t_40 = __pyx_v_d;
              __pyx_t_41 = __pyx_v_rr;
              __pyx_t_42 = __pyx_v_rc;
              __pyx_t_43 = __pyx_v_aa;
              __pyx_t_44 = 0;
              __pyx_t_45 = 1;
              __pyx_t_46 = __pyx_v_d;
              __pyx_t_47 = __pyx_v_i;
              __pyx_t_48 = __pyx_v_t;
              __pyx_t_49 = __pyx_v_f;
              __pyx_t_50 = __pyx_v_aa;
              __pyx_t_51 = __pyx_v_ab;
              __pyx_t_52 = 1;
              __pyx_t_53 = 0;
              __pyx_t_54 = __pyx_v_d;
              __pyx_t_55 = __pyx_v_rr;
              __pyx_t_56 = __pyx_v_rc;
              __pyx_t_57 = __pyx_v_ab;
              __pyx_t_58 = 0;
              __pyx_t_59 = 0;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">049</span>:                             g[d,rr,rc,aa,0,0]*m[d,i,t,f,aa,ab,0,1]*gh[d,rr,rc,ab,1,0] + \</pre>
<pre class='cython code score-0 '>              __pyx_t_60 = __pyx_v_d;
              __pyx_t_61 = __pyx_v_rr;
              __pyx_t_62 = __pyx_v_rc;
              __pyx_t_63 = __pyx_v_aa;
              __pyx_t_64 = 0;
              __pyx_t_65 = 0;
              __pyx_t_66 = __pyx_v_d;
              __pyx_t_67 = __pyx_v_i;
              __pyx_t_68 = __pyx_v_t;
              __pyx_t_69 = __pyx_v_f;
              __pyx_t_70 = __pyx_v_aa;
              __pyx_t_71 = __pyx_v_ab;
              __pyx_t_72 = 0;
              __pyx_t_73 = 1;
              __pyx_t_74 = __pyx_v_d;
              __pyx_t_75 = __pyx_v_rr;
              __pyx_t_76 = __pyx_v_rc;
              __pyx_t_77 = __pyx_v_ab;
              __pyx_t_78 = 1;
              __pyx_t_79 = 0;
/* … */
              __pyx_t_60 = __pyx_v_d;
              __pyx_t_61 = __pyx_v_rr;
              __pyx_t_62 = __pyx_v_rc;
              __pyx_t_63 = __pyx_v_aa;
              __pyx_t_64 = 0;
              __pyx_t_65 = 0;
              __pyx_t_66 = __pyx_v_d;
              __pyx_t_67 = __pyx_v_i;
              __pyx_t_68 = __pyx_v_t;
              __pyx_t_69 = __pyx_v_f;
              __pyx_t_70 = __pyx_v_aa;
              __pyx_t_71 = __pyx_v_ab;
              __pyx_t_72 = 0;
              __pyx_t_73 = 1;
              __pyx_t_74 = __pyx_v_d;
              __pyx_t_75 = __pyx_v_rr;
              __pyx_t_76 = __pyx_v_rc;
              __pyx_t_77 = __pyx_v_ab;
              __pyx_t_78 = 1;
              __pyx_t_79 = 0;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">050</span>:                             g[d,rr,rc,aa,0,1]*m[d,i,t,f,aa,ab,1,1]*gh[d,rr,rc,ab,1,0])</pre>
<pre class='cython code score-0 '>              __pyx_t_80 = __pyx_v_d;
              __pyx_t_81 = __pyx_v_rr;
              __pyx_t_82 = __pyx_v_rc;
              __pyx_t_83 = __pyx_v_aa;
              __pyx_t_84 = 0;
              __pyx_t_85 = 1;
              __pyx_t_86 = __pyx_v_d;
              __pyx_t_87 = __pyx_v_i;
              __pyx_t_88 = __pyx_v_t;
              __pyx_t_89 = __pyx_v_f;
              __pyx_t_90 = __pyx_v_aa;
              __pyx_t_91 = __pyx_v_ab;
              __pyx_t_92 = 1;
              __pyx_t_93 = 1;
              __pyx_t_94 = __pyx_v_d;
              __pyx_t_95 = __pyx_v_rr;
              __pyx_t_96 = __pyx_v_rc;
              __pyx_t_97 = __pyx_v_ab;
              __pyx_t_98 = 1;
              __pyx_t_99 = 0;
/* … */
              __pyx_t_80 = __pyx_v_d;
              __pyx_t_81 = __pyx_v_rr;
              __pyx_t_82 = __pyx_v_rc;
              __pyx_t_83 = __pyx_v_aa;
              __pyx_t_84 = 0;
              __pyx_t_85 = 1;
              __pyx_t_86 = __pyx_v_d;
              __pyx_t_87 = __pyx_v_i;
              __pyx_t_88 = __pyx_v_t;
              __pyx_t_89 = __pyx_v_f;
              __pyx_t_90 = __pyx_v_aa;
              __pyx_t_91 = __pyx_v_ab;
              __pyx_t_92 = 1;
              __pyx_t_93 = 1;
              __pyx_t_94 = __pyx_v_d;
              __pyx_t_95 = __pyx_v_rr;
              __pyx_t_96 = __pyx_v_rc;
              __pyx_t_97 = __pyx_v_ab;
              __pyx_t_98 = 1;
              __pyx_t_99 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">051</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">052</span>:                             r[i,t,f,aa,ab,0,1] = o[i,t,f,aa,ab,0,1] - (</pre>
<pre class='cython code score-0 '>              __pyx_t_107 = __pyx_v_i;
              __pyx_t_108 = __pyx_v_t;
              __pyx_t_109 = __pyx_v_f;
              __pyx_t_110 = __pyx_v_aa;
              __pyx_t_111 = __pyx_v_ab;
              __pyx_t_112 = 0;
              __pyx_t_113 = 1;
/* … */
              __pyx_t_194 = __pyx_v_i;
              __pyx_t_195 = __pyx_v_t;
              __pyx_t_196 = __pyx_v_f;
              __pyx_t_197 = __pyx_v_aa;
              __pyx_t_198 = __pyx_v_ab;
              __pyx_t_199 = 0;
              __pyx_t_200 = 1;
              *__Pyx_BufPtrStrided7d(__pyx_t_float_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_194, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_195, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_196, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_197, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_198, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_199, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_200, __pyx_pybuffernd_r.diminfo[6].strides) = __Pyx_c_difff((*__Pyx_BufPtrStrided7d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_107, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_108, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_109, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_110, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_111, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_112, __pyx_pybuffernd_o.diminfo[5].strides, __pyx_t_113, __pyx_pybuffernd_o.diminfo[6].strides)), __Pyx_c_sumf(__Pyx_c_sumf(__Pyx_c_sumf(__Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_114, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_115, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_116, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_117, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_118, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_119, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_120, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_121, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_122, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_123, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_124, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_125, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_126, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_127, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_128, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_129, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_130, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_131, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_132, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_133, __pyx_pybuffernd_gh.diminfo[5].strides))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_134, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_135, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_136, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_137, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_138, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_139, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_140, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_141, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_142, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_143, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_144, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_145, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_146, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_147, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_148, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_149, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_150, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_151, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_152, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_153, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_154, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_155, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_156, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_157, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_158, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_159, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_160, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_161, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_162, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_163, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_164, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_165, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_166, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_167, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_168, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_169, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_170, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_171, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_172, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_173, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_174, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_175, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_176, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_177, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_178, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_179, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_180, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_181, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_182, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_183, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_184, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_185, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_186, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_187, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_188, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_189, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_190, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_191, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_192, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_193, __pyx_pybuffernd_gh.diminfo[5].strides)))));
/* … */
              __pyx_t_107 = __pyx_v_i;
              __pyx_t_108 = __pyx_v_t;
              __pyx_t_109 = __pyx_v_f;
              __pyx_t_110 = __pyx_v_aa;
              __pyx_t_111 = __pyx_v_ab;
              __pyx_t_112 = 0;
              __pyx_t_113 = 1;
/* … */
              __pyx_t_194 = __pyx_v_i;
              __pyx_t_195 = __pyx_v_t;
              __pyx_t_196 = __pyx_v_f;
              __pyx_t_197 = __pyx_v_aa;
              __pyx_t_198 = __pyx_v_ab;
              __pyx_t_199 = 0;
              __pyx_t_200 = 1;
              *__Pyx_BufPtrStrided7d(__pyx_t_double_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_194, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_195, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_196, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_197, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_198, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_199, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_200, __pyx_pybuffernd_r.diminfo[6].strides) = __Pyx_c_diff((*__Pyx_BufPtrStrided7d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_107, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_108, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_109, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_110, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_111, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_112, __pyx_pybuffernd_o.diminfo[5].strides, __pyx_t_113, __pyx_pybuffernd_o.diminfo[6].strides)), __Pyx_c_sum(__Pyx_c_sum(__Pyx_c_sum(__Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_114, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_115, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_116, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_117, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_118, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_119, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_120, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_121, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_122, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_123, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_124, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_125, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_126, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_127, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_128, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_129, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_130, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_131, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_132, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_133, __pyx_pybuffernd_gh.diminfo[5].strides))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_134, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_135, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_136, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_137, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_138, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_139, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_140, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_141, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_142, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_143, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_144, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_145, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_146, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_147, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_148, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_149, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_150, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_151, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_152, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_153, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_154, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_155, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_156, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_157, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_158, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_159, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_160, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_161, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_162, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_163, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_164, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_165, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_166, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_167, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_168, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_169, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_170, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_171, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_172, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_173, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_174, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_175, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_176, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_177, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_178, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_179, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_180, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_181, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_182, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_183, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_184, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_185, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_186, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_187, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_188, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_189, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_190, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_191, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_192, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_193, __pyx_pybuffernd_gh.diminfo[5].strides)))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">053</span>:                             g[d,rr,rc,aa,0,0]*m[d,i,t,f,aa,ab,0,0]*gh[d,rr,rc,ab,0,1] + \</pre>
<pre class='cython code score-0 '>              __pyx_t_114 = __pyx_v_d;
              __pyx_t_115 = __pyx_v_rr;
              __pyx_t_116 = __pyx_v_rc;
              __pyx_t_117 = __pyx_v_aa;
              __pyx_t_118 = 0;
              __pyx_t_119 = 0;
              __pyx_t_120 = __pyx_v_d;
              __pyx_t_121 = __pyx_v_i;
              __pyx_t_122 = __pyx_v_t;
              __pyx_t_123 = __pyx_v_f;
              __pyx_t_124 = __pyx_v_aa;
              __pyx_t_125 = __pyx_v_ab;
              __pyx_t_126 = 0;
              __pyx_t_127 = 0;
              __pyx_t_128 = __pyx_v_d;
              __pyx_t_129 = __pyx_v_rr;
              __pyx_t_130 = __pyx_v_rc;
              __pyx_t_131 = __pyx_v_ab;
              __pyx_t_132 = 0;
              __pyx_t_133 = 1;
/* … */
              __pyx_t_114 = __pyx_v_d;
              __pyx_t_115 = __pyx_v_rr;
              __pyx_t_116 = __pyx_v_rc;
              __pyx_t_117 = __pyx_v_aa;
              __pyx_t_118 = 0;
              __pyx_t_119 = 0;
              __pyx_t_120 = __pyx_v_d;
              __pyx_t_121 = __pyx_v_i;
              __pyx_t_122 = __pyx_v_t;
              __pyx_t_123 = __pyx_v_f;
              __pyx_t_124 = __pyx_v_aa;
              __pyx_t_125 = __pyx_v_ab;
              __pyx_t_126 = 0;
              __pyx_t_127 = 0;
              __pyx_t_128 = __pyx_v_d;
              __pyx_t_129 = __pyx_v_rr;
              __pyx_t_130 = __pyx_v_rc;
              __pyx_t_131 = __pyx_v_ab;
              __pyx_t_132 = 0;
              __pyx_t_133 = 1;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">054</span>:                             g[d,rr,rc,aa,0,1]*m[d,i,t,f,aa,ab,1,0]*gh[d,rr,rc,ab,0,1] + \</pre>
<pre class='cython code score-0 '>              __pyx_t_134 = __pyx_v_d;
              __pyx_t_135 = __pyx_v_rr;
              __pyx_t_136 = __pyx_v_rc;
              __pyx_t_137 = __pyx_v_aa;
              __pyx_t_138 = 0;
              __pyx_t_139 = 1;
              __pyx_t_140 = __pyx_v_d;
              __pyx_t_141 = __pyx_v_i;
              __pyx_t_142 = __pyx_v_t;
              __pyx_t_143 = __pyx_v_f;
              __pyx_t_144 = __pyx_v_aa;
              __pyx_t_145 = __pyx_v_ab;
              __pyx_t_146 = 1;
              __pyx_t_147 = 0;
              __pyx_t_148 = __pyx_v_d;
              __pyx_t_149 = __pyx_v_rr;
              __pyx_t_150 = __pyx_v_rc;
              __pyx_t_151 = __pyx_v_ab;
              __pyx_t_152 = 0;
              __pyx_t_153 = 1;
/* … */
              __pyx_t_134 = __pyx_v_d;
              __pyx_t_135 = __pyx_v_rr;
              __pyx_t_136 = __pyx_v_rc;
              __pyx_t_137 = __pyx_v_aa;
              __pyx_t_138 = 0;
              __pyx_t_139 = 1;
              __pyx_t_140 = __pyx_v_d;
              __pyx_t_141 = __pyx_v_i;
              __pyx_t_142 = __pyx_v_t;
              __pyx_t_143 = __pyx_v_f;
              __pyx_t_144 = __pyx_v_aa;
              __pyx_t_145 = __pyx_v_ab;
              __pyx_t_146 = 1;
              __pyx_t_147 = 0;
              __pyx_t_148 = __pyx_v_d;
              __pyx_t_149 = __pyx_v_rr;
              __pyx_t_150 = __pyx_v_rc;
              __pyx_t_151 = __pyx_v_ab;
              __pyx_t_152 = 0;
              __pyx_t_153 = 1;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">055</span>:                             g[d,rr,rc,aa,0,0]*m[d,i,t,f,aa,ab,0,1]*gh[d,rr,rc,ab,1,1] + \</pre>
<pre class='cython code score-0 '>              __pyx_t_154 = __pyx_v_d;
              __pyx_t_155 = __pyx_v_rr;
              __pyx_t_156 = __pyx_v_rc;
              __pyx_t_157 = __pyx_v_aa;
              __pyx_t_158 = 0;
              __pyx_t_159 = 0;
              __pyx_t_160 = __pyx_v_d;
              __pyx_t_161 = __pyx_v_i;
              __pyx_t_162 = __pyx_v_t;
              __pyx_t_163 = __pyx_v_f;
              __pyx_t_164 = __pyx_v_aa;
              __pyx_t_165 = __pyx_v_ab;
              __pyx_t_166 = 0;
              __pyx_t_167 = 1;
              __pyx_t_168 = __pyx_v_d;
              __pyx_t_169 = __pyx_v_rr;
              __pyx_t_170 = __pyx_v_rc;
              __pyx_t_171 = __pyx_v_ab;
              __pyx_t_172 = 1;
              __pyx_t_173 = 1;
/* … */
              __pyx_t_154 = __pyx_v_d;
              __pyx_t_155 = __pyx_v_rr;
              __pyx_t_156 = __pyx_v_rc;
              __pyx_t_157 = __pyx_v_aa;
              __pyx_t_158 = 0;
              __pyx_t_159 = 0;
              __pyx_t_160 = __pyx_v_d;
              __pyx_t_161 = __pyx_v_i;
              __pyx_t_162 = __pyx_v_t;
              __pyx_t_163 = __pyx_v_f;
              __pyx_t_164 = __pyx_v_aa;
              __pyx_t_165 = __pyx_v_ab;
              __pyx_t_166 = 0;
              __pyx_t_167 = 1;
              __pyx_t_168 = __pyx_v_d;
              __pyx_t_169 = __pyx_v_rr;
              __pyx_t_170 = __pyx_v_rc;
              __pyx_t_171 = __pyx_v_ab;
              __pyx_t_172 = 1;
              __pyx_t_173 = 1;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">056</span>:                             g[d,rr,rc,aa,0,1]*m[d,i,t,f,aa,ab,1,1]*gh[d,rr,rc,ab,1,1])</pre>
<pre class='cython code score-0 '>              __pyx_t_174 = __pyx_v_d;
              __pyx_t_175 = __pyx_v_rr;
              __pyx_t_176 = __pyx_v_rc;
              __pyx_t_177 = __pyx_v_aa;
              __pyx_t_178 = 0;
              __pyx_t_179 = 1;
              __pyx_t_180 = __pyx_v_d;
              __pyx_t_181 = __pyx_v_i;
              __pyx_t_182 = __pyx_v_t;
              __pyx_t_183 = __pyx_v_f;
              __pyx_t_184 = __pyx_v_aa;
              __pyx_t_185 = __pyx_v_ab;
              __pyx_t_186 = 1;
              __pyx_t_187 = 1;
              __pyx_t_188 = __pyx_v_d;
              __pyx_t_189 = __pyx_v_rr;
              __pyx_t_190 = __pyx_v_rc;
              __pyx_t_191 = __pyx_v_ab;
              __pyx_t_192 = 1;
              __pyx_t_193 = 1;
/* … */
              __pyx_t_174 = __pyx_v_d;
              __pyx_t_175 = __pyx_v_rr;
              __pyx_t_176 = __pyx_v_rc;
              __pyx_t_177 = __pyx_v_aa;
              __pyx_t_178 = 0;
              __pyx_t_179 = 1;
              __pyx_t_180 = __pyx_v_d;
              __pyx_t_181 = __pyx_v_i;
              __pyx_t_182 = __pyx_v_t;
              __pyx_t_183 = __pyx_v_f;
              __pyx_t_184 = __pyx_v_aa;
              __pyx_t_185 = __pyx_v_ab;
              __pyx_t_186 = 1;
              __pyx_t_187 = 1;
              __pyx_t_188 = __pyx_v_d;
              __pyx_t_189 = __pyx_v_rr;
              __pyx_t_190 = __pyx_v_rc;
              __pyx_t_191 = __pyx_v_ab;
              __pyx_t_192 = 1;
              __pyx_t_193 = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">057</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">058</span>:                             r[i,t,f,aa,ab,1,0] = o[i,t,f,aa,ab,1,0] - (</pre>
<pre class='cython code score-0 '>              __pyx_t_201 = __pyx_v_i;
              __pyx_t_202 = __pyx_v_t;
              __pyx_t_203 = __pyx_v_f;
              __pyx_t_204 = __pyx_v_aa;
              __pyx_t_205 = __pyx_v_ab;
              __pyx_t_206 = 1;
              __pyx_t_207 = 0;
/* … */
              __pyx_t_288 = __pyx_v_i;
              __pyx_t_289 = __pyx_v_t;
              __pyx_t_290 = __pyx_v_f;
              __pyx_t_291 = __pyx_v_aa;
              __pyx_t_292 = __pyx_v_ab;
              __pyx_t_293 = 1;
              __pyx_t_294 = 0;
              *__Pyx_BufPtrStrided7d(__pyx_t_float_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_288, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_289, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_290, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_291, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_292, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_293, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_294, __pyx_pybuffernd_r.diminfo[6].strides) = __Pyx_c_difff((*__Pyx_BufPtrStrided7d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_201, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_202, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_203, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_204, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_205, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_206, __pyx_pybuffernd_o.diminfo[5].strides, __pyx_t_207, __pyx_pybuffernd_o.diminfo[6].strides)), __Pyx_c_sumf(__Pyx_c_sumf(__Pyx_c_sumf(__Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_208, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_209, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_210, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_211, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_212, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_213, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_214, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_215, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_216, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_217, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_218, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_219, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_220, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_221, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_222, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_223, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_224, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_225, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_226, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_227, __pyx_pybuffernd_gh.diminfo[5].strides))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_228, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_229, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_230, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_231, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_232, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_233, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_234, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_235, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_236, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_237, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_238, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_239, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_240, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_241, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_242, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_243, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_244, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_245, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_246, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_247, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_248, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_249, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_250, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_251, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_252, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_253, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_254, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_255, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_256, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_257, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_258, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_259, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_260, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_261, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_262, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_263, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_264, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_265, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_266, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_267, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_268, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_269, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_270, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_271, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_272, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_273, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_274, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_275, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_276, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_277, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_278, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_279, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_280, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_281, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_282, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_283, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_284, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_285, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_286, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_287, __pyx_pybuffernd_gh.diminfo[5].strides)))));
/* … */
              __pyx_t_201 = __pyx_v_i;
              __pyx_t_202 = __pyx_v_t;
              __pyx_t_203 = __pyx_v_f;
              __pyx_t_204 = __pyx_v_aa;
              __pyx_t_205 = __pyx_v_ab;
              __pyx_t_206 = 1;
              __pyx_t_207 = 0;
/* … */
              __pyx_t_288 = __pyx_v_i;
              __pyx_t_289 = __pyx_v_t;
              __pyx_t_290 = __pyx_v_f;
              __pyx_t_291 = __pyx_v_aa;
              __pyx_t_292 = __pyx_v_ab;
              __pyx_t_293 = 1;
              __pyx_t_294 = 0;
              *__Pyx_BufPtrStrided7d(__pyx_t_double_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_288, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_289, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_290, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_291, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_292, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_293, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_294, __pyx_pybuffernd_r.diminfo[6].strides) = __Pyx_c_diff((*__Pyx_BufPtrStrided7d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_201, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_202, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_203, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_204, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_205, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_206, __pyx_pybuffernd_o.diminfo[5].strides, __pyx_t_207, __pyx_pybuffernd_o.diminfo[6].strides)), __Pyx_c_sum(__Pyx_c_sum(__Pyx_c_sum(__Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_208, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_209, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_210, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_211, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_212, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_213, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_214, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_215, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_216, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_217, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_218, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_219, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_220, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_221, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_222, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_223, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_224, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_225, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_226, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_227, __pyx_pybuffernd_gh.diminfo[5].strides))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_228, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_229, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_230, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_231, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_232, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_233, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_234, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_235, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_236, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_237, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_238, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_239, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_240, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_241, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_242, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_243, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_244, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_245, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_246, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_247, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_248, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_249, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_250, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_251, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_252, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_253, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_254, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_255, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_256, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_257, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_258, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_259, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_260, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_261, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_262, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_263, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_264, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_265, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_266, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_267, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_268, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_269, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_270, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_271, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_272, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_273, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_274, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_275, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_276, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_277, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_278, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_279, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_280, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_281, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_282, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_283, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_284, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_285, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_286, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_287, __pyx_pybuffernd_gh.diminfo[5].strides)))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">059</span>:                             g[d,rr,rc,aa,1,0]*m[d,i,t,f,aa,ab,0,0]*gh[d,rr,rc,ab,0,0] + \</pre>
<pre class='cython code score-0 '>              __pyx_t_208 = __pyx_v_d;
              __pyx_t_209 = __pyx_v_rr;
              __pyx_t_210 = __pyx_v_rc;
              __pyx_t_211 = __pyx_v_aa;
              __pyx_t_212 = 1;
              __pyx_t_213 = 0;
              __pyx_t_214 = __pyx_v_d;
              __pyx_t_215 = __pyx_v_i;
              __pyx_t_216 = __pyx_v_t;
              __pyx_t_217 = __pyx_v_f;
              __pyx_t_218 = __pyx_v_aa;
              __pyx_t_219 = __pyx_v_ab;
              __pyx_t_220 = 0;
              __pyx_t_221 = 0;
              __pyx_t_222 = __pyx_v_d;
              __pyx_t_223 = __pyx_v_rr;
              __pyx_t_224 = __pyx_v_rc;
              __pyx_t_225 = __pyx_v_ab;
              __pyx_t_226 = 0;
              __pyx_t_227 = 0;
/* … */
              __pyx_t_208 = __pyx_v_d;
              __pyx_t_209 = __pyx_v_rr;
              __pyx_t_210 = __pyx_v_rc;
              __pyx_t_211 = __pyx_v_aa;
              __pyx_t_212 = 1;
              __pyx_t_213 = 0;
              __pyx_t_214 = __pyx_v_d;
              __pyx_t_215 = __pyx_v_i;
              __pyx_t_216 = __pyx_v_t;
              __pyx_t_217 = __pyx_v_f;
              __pyx_t_218 = __pyx_v_aa;
              __pyx_t_219 = __pyx_v_ab;
              __pyx_t_220 = 0;
              __pyx_t_221 = 0;
              __pyx_t_222 = __pyx_v_d;
              __pyx_t_223 = __pyx_v_rr;
              __pyx_t_224 = __pyx_v_rc;
              __pyx_t_225 = __pyx_v_ab;
              __pyx_t_226 = 0;
              __pyx_t_227 = 0;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">060</span>:                             g[d,rr,rc,aa,1,1]*m[d,i,t,f,aa,ab,1,0]*gh[d,rr,rc,ab,0,0] + \</pre>
<pre class='cython code score-0 '>              __pyx_t_228 = __pyx_v_d;
              __pyx_t_229 = __pyx_v_rr;
              __pyx_t_230 = __pyx_v_rc;
              __pyx_t_231 = __pyx_v_aa;
              __pyx_t_232 = 1;
              __pyx_t_233 = 1;
              __pyx_t_234 = __pyx_v_d;
              __pyx_t_235 = __pyx_v_i;
              __pyx_t_236 = __pyx_v_t;
              __pyx_t_237 = __pyx_v_f;
              __pyx_t_238 = __pyx_v_aa;
              __pyx_t_239 = __pyx_v_ab;
              __pyx_t_240 = 1;
              __pyx_t_241 = 0;
              __pyx_t_242 = __pyx_v_d;
              __pyx_t_243 = __pyx_v_rr;
              __pyx_t_244 = __pyx_v_rc;
              __pyx_t_245 = __pyx_v_ab;
              __pyx_t_246 = 0;
              __pyx_t_247 = 0;
/* … */
              __pyx_t_228 = __pyx_v_d;
              __pyx_t_229 = __pyx_v_rr;
              __pyx_t_230 = __pyx_v_rc;
              __pyx_t_231 = __pyx_v_aa;
              __pyx_t_232 = 1;
              __pyx_t_233 = 1;
              __pyx_t_234 = __pyx_v_d;
              __pyx_t_235 = __pyx_v_i;
              __pyx_t_236 = __pyx_v_t;
              __pyx_t_237 = __pyx_v_f;
              __pyx_t_238 = __pyx_v_aa;
              __pyx_t_239 = __pyx_v_ab;
              __pyx_t_240 = 1;
              __pyx_t_241 = 0;
              __pyx_t_242 = __pyx_v_d;
              __pyx_t_243 = __pyx_v_rr;
              __pyx_t_244 = __pyx_v_rc;
              __pyx_t_245 = __pyx_v_ab;
              __pyx_t_246 = 0;
              __pyx_t_247 = 0;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">061</span>:                             g[d,rr,rc,aa,1,0]*m[d,i,t,f,aa,ab,0,1]*gh[d,rr,rc,ab,1,0] + \</pre>
<pre class='cython code score-0 '>              __pyx_t_248 = __pyx_v_d;
              __pyx_t_249 = __pyx_v_rr;
              __pyx_t_250 = __pyx_v_rc;
              __pyx_t_251 = __pyx_v_aa;
              __pyx_t_252 = 1;
              __pyx_t_253 = 0;
              __pyx_t_254 = __pyx_v_d;
              __pyx_t_255 = __pyx_v_i;
              __pyx_t_256 = __pyx_v_t;
              __pyx_t_257 = __pyx_v_f;
              __pyx_t_258 = __pyx_v_aa;
              __pyx_t_259 = __pyx_v_ab;
              __pyx_t_260 = 0;
              __pyx_t_261 = 1;
              __pyx_t_262 = __pyx_v_d;
              __pyx_t_263 = __pyx_v_rr;
              __pyx_t_264 = __pyx_v_rc;
              __pyx_t_265 = __pyx_v_ab;
              __pyx_t_266 = 1;
              __pyx_t_267 = 0;
/* … */
              __pyx_t_248 = __pyx_v_d;
              __pyx_t_249 = __pyx_v_rr;
              __pyx_t_250 = __pyx_v_rc;
              __pyx_t_251 = __pyx_v_aa;
              __pyx_t_252 = 1;
              __pyx_t_253 = 0;
              __pyx_t_254 = __pyx_v_d;
              __pyx_t_255 = __pyx_v_i;
              __pyx_t_256 = __pyx_v_t;
              __pyx_t_257 = __pyx_v_f;
              __pyx_t_258 = __pyx_v_aa;
              __pyx_t_259 = __pyx_v_ab;
              __pyx_t_260 = 0;
              __pyx_t_261 = 1;
              __pyx_t_262 = __pyx_v_d;
              __pyx_t_263 = __pyx_v_rr;
              __pyx_t_264 = __pyx_v_rc;
              __pyx_t_265 = __pyx_v_ab;
              __pyx_t_266 = 1;
              __pyx_t_267 = 0;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">062</span>:                             g[d,rr,rc,aa,1,1]*m[d,i,t,f,aa,ab,1,1]*gh[d,rr,rc,ab,1,0])</pre>
<pre class='cython code score-0 '>              __pyx_t_268 = __pyx_v_d;
              __pyx_t_269 = __pyx_v_rr;
              __pyx_t_270 = __pyx_v_rc;
              __pyx_t_271 = __pyx_v_aa;
              __pyx_t_272 = 1;
              __pyx_t_273 = 1;
              __pyx_t_274 = __pyx_v_d;
              __pyx_t_275 = __pyx_v_i;
              __pyx_t_276 = __pyx_v_t;
              __pyx_t_277 = __pyx_v_f;
              __pyx_t_278 = __pyx_v_aa;
              __pyx_t_279 = __pyx_v_ab;
              __pyx_t_280 = 1;
              __pyx_t_281 = 1;
              __pyx_t_282 = __pyx_v_d;
              __pyx_t_283 = __pyx_v_rr;
              __pyx_t_284 = __pyx_v_rc;
              __pyx_t_285 = __pyx_v_ab;
              __pyx_t_286 = 1;
              __pyx_t_287 = 0;
/* … */
              __pyx_t_268 = __pyx_v_d;
              __pyx_t_269 = __pyx_v_rr;
              __pyx_t_270 = __pyx_v_rc;
              __pyx_t_271 = __pyx_v_aa;
              __pyx_t_272 = 1;
              __pyx_t_273 = 1;
              __pyx_t_274 = __pyx_v_d;
              __pyx_t_275 = __pyx_v_i;
              __pyx_t_276 = __pyx_v_t;
              __pyx_t_277 = __pyx_v_f;
              __pyx_t_278 = __pyx_v_aa;
              __pyx_t_279 = __pyx_v_ab;
              __pyx_t_280 = 1;
              __pyx_t_281 = 1;
              __pyx_t_282 = __pyx_v_d;
              __pyx_t_283 = __pyx_v_rr;
              __pyx_t_284 = __pyx_v_rc;
              __pyx_t_285 = __pyx_v_ab;
              __pyx_t_286 = 1;
              __pyx_t_287 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">063</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">064</span>:                             r[i,t,f,aa,ab,1,1] = o[i,t,f,aa,ab,1,1] - (</pre>
<pre class='cython code score-0 '>              __pyx_t_295 = __pyx_v_i;
              __pyx_t_296 = __pyx_v_t;
              __pyx_t_297 = __pyx_v_f;
              __pyx_t_298 = __pyx_v_aa;
              __pyx_t_299 = __pyx_v_ab;
              __pyx_t_300 = 1;
              __pyx_t_301 = 1;
/* … */
              __pyx_t_382 = __pyx_v_i;
              __pyx_t_383 = __pyx_v_t;
              __pyx_t_384 = __pyx_v_f;
              __pyx_t_385 = __pyx_v_aa;
              __pyx_t_386 = __pyx_v_ab;
              __pyx_t_387 = 1;
              __pyx_t_388 = 1;
              *__Pyx_BufPtrStrided7d(__pyx_t_float_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_382, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_383, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_384, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_385, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_386, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_387, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_388, __pyx_pybuffernd_r.diminfo[6].strides) = __Pyx_c_difff((*__Pyx_BufPtrStrided7d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_295, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_296, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_297, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_298, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_299, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_300, __pyx_pybuffernd_o.diminfo[5].strides, __pyx_t_301, __pyx_pybuffernd_o.diminfo[6].strides)), __Pyx_c_sumf(__Pyx_c_sumf(__Pyx_c_sumf(__Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_302, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_303, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_304, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_305, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_306, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_307, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_308, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_309, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_310, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_311, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_312, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_313, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_314, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_315, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_316, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_317, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_318, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_319, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_320, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_321, __pyx_pybuffernd_gh.diminfo[5].strides))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_322, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_323, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_324, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_325, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_326, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_327, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_328, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_329, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_330, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_331, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_332, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_333, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_334, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_335, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_336, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_337, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_338, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_339, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_340, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_341, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_342, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_343, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_344, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_345, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_346, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_347, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_348, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_349, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_350, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_351, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_352, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_353, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_354, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_355, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_356, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_357, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_358, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_359, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_360, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_361, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_362, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_363, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_364, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_365, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_366, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_367, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_368, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_369, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_370, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_371, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_372, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_373, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_374, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_375, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_376, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_377, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_378, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_379, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_380, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_381, __pyx_pybuffernd_gh.diminfo[5].strides)))));
            }
          }
        }
      }
    }
  }
/* … */
              __pyx_t_295 = __pyx_v_i;
              __pyx_t_296 = __pyx_v_t;
              __pyx_t_297 = __pyx_v_f;
              __pyx_t_298 = __pyx_v_aa;
              __pyx_t_299 = __pyx_v_ab;
              __pyx_t_300 = 1;
              __pyx_t_301 = 1;
/* … */
              __pyx_t_382 = __pyx_v_i;
              __pyx_t_383 = __pyx_v_t;
              __pyx_t_384 = __pyx_v_f;
              __pyx_t_385 = __pyx_v_aa;
              __pyx_t_386 = __pyx_v_ab;
              __pyx_t_387 = 1;
              __pyx_t_388 = 1;
              *__Pyx_BufPtrStrided7d(__pyx_t_double_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_382, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_383, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_384, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_385, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_386, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_387, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_388, __pyx_pybuffernd_r.diminfo[6].strides) = __Pyx_c_diff((*__Pyx_BufPtrStrided7d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_295, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_296, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_297, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_298, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_299, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_300, __pyx_pybuffernd_o.diminfo[5].strides, __pyx_t_301, __pyx_pybuffernd_o.diminfo[6].strides)), __Pyx_c_sum(__Pyx_c_sum(__Pyx_c_sum(__Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_302, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_303, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_304, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_305, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_306, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_307, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_308, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_309, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_310, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_311, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_312, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_313, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_314, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_315, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_316, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_317, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_318, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_319, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_320, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_321, __pyx_pybuffernd_gh.diminfo[5].strides))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_322, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_323, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_324, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_325, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_326, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_327, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_328, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_329, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_330, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_331, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_332, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_333, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_334, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_335, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_336, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_337, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_338, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_339, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_340, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_341, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_342, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_343, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_344, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_345, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_346, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_347, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_348, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_349, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_350, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_351, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_352, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_353, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_354, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_355, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_356, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_357, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_358, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_359, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_360, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_361, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_362, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_363, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_364, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_365, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_366, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_367, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_368, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_369, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_370, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_371, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_372, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_373, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_374, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_375, __pyx_pybuffernd_m.diminfo[7].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_376, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_377, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_378, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_379, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_380, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_381, __pyx_pybuffernd_gh.diminfo[5].strides)))));
            }
          }
        }
      }
    }
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">065</span>:                             g[d,rr,rc,aa,1,0]*m[d,i,t,f,aa,ab,0,0]*gh[d,rr,rc,ab,0,1] + \</pre>
<pre class='cython code score-0 '>              __pyx_t_302 = __pyx_v_d;
              __pyx_t_303 = __pyx_v_rr;
              __pyx_t_304 = __pyx_v_rc;
              __pyx_t_305 = __pyx_v_aa;
              __pyx_t_306 = 1;
              __pyx_t_307 = 0;
              __pyx_t_308 = __pyx_v_d;
              __pyx_t_309 = __pyx_v_i;
              __pyx_t_310 = __pyx_v_t;
              __pyx_t_311 = __pyx_v_f;
              __pyx_t_312 = __pyx_v_aa;
              __pyx_t_313 = __pyx_v_ab;
              __pyx_t_314 = 0;
              __pyx_t_315 = 0;
              __pyx_t_316 = __pyx_v_d;
              __pyx_t_317 = __pyx_v_rr;
              __pyx_t_318 = __pyx_v_rc;
              __pyx_t_319 = __pyx_v_ab;
              __pyx_t_320 = 0;
              __pyx_t_321 = 1;
/* … */
              __pyx_t_302 = __pyx_v_d;
              __pyx_t_303 = __pyx_v_rr;
              __pyx_t_304 = __pyx_v_rc;
              __pyx_t_305 = __pyx_v_aa;
              __pyx_t_306 = 1;
              __pyx_t_307 = 0;
              __pyx_t_308 = __pyx_v_d;
              __pyx_t_309 = __pyx_v_i;
              __pyx_t_310 = __pyx_v_t;
              __pyx_t_311 = __pyx_v_f;
              __pyx_t_312 = __pyx_v_aa;
              __pyx_t_313 = __pyx_v_ab;
              __pyx_t_314 = 0;
              __pyx_t_315 = 0;
              __pyx_t_316 = __pyx_v_d;
              __pyx_t_317 = __pyx_v_rr;
              __pyx_t_318 = __pyx_v_rc;
              __pyx_t_319 = __pyx_v_ab;
              __pyx_t_320 = 0;
              __pyx_t_321 = 1;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">066</span>:                             g[d,rr,rc,aa,1,1]*m[d,i,t,f,aa,ab,1,0]*gh[d,rr,rc,ab,0,1] + \</pre>
<pre class='cython code score-0 '>              __pyx_t_322 = __pyx_v_d;
              __pyx_t_323 = __pyx_v_rr;
              __pyx_t_324 = __pyx_v_rc;
              __pyx_t_325 = __pyx_v_aa;
              __pyx_t_326 = 1;
              __pyx_t_327 = 1;
              __pyx_t_328 = __pyx_v_d;
              __pyx_t_329 = __pyx_v_i;
              __pyx_t_330 = __pyx_v_t;
              __pyx_t_331 = __pyx_v_f;
              __pyx_t_332 = __pyx_v_aa;
              __pyx_t_333 = __pyx_v_ab;
              __pyx_t_334 = 1;
              __pyx_t_335 = 0;
              __pyx_t_336 = __pyx_v_d;
              __pyx_t_337 = __pyx_v_rr;
              __pyx_t_338 = __pyx_v_rc;
              __pyx_t_339 = __pyx_v_ab;
              __pyx_t_340 = 0;
              __pyx_t_341 = 1;
/* … */
              __pyx_t_322 = __pyx_v_d;
              __pyx_t_323 = __pyx_v_rr;
              __pyx_t_324 = __pyx_v_rc;
              __pyx_t_325 = __pyx_v_aa;
              __pyx_t_326 = 1;
              __pyx_t_327 = 1;
              __pyx_t_328 = __pyx_v_d;
              __pyx_t_329 = __pyx_v_i;
              __pyx_t_330 = __pyx_v_t;
              __pyx_t_331 = __pyx_v_f;
              __pyx_t_332 = __pyx_v_aa;
              __pyx_t_333 = __pyx_v_ab;
              __pyx_t_334 = 1;
              __pyx_t_335 = 0;
              __pyx_t_336 = __pyx_v_d;
              __pyx_t_337 = __pyx_v_rr;
              __pyx_t_338 = __pyx_v_rc;
              __pyx_t_339 = __pyx_v_ab;
              __pyx_t_340 = 0;
              __pyx_t_341 = 1;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">067</span>:                             g[d,rr,rc,aa,1,0]*m[d,i,t,f,aa,ab,0,1]*gh[d,rr,rc,ab,1,1] + \</pre>
<pre class='cython code score-0 '>              __pyx_t_342 = __pyx_v_d;
              __pyx_t_343 = __pyx_v_rr;
              __pyx_t_344 = __pyx_v_rc;
              __pyx_t_345 = __pyx_v_aa;
              __pyx_t_346 = 1;
              __pyx_t_347 = 0;
              __pyx_t_348 = __pyx_v_d;
              __pyx_t_349 = __pyx_v_i;
              __pyx_t_350 = __pyx_v_t;
              __pyx_t_351 = __pyx_v_f;
              __pyx_t_352 = __pyx_v_aa;
              __pyx_t_353 = __pyx_v_ab;
              __pyx_t_354 = 0;
              __pyx_t_355 = 1;
              __pyx_t_356 = __pyx_v_d;
              __pyx_t_357 = __pyx_v_rr;
              __pyx_t_358 = __pyx_v_rc;
              __pyx_t_359 = __pyx_v_ab;
              __pyx_t_360 = 1;
              __pyx_t_361 = 1;
/* … */
              __pyx_t_342 = __pyx_v_d;
              __pyx_t_343 = __pyx_v_rr;
              __pyx_t_344 = __pyx_v_rc;
              __pyx_t_345 = __pyx_v_aa;
              __pyx_t_346 = 1;
              __pyx_t_347 = 0;
              __pyx_t_348 = __pyx_v_d;
              __pyx_t_349 = __pyx_v_i;
              __pyx_t_350 = __pyx_v_t;
              __pyx_t_351 = __pyx_v_f;
              __pyx_t_352 = __pyx_v_aa;
              __pyx_t_353 = __pyx_v_ab;
              __pyx_t_354 = 0;
              __pyx_t_355 = 1;
              __pyx_t_356 = __pyx_v_d;
              __pyx_t_357 = __pyx_v_rr;
              __pyx_t_358 = __pyx_v_rc;
              __pyx_t_359 = __pyx_v_ab;
              __pyx_t_360 = 1;
              __pyx_t_361 = 1;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">068</span>:                             g[d,rr,rc,aa,1,1]*m[d,i,t,f,aa,ab,1,1]*gh[d,rr,rc,ab,1,1])</pre>
<pre class='cython code score-0 '>              __pyx_t_362 = __pyx_v_d;
              __pyx_t_363 = __pyx_v_rr;
              __pyx_t_364 = __pyx_v_rc;
              __pyx_t_365 = __pyx_v_aa;
              __pyx_t_366 = 1;
              __pyx_t_367 = 1;
              __pyx_t_368 = __pyx_v_d;
              __pyx_t_369 = __pyx_v_i;
              __pyx_t_370 = __pyx_v_t;
              __pyx_t_371 = __pyx_v_f;
              __pyx_t_372 = __pyx_v_aa;
              __pyx_t_373 = __pyx_v_ab;
              __pyx_t_374 = 1;
              __pyx_t_375 = 1;
              __pyx_t_376 = __pyx_v_d;
              __pyx_t_377 = __pyx_v_rr;
              __pyx_t_378 = __pyx_v_rc;
              __pyx_t_379 = __pyx_v_ab;
              __pyx_t_380 = 1;
              __pyx_t_381 = 1;
/* … */
              __pyx_t_362 = __pyx_v_d;
              __pyx_t_363 = __pyx_v_rr;
              __pyx_t_364 = __pyx_v_rc;
              __pyx_t_365 = __pyx_v_aa;
              __pyx_t_366 = 1;
              __pyx_t_367 = 1;
              __pyx_t_368 = __pyx_v_d;
              __pyx_t_369 = __pyx_v_i;
              __pyx_t_370 = __pyx_v_t;
              __pyx_t_371 = __pyx_v_f;
              __pyx_t_372 = __pyx_v_aa;
              __pyx_t_373 = __pyx_v_ab;
              __pyx_t_374 = 1;
              __pyx_t_375 = 1;
              __pyx_t_376 = __pyx_v_d;
              __pyx_t_377 = __pyx_v_rr;
              __pyx_t_378 = __pyx_v_rc;
              __pyx_t_379 = __pyx_v_ab;
              __pyx_t_380 = 1;
              __pyx_t_381 = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">069</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">070</span>: @cython.cdivision(True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">071</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>: @cython.nonecheck(False)</pre>
<pre class="cython line score-637" onclick='toggleDiv(this)'>+<span class="">074</span>: def cycompute_jh(np.ndarray[complex3264, ndim=8] m,</pre>
<pre class='cython code score-637 '>/* Python wrapper */
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_3cycompute_jh(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_2cycompute_jh[] = "\n    This computes the the non-zero elements of jh. The result does have a model index.  \n    ";
static PyMethodDef __pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_3cycompute_jh = {"cycompute_jh", (PyCFunction)__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_3cycompute_jh, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_2cycompute_jh};
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_3cycompute_jh(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_signatures = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED PyObject *__pyx_v_defaults = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fused_cpdef (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_signatures,&amp;__pyx_n_s_args,&amp;__pyx_n_s_kwargs,&amp;__pyx_n_s_defaults,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_signatures)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_args)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_kwargs)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_defaults)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_fused_cpdef") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_signatures = values[0];
    __pyx_v_args = values[1];
    __pyx_v_kwargs = values[2];
    __pyx_v_defaults = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_2cycompute_jh(__pyx_self, __pyx_v_signatures, __pyx_v_args, __pyx_v_kwargs, __pyx_v_defaults);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_2cycompute_jh(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_signatures, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs, CYTHON_UNUSED PyObject *__pyx_v_defaults) {
  PyObject *__pyx_v_dest_sig = NULL;
  PyTypeObject *__pyx_v_ndarray = 0;
  PyObject *__pyx_v_numpy = NULL;
  __Pyx_memviewslice __pyx_v_memslice;
  Py_ssize_t __pyx_v_itemsize;
  CYTHON_UNUSED int __pyx_v_dtype_signed;
  char __pyx_v_kind;
  PyObject *__pyx_v_arg = NULL;
  PyObject *__pyx_v_dtype = NULL;
  PyObject *__pyx_v_arg_base = NULL;
  PyObject *__pyx_v_candidates = NULL;
  PyObject *__pyx_v_sig = NULL;
  int __pyx_v_match_found;
  PyObject *__pyx_v_src_type = NULL;
  PyObject *__pyx_v_dst_type = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_jh", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kwargs);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, Py_None);
  __pyx_v_dest_sig = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_2 = (__pyx_v_kwargs == Py_None);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kwargs, __pyx_t_1);
    __pyx_t_1 = 0;
  }
  {
    /*try:*/ {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_v_numpy = __pyx_t_1;
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_numpy, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!(likely(<span class='py_c_api'>PyType_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "type", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      __pyx_v_ndarray = ((PyTypeObject*)__pyx_t_1);
      __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L11_try_end;
    __pyx_L4_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_ImportError) || <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_AttributeError) || <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_TypeError);
    if (__pyx_t_7) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_1, &amp;__pyx_t_8, &amp;__pyx_t_9) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L6_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ndarray, ((PyTypeObject*)Py_None));
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L5_exception_handled;
    }
    goto __pyx_L6_except_error;
    __pyx_L6_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    goto __pyx_L1_error;
    __pyx_L5_exception_handled:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    __pyx_L11_try_end:;
  }
  __pyx_v_itemsize = -1L;
  if (unlikely(__pyx_v_args == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = ((0 &lt; __pyx_t_10) != 0);
  if (__pyx_t_3) {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(((PyObject*)__pyx_v_args), 0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
    __pyx_v_arg = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L14;
  }
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyDict_ContainsTF</span>(__pyx_n_s_m, ((PyObject*)__pyx_v_kwargs), Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {
    if (unlikely(__pyx_v_kwargs == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_kwargs), __pyx_n_s_m);<span class='error_goto'> if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_v_arg = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L14;
  }
  /*else*/ {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_Expected_at_least_d_arguments, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_L14:;
  while (1) {
    __pyx_t_2 = (__pyx_v_ndarray != ((PyTypeObject*)Py_None));
    __pyx_t_3 = (__pyx_t_2 != 0);
    if (__pyx_t_3) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_arg, __pyx_v_ndarray); 
      __pyx_t_2 = (__pyx_t_3 != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_v_dtype = __pyx_t_8;
        __pyx_t_8 = 0;
        goto __pyx_L18;
      }
      __pyx_t_2 = (__pyx_memoryview_check(__pyx_v_arg) != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_base);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_v_arg_base = __pyx_t_8;
        __pyx_t_8 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_arg_base, __pyx_v_ndarray); 
        __pyx_t_3 = (__pyx_t_2 != 0);
        if (__pyx_t_3) {
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg_base, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_v_dtype = __pyx_t_8;
          __pyx_t_8 = 0;
          goto __pyx_L19;
        }
        /*else*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
          __pyx_v_dtype = Py_None;
        }
        __pyx_L19:;
        goto __pyx_L18;
      }
      /*else*/ {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
        __pyx_v_dtype = Py_None;
      }
      __pyx_L18:;
      __pyx_v_itemsize = -1L;
      __pyx_t_3 = (__pyx_v_dtype != Py_None);
      __pyx_t_2 = (__pyx_t_3 != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dtype, __pyx_n_s_itemsize);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_itemsize = __pyx_t_10;
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dtype, __pyx_n_s_kind);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Ord</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(__pyx_t_11 == (long)(Py_UCS4)-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_kind = __pyx_t_11;
        __pyx_v_dtype_signed = (__pyx_v_kind == 'i');
        switch (__pyx_v_kind) {
          case 'i':
          case 'u':
          break;
          case 'f':
          break;
          case 'c':
          __pyx_t_3 = (((sizeof(__pyx_t_float_complex)) == __pyx_v_itemsize) != 0);
          if (__pyx_t_3) {
          } else {
            __pyx_t_2 = __pyx_t_3;
            goto __pyx_L22_bool_binop_done;
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_3 = ((((Py_ssize_t)__pyx_t_10) == 8) != 0);
          __pyx_t_2 = __pyx_t_3;
          __pyx_L22_bool_binop_done:;
          if (__pyx_t_2) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            goto __pyx_L16_break;
          }
          __pyx_t_3 = (((sizeof(__pyx_t_double_complex)) == __pyx_v_itemsize) != 0);
          if (__pyx_t_3) {
          } else {
            __pyx_t_2 = __pyx_t_3;
            goto __pyx_L25_bool_binop_done;
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_3 = ((((Py_ssize_t)__pyx_t_10) == 8) != 0);
          __pyx_t_2 = __pyx_t_3;
          __pyx_L25_bool_binop_done:;
          if (__pyx_t_2) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            goto __pyx_L16_break;
          }
          break;
          case 'O':
          break;
          default: break;
        }
      }
    }
    __pyx_t_3 = ((__pyx_v_itemsize == -1L) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L28_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_itemsize == (sizeof(__pyx_t_float_complex))) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L28_bool_binop_done:;
    if (__pyx_t_2) {
      __pyx_v_memslice = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsdsdsdsds___pyx_t_float_complex</span>(__pyx_v_arg);
      __pyx_t_2 = (__pyx_v_memslice.memview != 0);
      if (__pyx_t_2) {
        __PYX_XDEC_MEMVIEW((&amp;__pyx_v_memslice), 1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L16_break;
      }
      /*else*/ {
        <span class='py_c_api'>PyErr_Clear</span>();
      }
    }
    __pyx_t_3 = ((__pyx_v_itemsize == -1L) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L32_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_itemsize == (sizeof(__pyx_t_double_complex))) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L32_bool_binop_done:;
    if (__pyx_t_2) {
      __pyx_v_memslice = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsdsdsdsds___pyx_t_double_complex</span>(__pyx_v_arg);
      __pyx_t_2 = (__pyx_v_memslice.memview != 0);
      if (__pyx_t_2) {
        __PYX_XDEC_MEMVIEW((&amp;__pyx_v_memslice), 1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L16_break;
      }
      /*else*/ {
        <span class='py_c_api'>PyErr_Clear</span>();
      }
    }
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, Py_None, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L16_break;
  }
  __pyx_L16_break:;
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_v_candidates = ((PyObject*)__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_10 = 0;
  if (unlikely(__pyx_v_signatures == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_9 = __Pyx_dict_iterator(((PyObject*)__pyx_v_signatures), 1, ((PyObject *)NULL), (&amp;__pyx_t_12), (&amp;__pyx_t_7));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __pyx_t_8 = __pyx_t_9;
  __pyx_t_9 = 0;
  while (1) {
    __pyx_t_13 = __Pyx_dict_iter_next(__pyx_t_8, __pyx_t_12, &amp;__pyx_t_10, &amp;__pyx_t_9, NULL, NULL, __pyx_t_7);
    if (unlikely(__pyx_t_13 == 0)) break;
    if (unlikely(__pyx_t_13 == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_sig, __pyx_t_9);
    __pyx_t_9 = 0;
    __pyx_v_match_found = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_sig, __pyx_n_s_strip);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_split);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dest_sig);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dest_sig);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_dest_sig);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_9 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_14 = 0;
      __pyx_t_15 = NULL;
    } else {
      __pyx_t_14 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_15 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_15)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_15(__pyx_t_9);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        PyObject* sequence = __pyx_t_1;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_16 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_17 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_16 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_17 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
        #else
        __pyx_t_16 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        __pyx_t_17 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_18 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_19 = Py_TYPE(__pyx_t_18)-&gt;tp_iternext;
        index = 0; __pyx_t_16 = __pyx_t_19(__pyx_t_18); if (unlikely(!__pyx_t_16)) goto __pyx_L39_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        index = 1; __pyx_t_17 = __pyx_t_19(__pyx_t_18); if (unlikely(!__pyx_t_17)) goto __pyx_L39_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_19(__pyx_t_18), 2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_19 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        goto __pyx_L40_unpacking_done;
        __pyx_L39_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_t_19 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_L40_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_src_type, __pyx_t_16);
      __pyx_t_16 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dst_type, __pyx_t_17);
      __pyx_t_17 = 0;
      __pyx_t_2 = (__pyx_v_dst_type != Py_None);
      __pyx_t_3 = (__pyx_t_2 != 0);
      if (__pyx_t_3) {
        __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_src_type, __pyx_v_dst_type, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (__pyx_t_3) {
          __pyx_v_match_found = 1;
          goto __pyx_L42;
        }
        /*else*/ {
          __pyx_v_match_found = 0;
          goto __pyx_L38_break;
        }
        __pyx_L42:;
      }
    }
    __pyx_L38_break:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_3 = (__pyx_v_match_found != 0);
    if (__pyx_t_3) {
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_candidates, __pyx_v_sig);<span class='error_goto'> if (unlikely(__pyx_t_20 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_3 = (__pyx_v_candidates != Py_None) &amp;&amp; (<span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates) != 0);
  __pyx_t_2 = ((!__pyx_t_3) != 0);
  if (__pyx_t_2) {
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s__3);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_12 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates);<span class='error_goto'> if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = ((__pyx_t_12 &gt; 1) != 0);
  if (__pyx_t_2) {
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_No_matching_signature_found);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(__pyx_v_signatures == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_signatures), <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_candidates, 0));<span class='error_goto'> if (unlikely(__pyx_t_8 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_r = __pyx_t_8;
    __pyx_t_8 = 0;
    goto __pyx_L0;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dest_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_numpy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dtype);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg_base);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_candidates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_src_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dst_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_23cycompute_jh(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_fuse_0__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_23cycompute_jh = {"__pyx_fuse_0cycompute_jh", (PyCFunction)__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_23cycompute_jh, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_2cycompute_jh};
static PyObject *__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_23cycompute_jh(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_m = 0;
  PyArrayObject *__pyx_v_g = 0;
  PyArrayObject *__pyx_v_jh = 0;
  int __pyx_v_t_int;
  int __pyx_v_f_int;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_jh (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_m,&amp;__pyx_n_s_g,&amp;__pyx_n_s_jh,&amp;__pyx_n_s_t_int,&amp;__pyx_n_s_f_int,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_m)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_g)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jh", 1, 5, 5, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jh", 1, 5, 5, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_t_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jh", 1, 5, 5, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jh", 1, 5, 5, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cycompute_jh") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_m = ((PyArrayObject *)values[0]);
    __pyx_v_g = ((PyArrayObject *)values[1]);
    __pyx_v_jh = ((PyArrayObject *)values[2]);
    __pyx_v_t_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_t_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_f_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_f_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jh", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_jh", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_m), __pyx_ptype_5numpy_ndarray, 1, "m", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jh), __pyx_ptype_5numpy_ndarray, 1, "jh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_22cycompute_jh(__pyx_self, __pyx_v_m, __pyx_v_g, __pyx_v_jh, __pyx_v_t_int, __pyx_v_f_int);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_22cycompute_jh(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_m, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_jh, int __pyx_v_t_int, int __pyx_v_f_int) {
  int __pyx_v_d;
  int __pyx_v_i;
  int __pyx_v_t;
  int __pyx_v_f;
  int __pyx_v_aa;
  int __pyx_v_ab;
  int __pyx_v_rr;
  int __pyx_v_rc;
  int __pyx_v_n_dir;
  int __pyx_v_n_mod;
  int __pyx_v_n_tim;
  int __pyx_v_n_fre;
  int __pyx_v_n_ant;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_g;
  __Pyx_Buffer __pyx_pybuffer_g;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jh;
  __Pyx_Buffer __pyx_pybuffer_jh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_m;
  __Pyx_Buffer __pyx_pybuffer_m;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_0cycompute_jh", 0);
  __pyx_pybuffer_m.pybuffer.buf = NULL;
  __pyx_pybuffer_m.refcount = 0;
  __pyx_pybuffernd_m.data = NULL;
  __pyx_pybuffernd_m.rcbuffer = &amp;__pyx_pybuffer_m;
  __pyx_pybuffer_g.pybuffer.buf = NULL;
  __pyx_pybuffer_g.refcount = 0;
  __pyx_pybuffernd_g.data = NULL;
  __pyx_pybuffernd_g.rcbuffer = &amp;__pyx_pybuffer_g;
  __pyx_pybuffer_jh.pybuffer.buf = NULL;
  __pyx_pybuffer_jh.refcount = 0;
  __pyx_pybuffernd_jh.data = NULL;
  __pyx_pybuffernd_jh.rcbuffer = &amp;__pyx_pybuffer_jh;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_m.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_m, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 8, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_m.diminfo[0].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_m.diminfo[0].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_m.diminfo[1].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_m.diminfo[1].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_m.diminfo[2].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_m.diminfo[2].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_m.diminfo[3].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_m.diminfo[3].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_m.diminfo[4].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_m.diminfo[4].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_m.diminfo[5].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_m.diminfo[5].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_m.diminfo[6].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_m.diminfo[6].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[6]; __pyx_pybuffernd_m.diminfo[7].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[7]; __pyx_pybuffernd_m.diminfo[7].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[7];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_g, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_g.diminfo[0].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_g.diminfo[0].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_g.diminfo[1].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_g.diminfo[1].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_g.diminfo[2].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_g.diminfo[2].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_g.diminfo[3].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_g.diminfo[3].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_g.diminfo[4].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_g.diminfo[4].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_g.diminfo[5].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_g.diminfo[5].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jh, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 8, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jh.diminfo[0].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jh.diminfo[0].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jh.diminfo[1].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jh.diminfo[1].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jh.diminfo[2].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jh.diminfo[2].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jh.diminfo[3].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jh.diminfo[3].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jh.diminfo[4].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jh.diminfo[4].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jh.diminfo[5].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jh.diminfo[5].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_jh.diminfo[6].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_jh.diminfo[6].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[6]; __pyx_pybuffernd_jh.diminfo[7].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[7]; __pyx_pybuffernd_jh.diminfo[7].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[7];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_m.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_jh", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_m.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_25cycompute_jh(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_fuse_1__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_25cycompute_jh = {"__pyx_fuse_1cycompute_jh", (PyCFunction)__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_25cycompute_jh, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_2cycompute_jh};
static PyObject *__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_25cycompute_jh(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_m = 0;
  PyArrayObject *__pyx_v_g = 0;
  PyArrayObject *__pyx_v_jh = 0;
  int __pyx_v_t_int;
  int __pyx_v_f_int;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_jh (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_m,&amp;__pyx_n_s_g,&amp;__pyx_n_s_jh,&amp;__pyx_n_s_t_int,&amp;__pyx_n_s_f_int,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_m)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_g)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jh", 1, 5, 5, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jh", 1, 5, 5, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_t_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jh", 1, 5, 5, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jh", 1, 5, 5, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cycompute_jh") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_m = ((PyArrayObject *)values[0]);
    __pyx_v_g = ((PyArrayObject *)values[1]);
    __pyx_v_jh = ((PyArrayObject *)values[2]);
    __pyx_v_t_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_t_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_f_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_f_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jh", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_jh", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_m), __pyx_ptype_5numpy_ndarray, 1, "m", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jh), __pyx_ptype_5numpy_ndarray, 1, "jh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_24cycompute_jh(__pyx_self, __pyx_v_m, __pyx_v_g, __pyx_v_jh, __pyx_v_t_int, __pyx_v_f_int);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_24cycompute_jh(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_m, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_jh, int __pyx_v_t_int, int __pyx_v_f_int) {
  int __pyx_v_d;
  int __pyx_v_i;
  int __pyx_v_t;
  int __pyx_v_f;
  int __pyx_v_aa;
  int __pyx_v_ab;
  int __pyx_v_rr;
  int __pyx_v_rc;
  int __pyx_v_n_dir;
  int __pyx_v_n_mod;
  int __pyx_v_n_tim;
  int __pyx_v_n_fre;
  int __pyx_v_n_ant;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_g;
  __Pyx_Buffer __pyx_pybuffer_g;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jh;
  __Pyx_Buffer __pyx_pybuffer_jh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_m;
  __Pyx_Buffer __pyx_pybuffer_m;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_1cycompute_jh", 0);
  __pyx_pybuffer_m.pybuffer.buf = NULL;
  __pyx_pybuffer_m.refcount = 0;
  __pyx_pybuffernd_m.data = NULL;
  __pyx_pybuffernd_m.rcbuffer = &amp;__pyx_pybuffer_m;
  __pyx_pybuffer_g.pybuffer.buf = NULL;
  __pyx_pybuffer_g.refcount = 0;
  __pyx_pybuffernd_g.data = NULL;
  __pyx_pybuffernd_g.rcbuffer = &amp;__pyx_pybuffer_g;
  __pyx_pybuffer_jh.pybuffer.buf = NULL;
  __pyx_pybuffer_jh.refcount = 0;
  __pyx_pybuffernd_jh.data = NULL;
  __pyx_pybuffernd_jh.rcbuffer = &amp;__pyx_pybuffer_jh;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_m.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_m, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES, 8, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_m.diminfo[0].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_m.diminfo[0].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_m.diminfo[1].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_m.diminfo[1].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_m.diminfo[2].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_m.diminfo[2].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_m.diminfo[3].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_m.diminfo[3].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_m.diminfo[4].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_m.diminfo[4].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_m.diminfo[5].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_m.diminfo[5].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_m.diminfo[6].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_m.diminfo[6].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[6]; __pyx_pybuffernd_m.diminfo[7].strides = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.strides[7]; __pyx_pybuffernd_m.diminfo[7].shape = __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.shape[7];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_g, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_g.diminfo[0].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_g.diminfo[0].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_g.diminfo[1].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_g.diminfo[1].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_g.diminfo[2].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_g.diminfo[2].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_g.diminfo[3].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_g.diminfo[3].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_g.diminfo[4].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_g.diminfo[4].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_g.diminfo[5].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_g.diminfo[5].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jh, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 8, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jh.diminfo[0].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jh.diminfo[0].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jh.diminfo[1].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jh.diminfo[1].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jh.diminfo[2].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jh.diminfo[2].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jh.diminfo[3].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jh.diminfo[3].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jh.diminfo[4].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jh.diminfo[4].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jh.diminfo[5].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jh.diminfo[5].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_jh.diminfo[6].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_jh.diminfo[6].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[6]; __pyx_pybuffernd_jh.diminfo[7].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[7]; __pyx_pybuffernd_jh.diminfo[7].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[7];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_m.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_jh", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_m.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Function_call_with_ambiguous_arg);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
/* … */
  __pyx_tuple__60 = <span class='py_c_api'>PyTuple_Pack</span>(18, __pyx_n_s_m, __pyx_n_s_g, __pyx_n_s_jh, __pyx_n_s_t_int, __pyx_n_s_f_int, __pyx_n_s_d, __pyx_n_s_i, __pyx_n_s_t, __pyx_n_s_f, __pyx_n_s_aa, __pyx_n_s_ab, __pyx_n_s_rr, __pyx_n_s_rc, __pyx_n_s_n_dir, __pyx_n_s_n_mod, __pyx_n_s_n_tim, __pyx_n_s_n_fre, __pyx_n_s_n_ant);<span class='error_goto'> if (unlikely(!__pyx_tuple__60)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__60);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__60);
/* … */
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = __pyx_FusedFunction_NewEx(&amp;__pyx_fuse_0__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_23cycompute_jh, 0, __pyx_n_s_cycompute_jh, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__61));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_kp_s_float_complex, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_FusedFunction_NewEx(&amp;__pyx_fuse_1__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_25cycompute_jh, 0, __pyx_n_s_cycompute_jh, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__61));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_kp_s_double_complex, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_FusedFunction_NewEx(&amp;__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_3cycompute_jh, 0, __pyx_n_s_cycompute_jh, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__61));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_empty_tuple);
  ((__pyx_FusedFunctionObject *) __pyx_t_4)-&gt;__signatures__ = __pyx_t_3;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_cycompute_jh, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__61 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 18, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__60, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_ulrich_CubeCal_cubecal_ker, __pyx_n_s_cycompute_jh, 74, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__61)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">075</span>:                  np.ndarray[complex3264, ndim=6] g,</pre>
<pre class="cython line score-0">&#xA0;<span class="">076</span>:                  np.ndarray[complex3264, ndim=8] jh,</pre>
<pre class="cython line score-0">&#xA0;<span class="">077</span>:                  int t_int,</pre>
<pre class="cython line score-0">&#xA0;<span class="">078</span>:                  int f_int):</pre>
<pre class="cython line score-0">&#xA0;<span class="">079</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">081</span>:     This computes the the non-zero elements of jh. The result does have a model index.</pre>
<pre class="cython line score-0">&#xA0;<span class="">082</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">083</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">084</span>:     cdef int d, i, t, f, aa, ab, rr, rc = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_rc = 0;
/* … */
  __pyx_v_rc = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">085</span>:     cdef int n_dir, n_mod, n_tim, n_fre, n_ant</pre>
<pre class="cython line score-0">&#xA0;<span class="">086</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">087</span>:     n_dir = m.shape[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_dir = (__pyx_v_m-&gt;dimensions[0]);
/* … */
  __pyx_v_n_dir = (__pyx_v_m-&gt;dimensions[0]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">088</span>:     n_mod = m.shape[1]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_mod = (__pyx_v_m-&gt;dimensions[1]);
/* … */
  __pyx_v_n_mod = (__pyx_v_m-&gt;dimensions[1]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">089</span>:     n_tim = m.shape[2]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_tim = (__pyx_v_m-&gt;dimensions[2]);
/* … */
  __pyx_v_n_tim = (__pyx_v_m-&gt;dimensions[2]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">090</span>:     n_fre = m.shape[3]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_fre = (__pyx_v_m-&gt;dimensions[3]);
/* … */
  __pyx_v_n_fre = (__pyx_v_m-&gt;dimensions[3]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">091</span>:     n_ant = m.shape[4]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_ant = (__pyx_v_m-&gt;dimensions[4]);
/* … */
  __pyx_v_n_ant = (__pyx_v_m-&gt;dimensions[4]);
</pre><pre class="cython line score-0">&#xA0;<span class="">092</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">093</span>:     for d in xrange(n_dir):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_n_dir;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
/* … */
  __pyx_t_1 = __pyx_v_n_dir;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">094</span>:         for i in xrange(n_mod):</pre>
<pre class='cython code score-0 '>    __pyx_t_3 = __pyx_v_n_mod;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_i = __pyx_t_4;
/* … */
    __pyx_t_3 = __pyx_v_n_mod;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">095</span>:             for t in xrange(n_tim):</pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_n_tim;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_t = __pyx_t_6;
/* … */
      __pyx_t_5 = __pyx_v_n_tim;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_t = __pyx_t_6;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">096</span>:                 rr = t/t_int</pre>
<pre class='cython code score-0 '>        __pyx_v_rr = (__pyx_v_t / __pyx_v_t_int);
/* … */
        __pyx_v_rr = (__pyx_v_t / __pyx_v_t_int);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">097</span>:                 for f in xrange(n_fre):</pre>
<pre class='cython code score-0 '>        __pyx_t_7 = __pyx_v_n_fre;
        for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_f = __pyx_t_8;
/* … */
        __pyx_t_7 = __pyx_v_n_fre;
        for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_f = __pyx_t_8;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">098</span>:                     rc = f/f_int</pre>
<pre class='cython code score-0 '>          __pyx_v_rc = (__pyx_v_f / __pyx_v_f_int);
/* … */
          __pyx_v_rc = (__pyx_v_f / __pyx_v_f_int);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">099</span>:                     for aa in xrange(n_ant):</pre>
<pre class='cython code score-0 '>          __pyx_t_9 = __pyx_v_n_ant;
          for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
            __pyx_v_aa = __pyx_t_10;
/* … */
          __pyx_t_9 = __pyx_v_n_ant;
          for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
            __pyx_v_aa = __pyx_t_10;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">100</span>:                         for ab in xrange(n_ant):</pre>
<pre class='cython code score-0 '>            __pyx_t_11 = __pyx_v_n_ant;
            for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
              __pyx_v_ab = __pyx_t_12;
/* … */
            __pyx_t_11 = __pyx_v_n_ant;
            for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
              __pyx_v_ab = __pyx_t_12;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">101</span>:                             jh[d,i,t,f,aa,ab,0,0] = g[d,rr,rc,aa,0,0]*m[d,i,t,f,aa,ab,0,0] + \</pre>
<pre class='cython code score-0 '>              __pyx_t_13 = __pyx_v_d;
              __pyx_t_14 = __pyx_v_rr;
              __pyx_t_15 = __pyx_v_rc;
              __pyx_t_16 = __pyx_v_aa;
              __pyx_t_17 = 0;
              __pyx_t_18 = 0;
              __pyx_t_19 = __pyx_v_d;
              __pyx_t_20 = __pyx_v_i;
              __pyx_t_21 = __pyx_v_t;
              __pyx_t_22 = __pyx_v_f;
              __pyx_t_23 = __pyx_v_aa;
              __pyx_t_24 = __pyx_v_ab;
              __pyx_t_25 = 0;
              __pyx_t_26 = 0;
/* … */
              __pyx_t_41 = __pyx_v_d;
              __pyx_t_42 = __pyx_v_i;
              __pyx_t_43 = __pyx_v_t;
              __pyx_t_44 = __pyx_v_f;
              __pyx_t_45 = __pyx_v_aa;
              __pyx_t_46 = __pyx_v_ab;
              __pyx_t_47 = 0;
              __pyx_t_48 = 0;
              *__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_41, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_42, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_43, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_44, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_45, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_46, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_47, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_48, __pyx_pybuffernd_jh.diminfo[7].strides) = __Pyx_c_sumf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_16, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_17, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_18, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_21, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_22, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_23, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_24, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_25, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_26, __pyx_pybuffernd_m.diminfo[7].strides))), __Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_28, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_29, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_30, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_31, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_32, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_34, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_35, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_36, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_37, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_38, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_39, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_40, __pyx_pybuffernd_m.diminfo[7].strides))));
/* … */
              __pyx_t_13 = __pyx_v_d;
              __pyx_t_14 = __pyx_v_rr;
              __pyx_t_15 = __pyx_v_rc;
              __pyx_t_16 = __pyx_v_aa;
              __pyx_t_17 = 0;
              __pyx_t_18 = 0;
              __pyx_t_19 = __pyx_v_d;
              __pyx_t_20 = __pyx_v_i;
              __pyx_t_21 = __pyx_v_t;
              __pyx_t_22 = __pyx_v_f;
              __pyx_t_23 = __pyx_v_aa;
              __pyx_t_24 = __pyx_v_ab;
              __pyx_t_25 = 0;
              __pyx_t_26 = 0;
/* … */
              __pyx_t_41 = __pyx_v_d;
              __pyx_t_42 = __pyx_v_i;
              __pyx_t_43 = __pyx_v_t;
              __pyx_t_44 = __pyx_v_f;
              __pyx_t_45 = __pyx_v_aa;
              __pyx_t_46 = __pyx_v_ab;
              __pyx_t_47 = 0;
              __pyx_t_48 = 0;
              *__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_41, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_42, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_43, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_44, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_45, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_46, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_47, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_48, __pyx_pybuffernd_jh.diminfo[7].strides) = __Pyx_c_sum(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_16, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_17, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_18, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_21, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_22, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_23, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_24, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_25, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_26, __pyx_pybuffernd_m.diminfo[7].strides))), __Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_28, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_29, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_30, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_31, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_32, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_34, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_35, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_36, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_37, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_38, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_39, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_40, __pyx_pybuffernd_m.diminfo[7].strides))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">102</span>:                                                     g[d,rr,rc,aa,0,1]*m[d,i,t,f,aa,ab,1,0]</pre>
<pre class='cython code score-0 '>              __pyx_t_27 = __pyx_v_d;
              __pyx_t_28 = __pyx_v_rr;
              __pyx_t_29 = __pyx_v_rc;
              __pyx_t_30 = __pyx_v_aa;
              __pyx_t_31 = 0;
              __pyx_t_32 = 1;
              __pyx_t_33 = __pyx_v_d;
              __pyx_t_34 = __pyx_v_i;
              __pyx_t_35 = __pyx_v_t;
              __pyx_t_36 = __pyx_v_f;
              __pyx_t_37 = __pyx_v_aa;
              __pyx_t_38 = __pyx_v_ab;
              __pyx_t_39 = 1;
              __pyx_t_40 = 0;
/* … */
              __pyx_t_27 = __pyx_v_d;
              __pyx_t_28 = __pyx_v_rr;
              __pyx_t_29 = __pyx_v_rc;
              __pyx_t_30 = __pyx_v_aa;
              __pyx_t_31 = 0;
              __pyx_t_32 = 1;
              __pyx_t_33 = __pyx_v_d;
              __pyx_t_34 = __pyx_v_i;
              __pyx_t_35 = __pyx_v_t;
              __pyx_t_36 = __pyx_v_f;
              __pyx_t_37 = __pyx_v_aa;
              __pyx_t_38 = __pyx_v_ab;
              __pyx_t_39 = 1;
              __pyx_t_40 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">103</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">104</span>:                             jh[d,i,t,f,aa,ab,0,1] = g[d,rr,rc,aa,0,0]*m[d,i,t,f,aa,ab,0,1] + \</pre>
<pre class='cython code score-0 '>              __pyx_t_49 = __pyx_v_d;
              __pyx_t_50 = __pyx_v_rr;
              __pyx_t_51 = __pyx_v_rc;
              __pyx_t_52 = __pyx_v_aa;
              __pyx_t_53 = 0;
              __pyx_t_54 = 0;
              __pyx_t_55 = __pyx_v_d;
              __pyx_t_56 = __pyx_v_i;
              __pyx_t_57 = __pyx_v_t;
              __pyx_t_58 = __pyx_v_f;
              __pyx_t_59 = __pyx_v_aa;
              __pyx_t_60 = __pyx_v_ab;
              __pyx_t_61 = 0;
              __pyx_t_62 = 1;
/* … */
              __pyx_t_77 = __pyx_v_d;
              __pyx_t_78 = __pyx_v_i;
              __pyx_t_79 = __pyx_v_t;
              __pyx_t_80 = __pyx_v_f;
              __pyx_t_81 = __pyx_v_aa;
              __pyx_t_82 = __pyx_v_ab;
              __pyx_t_83 = 0;
              __pyx_t_84 = 1;
              *__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_77, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_78, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_79, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_80, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_81, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_82, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_83, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_84, __pyx_pybuffernd_jh.diminfo[7].strides) = __Pyx_c_sumf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_49, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_50, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_51, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_52, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_53, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_54, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_55, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_56, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_57, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_58, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_59, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_60, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_61, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_62, __pyx_pybuffernd_m.diminfo[7].strides))), __Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_63, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_64, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_65, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_66, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_67, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_68, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_69, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_70, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_71, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_72, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_73, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_74, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_75, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_76, __pyx_pybuffernd_m.diminfo[7].strides))));
/* … */
              __pyx_t_49 = __pyx_v_d;
              __pyx_t_50 = __pyx_v_rr;
              __pyx_t_51 = __pyx_v_rc;
              __pyx_t_52 = __pyx_v_aa;
              __pyx_t_53 = 0;
              __pyx_t_54 = 0;
              __pyx_t_55 = __pyx_v_d;
              __pyx_t_56 = __pyx_v_i;
              __pyx_t_57 = __pyx_v_t;
              __pyx_t_58 = __pyx_v_f;
              __pyx_t_59 = __pyx_v_aa;
              __pyx_t_60 = __pyx_v_ab;
              __pyx_t_61 = 0;
              __pyx_t_62 = 1;
/* … */
              __pyx_t_77 = __pyx_v_d;
              __pyx_t_78 = __pyx_v_i;
              __pyx_t_79 = __pyx_v_t;
              __pyx_t_80 = __pyx_v_f;
              __pyx_t_81 = __pyx_v_aa;
              __pyx_t_82 = __pyx_v_ab;
              __pyx_t_83 = 0;
              __pyx_t_84 = 1;
              *__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_77, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_78, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_79, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_80, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_81, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_82, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_83, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_84, __pyx_pybuffernd_jh.diminfo[7].strides) = __Pyx_c_sum(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_49, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_50, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_51, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_52, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_53, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_54, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_55, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_56, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_57, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_58, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_59, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_60, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_61, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_62, __pyx_pybuffernd_m.diminfo[7].strides))), __Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_63, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_64, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_65, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_66, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_67, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_68, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_69, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_70, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_71, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_72, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_73, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_74, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_75, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_76, __pyx_pybuffernd_m.diminfo[7].strides))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">105</span>:                                                     g[d,rr,rc,aa,0,1]*m[d,i,t,f,aa,ab,1,1]</pre>
<pre class='cython code score-0 '>              __pyx_t_63 = __pyx_v_d;
              __pyx_t_64 = __pyx_v_rr;
              __pyx_t_65 = __pyx_v_rc;
              __pyx_t_66 = __pyx_v_aa;
              __pyx_t_67 = 0;
              __pyx_t_68 = 1;
              __pyx_t_69 = __pyx_v_d;
              __pyx_t_70 = __pyx_v_i;
              __pyx_t_71 = __pyx_v_t;
              __pyx_t_72 = __pyx_v_f;
              __pyx_t_73 = __pyx_v_aa;
              __pyx_t_74 = __pyx_v_ab;
              __pyx_t_75 = 1;
              __pyx_t_76 = 1;
/* … */
              __pyx_t_63 = __pyx_v_d;
              __pyx_t_64 = __pyx_v_rr;
              __pyx_t_65 = __pyx_v_rc;
              __pyx_t_66 = __pyx_v_aa;
              __pyx_t_67 = 0;
              __pyx_t_68 = 1;
              __pyx_t_69 = __pyx_v_d;
              __pyx_t_70 = __pyx_v_i;
              __pyx_t_71 = __pyx_v_t;
              __pyx_t_72 = __pyx_v_f;
              __pyx_t_73 = __pyx_v_aa;
              __pyx_t_74 = __pyx_v_ab;
              __pyx_t_75 = 1;
              __pyx_t_76 = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">106</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">107</span>:                             jh[d,i,t,f,aa,ab,1,0] = g[d,rr,rc,aa,1,0]*m[d,i,t,f,aa,ab,0,0] + \</pre>
<pre class='cython code score-0 '>              __pyx_t_85 = __pyx_v_d;
              __pyx_t_86 = __pyx_v_rr;
              __pyx_t_87 = __pyx_v_rc;
              __pyx_t_88 = __pyx_v_aa;
              __pyx_t_89 = 1;
              __pyx_t_90 = 0;
              __pyx_t_91 = __pyx_v_d;
              __pyx_t_92 = __pyx_v_i;
              __pyx_t_93 = __pyx_v_t;
              __pyx_t_94 = __pyx_v_f;
              __pyx_t_95 = __pyx_v_aa;
              __pyx_t_96 = __pyx_v_ab;
              __pyx_t_97 = 0;
              __pyx_t_98 = 0;
/* … */
              __pyx_t_113 = __pyx_v_d;
              __pyx_t_114 = __pyx_v_i;
              __pyx_t_115 = __pyx_v_t;
              __pyx_t_116 = __pyx_v_f;
              __pyx_t_117 = __pyx_v_aa;
              __pyx_t_118 = __pyx_v_ab;
              __pyx_t_119 = 1;
              __pyx_t_120 = 0;
              *__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_113, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_114, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_115, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_116, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_117, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_118, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_119, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_120, __pyx_pybuffernd_jh.diminfo[7].strides) = __Pyx_c_sumf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_85, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_86, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_87, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_88, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_89, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_90, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_91, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_92, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_93, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_94, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_95, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_96, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_97, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_98, __pyx_pybuffernd_m.diminfo[7].strides))), __Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_99, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_100, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_101, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_102, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_103, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_104, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_105, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_106, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_107, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_108, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_109, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_110, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_111, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_112, __pyx_pybuffernd_m.diminfo[7].strides))));
/* … */
              __pyx_t_85 = __pyx_v_d;
              __pyx_t_86 = __pyx_v_rr;
              __pyx_t_87 = __pyx_v_rc;
              __pyx_t_88 = __pyx_v_aa;
              __pyx_t_89 = 1;
              __pyx_t_90 = 0;
              __pyx_t_91 = __pyx_v_d;
              __pyx_t_92 = __pyx_v_i;
              __pyx_t_93 = __pyx_v_t;
              __pyx_t_94 = __pyx_v_f;
              __pyx_t_95 = __pyx_v_aa;
              __pyx_t_96 = __pyx_v_ab;
              __pyx_t_97 = 0;
              __pyx_t_98 = 0;
/* … */
              __pyx_t_113 = __pyx_v_d;
              __pyx_t_114 = __pyx_v_i;
              __pyx_t_115 = __pyx_v_t;
              __pyx_t_116 = __pyx_v_f;
              __pyx_t_117 = __pyx_v_aa;
              __pyx_t_118 = __pyx_v_ab;
              __pyx_t_119 = 1;
              __pyx_t_120 = 0;
              *__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_113, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_114, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_115, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_116, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_117, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_118, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_119, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_120, __pyx_pybuffernd_jh.diminfo[7].strides) = __Pyx_c_sum(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_85, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_86, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_87, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_88, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_89, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_90, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_91, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_92, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_93, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_94, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_95, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_96, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_97, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_98, __pyx_pybuffernd_m.diminfo[7].strides))), __Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_99, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_100, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_101, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_102, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_103, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_104, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_105, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_106, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_107, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_108, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_109, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_110, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_111, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_112, __pyx_pybuffernd_m.diminfo[7].strides))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">108</span>:                                                     g[d,rr,rc,aa,1,1]*m[d,i,t,f,aa,ab,1,0]</pre>
<pre class='cython code score-0 '>              __pyx_t_99 = __pyx_v_d;
              __pyx_t_100 = __pyx_v_rr;
              __pyx_t_101 = __pyx_v_rc;
              __pyx_t_102 = __pyx_v_aa;
              __pyx_t_103 = 1;
              __pyx_t_104 = 1;
              __pyx_t_105 = __pyx_v_d;
              __pyx_t_106 = __pyx_v_i;
              __pyx_t_107 = __pyx_v_t;
              __pyx_t_108 = __pyx_v_f;
              __pyx_t_109 = __pyx_v_aa;
              __pyx_t_110 = __pyx_v_ab;
              __pyx_t_111 = 1;
              __pyx_t_112 = 0;
/* … */
              __pyx_t_99 = __pyx_v_d;
              __pyx_t_100 = __pyx_v_rr;
              __pyx_t_101 = __pyx_v_rc;
              __pyx_t_102 = __pyx_v_aa;
              __pyx_t_103 = 1;
              __pyx_t_104 = 1;
              __pyx_t_105 = __pyx_v_d;
              __pyx_t_106 = __pyx_v_i;
              __pyx_t_107 = __pyx_v_t;
              __pyx_t_108 = __pyx_v_f;
              __pyx_t_109 = __pyx_v_aa;
              __pyx_t_110 = __pyx_v_ab;
              __pyx_t_111 = 1;
              __pyx_t_112 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">109</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">110</span>:                             jh[d,i,t,f,aa,ab,1,1] = g[d,rr,rc,aa,1,0]*m[d,i,t,f,aa,ab,0,1] + \</pre>
<pre class='cython code score-0 '>              __pyx_t_121 = __pyx_v_d;
              __pyx_t_122 = __pyx_v_rr;
              __pyx_t_123 = __pyx_v_rc;
              __pyx_t_124 = __pyx_v_aa;
              __pyx_t_125 = 1;
              __pyx_t_126 = 0;
              __pyx_t_127 = __pyx_v_d;
              __pyx_t_128 = __pyx_v_i;
              __pyx_t_129 = __pyx_v_t;
              __pyx_t_130 = __pyx_v_f;
              __pyx_t_131 = __pyx_v_aa;
              __pyx_t_132 = __pyx_v_ab;
              __pyx_t_133 = 0;
              __pyx_t_134 = 1;
/* … */
              __pyx_t_149 = __pyx_v_d;
              __pyx_t_150 = __pyx_v_i;
              __pyx_t_151 = __pyx_v_t;
              __pyx_t_152 = __pyx_v_f;
              __pyx_t_153 = __pyx_v_aa;
              __pyx_t_154 = __pyx_v_ab;
              __pyx_t_155 = 1;
              __pyx_t_156 = 1;
              *__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_149, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_150, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_151, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_152, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_153, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_154, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_155, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_156, __pyx_pybuffernd_jh.diminfo[7].strides) = __Pyx_c_sumf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_121, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_122, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_123, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_124, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_125, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_126, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_127, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_128, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_129, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_130, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_131, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_132, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_133, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_134, __pyx_pybuffernd_m.diminfo[7].strides))), __Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_135, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_136, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_137, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_138, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_139, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_140, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_141, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_142, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_143, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_144, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_145, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_146, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_147, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_148, __pyx_pybuffernd_m.diminfo[7].strides))));
            }
          }
        }
      }
    }
  }
/* … */
              __pyx_t_121 = __pyx_v_d;
              __pyx_t_122 = __pyx_v_rr;
              __pyx_t_123 = __pyx_v_rc;
              __pyx_t_124 = __pyx_v_aa;
              __pyx_t_125 = 1;
              __pyx_t_126 = 0;
              __pyx_t_127 = __pyx_v_d;
              __pyx_t_128 = __pyx_v_i;
              __pyx_t_129 = __pyx_v_t;
              __pyx_t_130 = __pyx_v_f;
              __pyx_t_131 = __pyx_v_aa;
              __pyx_t_132 = __pyx_v_ab;
              __pyx_t_133 = 0;
              __pyx_t_134 = 1;
/* … */
              __pyx_t_149 = __pyx_v_d;
              __pyx_t_150 = __pyx_v_i;
              __pyx_t_151 = __pyx_v_t;
              __pyx_t_152 = __pyx_v_f;
              __pyx_t_153 = __pyx_v_aa;
              __pyx_t_154 = __pyx_v_ab;
              __pyx_t_155 = 1;
              __pyx_t_156 = 1;
              *__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_149, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_150, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_151, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_152, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_153, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_154, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_155, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_156, __pyx_pybuffernd_jh.diminfo[7].strides) = __Pyx_c_sum(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_121, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_122, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_123, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_124, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_125, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_126, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_127, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_128, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_129, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_130, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_131, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_132, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_133, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_134, __pyx_pybuffernd_m.diminfo[7].strides))), __Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_135, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_136, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_137, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_138, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_139, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_140, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_m.rcbuffer-&gt;pybuffer.buf, __pyx_t_141, __pyx_pybuffernd_m.diminfo[0].strides, __pyx_t_142, __pyx_pybuffernd_m.diminfo[1].strides, __pyx_t_143, __pyx_pybuffernd_m.diminfo[2].strides, __pyx_t_144, __pyx_pybuffernd_m.diminfo[3].strides, __pyx_t_145, __pyx_pybuffernd_m.diminfo[4].strides, __pyx_t_146, __pyx_pybuffernd_m.diminfo[5].strides, __pyx_t_147, __pyx_pybuffernd_m.diminfo[6].strides, __pyx_t_148, __pyx_pybuffernd_m.diminfo[7].strides))));
            }
          }
        }
      }
    }
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">111</span>:                                                     g[d,rr,rc,aa,1,1]*m[d,i,t,f,aa,ab,1,1]</pre>
<pre class='cython code score-0 '>              __pyx_t_135 = __pyx_v_d;
              __pyx_t_136 = __pyx_v_rr;
              __pyx_t_137 = __pyx_v_rc;
              __pyx_t_138 = __pyx_v_aa;
              __pyx_t_139 = 1;
              __pyx_t_140 = 1;
              __pyx_t_141 = __pyx_v_d;
              __pyx_t_142 = __pyx_v_i;
              __pyx_t_143 = __pyx_v_t;
              __pyx_t_144 = __pyx_v_f;
              __pyx_t_145 = __pyx_v_aa;
              __pyx_t_146 = __pyx_v_ab;
              __pyx_t_147 = 1;
              __pyx_t_148 = 1;
/* … */
              __pyx_t_135 = __pyx_v_d;
              __pyx_t_136 = __pyx_v_rr;
              __pyx_t_137 = __pyx_v_rc;
              __pyx_t_138 = __pyx_v_aa;
              __pyx_t_139 = 1;
              __pyx_t_140 = 1;
              __pyx_t_141 = __pyx_v_d;
              __pyx_t_142 = __pyx_v_i;
              __pyx_t_143 = __pyx_v_t;
              __pyx_t_144 = __pyx_v_f;
              __pyx_t_145 = __pyx_v_aa;
              __pyx_t_146 = __pyx_v_ab;
              __pyx_t_147 = 1;
              __pyx_t_148 = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">112</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">113</span>: @cython.cdivision(True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">114</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">115</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">116</span>: @cython.nonecheck(False)</pre>
<pre class="cython line score-683" onclick='toggleDiv(this)'>+<span class="">117</span>: def cycompute_jhwr(np.ndarray[complex3264, ndim=8] jh,</pre>
<pre class='cython code score-683 '>/* Python wrapper */
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_5cycompute_jhwr(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_4cycompute_jhwr[] = "\n    This computes the jhwr term on the GN/LM method. Note that while jh is indexed by model, the \n    resulting jhwr has no model index. \n    ";
static PyMethodDef __pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_5cycompute_jhwr = {"cycompute_jhwr", (PyCFunction)__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_5cycompute_jhwr, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_4cycompute_jhwr};
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_5cycompute_jhwr(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_signatures = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED PyObject *__pyx_v_defaults = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fused_cpdef (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_signatures,&amp;__pyx_n_s_args,&amp;__pyx_n_s_kwargs,&amp;__pyx_n_s_defaults,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_signatures)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_args)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_kwargs)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_defaults)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_fused_cpdef") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_signatures = values[0];
    __pyx_v_args = values[1];
    __pyx_v_kwargs = values[2];
    __pyx_v_defaults = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_4cycompute_jhwr(__pyx_self, __pyx_v_signatures, __pyx_v_args, __pyx_v_kwargs, __pyx_v_defaults);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_4cycompute_jhwr(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_signatures, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs, CYTHON_UNUSED PyObject *__pyx_v_defaults) {
  PyObject *__pyx_v_dest_sig = NULL;
  PyTypeObject *__pyx_v_ndarray = 0;
  PyObject *__pyx_v_numpy = NULL;
  __Pyx_memviewslice __pyx_v_memslice;
  Py_ssize_t __pyx_v_itemsize;
  CYTHON_UNUSED int __pyx_v_dtype_signed;
  char __pyx_v_kind;
  PyObject *__pyx_v_arg = NULL;
  PyObject *__pyx_v_dtype = NULL;
  PyObject *__pyx_v_arg_base = NULL;
  PyObject *__pyx_v_candidates = NULL;
  PyObject *__pyx_v_sig = NULL;
  int __pyx_v_match_found;
  PyObject *__pyx_v_src_type = NULL;
  PyObject *__pyx_v_dst_type = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_jhwr", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kwargs);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, Py_None);
  __pyx_v_dest_sig = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_2 = (__pyx_v_kwargs == Py_None);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kwargs, __pyx_t_1);
    __pyx_t_1 = 0;
  }
  {
    /*try:*/ {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_v_numpy = __pyx_t_1;
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_numpy, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!(likely(<span class='py_c_api'>PyType_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "type", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      __pyx_v_ndarray = ((PyTypeObject*)__pyx_t_1);
      __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L11_try_end;
    __pyx_L4_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_ImportError) || <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_AttributeError) || <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_TypeError);
    if (__pyx_t_7) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_1, &amp;__pyx_t_8, &amp;__pyx_t_9) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L6_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ndarray, ((PyTypeObject*)Py_None));
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L5_exception_handled;
    }
    goto __pyx_L6_except_error;
    __pyx_L6_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    goto __pyx_L1_error;
    __pyx_L5_exception_handled:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    __pyx_L11_try_end:;
  }
  __pyx_v_itemsize = -1L;
  if (unlikely(__pyx_v_args == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = ((0 &lt; __pyx_t_10) != 0);
  if (__pyx_t_3) {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(((PyObject*)__pyx_v_args), 0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
    __pyx_v_arg = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L14;
  }
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyDict_ContainsTF</span>(__pyx_n_s_jh, ((PyObject*)__pyx_v_kwargs), Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {
    if (unlikely(__pyx_v_kwargs == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_kwargs), __pyx_n_s_jh);<span class='error_goto'> if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_v_arg = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L14;
  }
  /*else*/ {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_Expected_at_least_d_arguments, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_L14:;
  while (1) {
    __pyx_t_2 = (__pyx_v_ndarray != ((PyTypeObject*)Py_None));
    __pyx_t_3 = (__pyx_t_2 != 0);
    if (__pyx_t_3) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_arg, __pyx_v_ndarray); 
      __pyx_t_2 = (__pyx_t_3 != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_v_dtype = __pyx_t_8;
        __pyx_t_8 = 0;
        goto __pyx_L18;
      }
      __pyx_t_2 = (__pyx_memoryview_check(__pyx_v_arg) != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_base);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_v_arg_base = __pyx_t_8;
        __pyx_t_8 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_arg_base, __pyx_v_ndarray); 
        __pyx_t_3 = (__pyx_t_2 != 0);
        if (__pyx_t_3) {
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg_base, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_v_dtype = __pyx_t_8;
          __pyx_t_8 = 0;
          goto __pyx_L19;
        }
        /*else*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
          __pyx_v_dtype = Py_None;
        }
        __pyx_L19:;
        goto __pyx_L18;
      }
      /*else*/ {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
        __pyx_v_dtype = Py_None;
      }
      __pyx_L18:;
      __pyx_v_itemsize = -1L;
      __pyx_t_3 = (__pyx_v_dtype != Py_None);
      __pyx_t_2 = (__pyx_t_3 != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dtype, __pyx_n_s_itemsize);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_itemsize = __pyx_t_10;
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dtype, __pyx_n_s_kind);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Ord</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(__pyx_t_11 == (long)(Py_UCS4)-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_kind = __pyx_t_11;
        __pyx_v_dtype_signed = (__pyx_v_kind == 'i');
        switch (__pyx_v_kind) {
          case 'i':
          case 'u':
          break;
          case 'f':
          break;
          case 'c':
          __pyx_t_3 = (((sizeof(__pyx_t_float_complex)) == __pyx_v_itemsize) != 0);
          if (__pyx_t_3) {
          } else {
            __pyx_t_2 = __pyx_t_3;
            goto __pyx_L22_bool_binop_done;
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_3 = ((((Py_ssize_t)__pyx_t_10) == 8) != 0);
          __pyx_t_2 = __pyx_t_3;
          __pyx_L22_bool_binop_done:;
          if (__pyx_t_2) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            goto __pyx_L16_break;
          }
          __pyx_t_3 = (((sizeof(__pyx_t_double_complex)) == __pyx_v_itemsize) != 0);
          if (__pyx_t_3) {
          } else {
            __pyx_t_2 = __pyx_t_3;
            goto __pyx_L25_bool_binop_done;
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_3 = ((((Py_ssize_t)__pyx_t_10) == 8) != 0);
          __pyx_t_2 = __pyx_t_3;
          __pyx_L25_bool_binop_done:;
          if (__pyx_t_2) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            goto __pyx_L16_break;
          }
          break;
          case 'O':
          break;
          default: break;
        }
      }
    }
    __pyx_t_3 = ((__pyx_v_itemsize == -1L) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L28_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_itemsize == (sizeof(__pyx_t_float_complex))) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L28_bool_binop_done:;
    if (__pyx_t_2) {
      __pyx_v_memslice = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsdsdsdsds___pyx_t_float_complex</span>(__pyx_v_arg);
      __pyx_t_2 = (__pyx_v_memslice.memview != 0);
      if (__pyx_t_2) {
        __PYX_XDEC_MEMVIEW((&amp;__pyx_v_memslice), 1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L16_break;
      }
      /*else*/ {
        <span class='py_c_api'>PyErr_Clear</span>();
      }
    }
    __pyx_t_3 = ((__pyx_v_itemsize == -1L) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L32_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_itemsize == (sizeof(__pyx_t_double_complex))) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L32_bool_binop_done:;
    if (__pyx_t_2) {
      __pyx_v_memslice = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsdsdsdsds___pyx_t_double_complex</span>(__pyx_v_arg);
      __pyx_t_2 = (__pyx_v_memslice.memview != 0);
      if (__pyx_t_2) {
        __PYX_XDEC_MEMVIEW((&amp;__pyx_v_memslice), 1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L16_break;
      }
      /*else*/ {
        <span class='py_c_api'>PyErr_Clear</span>();
      }
    }
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, Py_None, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L16_break;
  }
  __pyx_L16_break:;
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_v_candidates = ((PyObject*)__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_10 = 0;
  if (unlikely(__pyx_v_signatures == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_9 = __Pyx_dict_iterator(((PyObject*)__pyx_v_signatures), 1, ((PyObject *)NULL), (&amp;__pyx_t_12), (&amp;__pyx_t_7));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __pyx_t_8 = __pyx_t_9;
  __pyx_t_9 = 0;
  while (1) {
    __pyx_t_13 = __Pyx_dict_iter_next(__pyx_t_8, __pyx_t_12, &amp;__pyx_t_10, &amp;__pyx_t_9, NULL, NULL, __pyx_t_7);
    if (unlikely(__pyx_t_13 == 0)) break;
    if (unlikely(__pyx_t_13 == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_sig, __pyx_t_9);
    __pyx_t_9 = 0;
    __pyx_v_match_found = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_sig, __pyx_n_s_strip);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_split);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dest_sig);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dest_sig);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_dest_sig);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_9 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_14 = 0;
      __pyx_t_15 = NULL;
    } else {
      __pyx_t_14 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_15 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_15)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_15(__pyx_t_9);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        PyObject* sequence = __pyx_t_1;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_16 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_17 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_16 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_17 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
        #else
        __pyx_t_16 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        __pyx_t_17 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_18 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_19 = Py_TYPE(__pyx_t_18)-&gt;tp_iternext;
        index = 0; __pyx_t_16 = __pyx_t_19(__pyx_t_18); if (unlikely(!__pyx_t_16)) goto __pyx_L39_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        index = 1; __pyx_t_17 = __pyx_t_19(__pyx_t_18); if (unlikely(!__pyx_t_17)) goto __pyx_L39_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_19(__pyx_t_18), 2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_19 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        goto __pyx_L40_unpacking_done;
        __pyx_L39_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_t_19 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_L40_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_src_type, __pyx_t_16);
      __pyx_t_16 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dst_type, __pyx_t_17);
      __pyx_t_17 = 0;
      __pyx_t_2 = (__pyx_v_dst_type != Py_None);
      __pyx_t_3 = (__pyx_t_2 != 0);
      if (__pyx_t_3) {
        __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_src_type, __pyx_v_dst_type, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (__pyx_t_3) {
          __pyx_v_match_found = 1;
          goto __pyx_L42;
        }
        /*else*/ {
          __pyx_v_match_found = 0;
          goto __pyx_L38_break;
        }
        __pyx_L42:;
      }
    }
    __pyx_L38_break:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_3 = (__pyx_v_match_found != 0);
    if (__pyx_t_3) {
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_candidates, __pyx_v_sig);<span class='error_goto'> if (unlikely(__pyx_t_20 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_3 = (__pyx_v_candidates != Py_None) &amp;&amp; (<span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates) != 0);
  __pyx_t_2 = ((!__pyx_t_3) != 0);
  if (__pyx_t_2) {
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s__3);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_12 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates);<span class='error_goto'> if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = ((__pyx_t_12 &gt; 1) != 0);
  if (__pyx_t_2) {
  __pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_No_matching_signature_found);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(__pyx_v_signatures == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_signatures), <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_candidates, 0));<span class='error_goto'> if (unlikely(__pyx_t_8 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_r = __pyx_t_8;
    __pyx_t_8 = 0;
    goto __pyx_L0;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dest_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_numpy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dtype);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg_base);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_candidates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_src_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dst_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_29cycompute_jhwr(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_fuse_0__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_29cycompute_jhwr = {"__pyx_fuse_0cycompute_jhwr", (PyCFunction)__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_29cycompute_jhwr, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_4cycompute_jhwr};
static PyObject *__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_29cycompute_jhwr(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_jh = 0;
  PyArrayObject *__pyx_v_r = 0;
  PyArrayObject *__pyx_v_w = 0;
  PyArrayObject *__pyx_v_jhwr = 0;
  int __pyx_v_t_int;
  int __pyx_v_f_int;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_jhwr (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_jh,&amp;__pyx_n_s_r,&amp;__pyx_n_s_w,&amp;__pyx_n_s_jhwr,&amp;__pyx_n_s_t_int,&amp;__pyx_n_s_f_int,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwr", 1, 6, 6, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_w)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwr", 1, 6, 6, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jhwr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwr", 1, 6, 6, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_t_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwr", 1, 6, 6, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwr", 1, 6, 6, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cycompute_jhwr") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 6) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
    }
    __pyx_v_jh = ((PyArrayObject *)values[0]);
    __pyx_v_r = ((PyArrayObject *)values[1]);
    __pyx_v_w = ((PyArrayObject *)values[2]);
    __pyx_v_jhwr = ((PyArrayObject *)values[3]);
    __pyx_v_t_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_t_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_f_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_f_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwr", 1, 6, 6, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_jhwr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jh), __pyx_ptype_5numpy_ndarray, 1, "jh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_r), __pyx_ptype_5numpy_ndarray, 1, "r", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_w), __pyx_ptype_5numpy_ndarray, 1, "w", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jhwr), __pyx_ptype_5numpy_ndarray, 1, "jhwr", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_28cycompute_jhwr(__pyx_self, __pyx_v_jh, __pyx_v_r, __pyx_v_w, __pyx_v_jhwr, __pyx_v_t_int, __pyx_v_f_int);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_28cycompute_jhwr(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_jh, PyArrayObject *__pyx_v_r, PyArrayObject *__pyx_v_w, PyArrayObject *__pyx_v_jhwr, int __pyx_v_t_int, int __pyx_v_f_int) {
  int __pyx_v_d;
  int __pyx_v_i;
  int __pyx_v_t;
  int __pyx_v_f;
  int __pyx_v_aa;
  int __pyx_v_ab;
  int __pyx_v_rr;
  int __pyx_v_rc;
  int __pyx_v_n_dir;
  int __pyx_v_n_mod;
  int __pyx_v_n_tim;
  int __pyx_v_n_fre;
  int __pyx_v_n_ant;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jh;
  __Pyx_Buffer __pyx_pybuffer_jh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jhwr;
  __Pyx_Buffer __pyx_pybuffer_jhwr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_r;
  __Pyx_Buffer __pyx_pybuffer_r;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_w;
  __Pyx_Buffer __pyx_pybuffer_w;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_0cycompute_jhwr", 0);
  __pyx_pybuffer_jh.pybuffer.buf = NULL;
  __pyx_pybuffer_jh.refcount = 0;
  __pyx_pybuffernd_jh.data = NULL;
  __pyx_pybuffernd_jh.rcbuffer = &amp;__pyx_pybuffer_jh;
  __pyx_pybuffer_r.pybuffer.buf = NULL;
  __pyx_pybuffer_r.refcount = 0;
  __pyx_pybuffernd_r.data = NULL;
  __pyx_pybuffernd_r.rcbuffer = &amp;__pyx_pybuffer_r;
  __pyx_pybuffer_w.pybuffer.buf = NULL;
  __pyx_pybuffer_w.refcount = 0;
  __pyx_pybuffernd_w.data = NULL;
  __pyx_pybuffernd_w.rcbuffer = &amp;__pyx_pybuffer_w;
  __pyx_pybuffer_jhwr.pybuffer.buf = NULL;
  __pyx_pybuffer_jhwr.refcount = 0;
  __pyx_pybuffernd_jhwr.data = NULL;
  __pyx_pybuffernd_jhwr.rcbuffer = &amp;__pyx_pybuffer_jhwr;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jh, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 8, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jh.diminfo[0].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jh.diminfo[0].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jh.diminfo[1].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jh.diminfo[1].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jh.diminfo[2].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jh.diminfo[2].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jh.diminfo[3].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jh.diminfo[3].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jh.diminfo[4].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jh.diminfo[4].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jh.diminfo[5].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jh.diminfo[5].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_jh.diminfo[6].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_jh.diminfo[6].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[6]; __pyx_pybuffernd_jh.diminfo[7].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[7]; __pyx_pybuffernd_jh.diminfo[7].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[7];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_r, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 7, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_r.diminfo[0].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_r.diminfo[0].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_r.diminfo[1].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_r.diminfo[1].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_r.diminfo[2].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_r.diminfo[2].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_r.diminfo[3].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_r.diminfo[3].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_r.diminfo[4].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_r.diminfo[4].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_r.diminfo[5].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_r.diminfo[5].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_r.diminfo[6].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_r.diminfo[6].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[6];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_w, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 5, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_w.diminfo[0].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_w.diminfo[0].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_w.diminfo[1].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_w.diminfo[1].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_w.diminfo[2].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_w.diminfo[2].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_w.diminfo[3].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_w.diminfo[3].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_w.diminfo[4].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_w.diminfo[4].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[4];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jhwr, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jhwr.diminfo[0].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jhwr.diminfo[0].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jhwr.diminfo[1].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jhwr.diminfo[1].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jhwr.diminfo[2].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jhwr.diminfo[2].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jhwr.diminfo[3].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jhwr.diminfo[3].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jhwr.diminfo[4].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jhwr.diminfo[4].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jhwr.diminfo[5].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jhwr.diminfo[5].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[5];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_97);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_98);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_99);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_100);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_101);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_102);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_jhwr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_31cycompute_jhwr(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_fuse_1__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_31cycompute_jhwr = {"__pyx_fuse_1cycompute_jhwr", (PyCFunction)__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_31cycompute_jhwr, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_4cycompute_jhwr};
static PyObject *__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_31cycompute_jhwr(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_jh = 0;
  PyArrayObject *__pyx_v_r = 0;
  PyArrayObject *__pyx_v_w = 0;
  PyArrayObject *__pyx_v_jhwr = 0;
  int __pyx_v_t_int;
  int __pyx_v_f_int;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_jhwr (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_jh,&amp;__pyx_n_s_r,&amp;__pyx_n_s_w,&amp;__pyx_n_s_jhwr,&amp;__pyx_n_s_t_int,&amp;__pyx_n_s_f_int,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwr", 1, 6, 6, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_w)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwr", 1, 6, 6, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jhwr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwr", 1, 6, 6, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_t_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwr", 1, 6, 6, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwr", 1, 6, 6, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cycompute_jhwr") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 6) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
    }
    __pyx_v_jh = ((PyArrayObject *)values[0]);
    __pyx_v_r = ((PyArrayObject *)values[1]);
    __pyx_v_w = ((PyArrayObject *)values[2]);
    __pyx_v_jhwr = ((PyArrayObject *)values[3]);
    __pyx_v_t_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_t_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_f_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_f_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwr", 1, 6, 6, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_jhwr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jh), __pyx_ptype_5numpy_ndarray, 1, "jh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_r), __pyx_ptype_5numpy_ndarray, 1, "r", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_w), __pyx_ptype_5numpy_ndarray, 1, "w", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jhwr), __pyx_ptype_5numpy_ndarray, 1, "jhwr", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_30cycompute_jhwr(__pyx_self, __pyx_v_jh, __pyx_v_r, __pyx_v_w, __pyx_v_jhwr, __pyx_v_t_int, __pyx_v_f_int);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_30cycompute_jhwr(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_jh, PyArrayObject *__pyx_v_r, PyArrayObject *__pyx_v_w, PyArrayObject *__pyx_v_jhwr, int __pyx_v_t_int, int __pyx_v_f_int) {
  int __pyx_v_d;
  int __pyx_v_i;
  int __pyx_v_t;
  int __pyx_v_f;
  int __pyx_v_aa;
  int __pyx_v_ab;
  int __pyx_v_rr;
  int __pyx_v_rc;
  int __pyx_v_n_dir;
  int __pyx_v_n_mod;
  int __pyx_v_n_tim;
  int __pyx_v_n_fre;
  int __pyx_v_n_ant;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jh;
  __Pyx_Buffer __pyx_pybuffer_jh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jhwr;
  __Pyx_Buffer __pyx_pybuffer_jhwr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_r;
  __Pyx_Buffer __pyx_pybuffer_r;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_w;
  __Pyx_Buffer __pyx_pybuffer_w;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_1cycompute_jhwr", 0);
  __pyx_pybuffer_jh.pybuffer.buf = NULL;
  __pyx_pybuffer_jh.refcount = 0;
  __pyx_pybuffernd_jh.data = NULL;
  __pyx_pybuffernd_jh.rcbuffer = &amp;__pyx_pybuffer_jh;
  __pyx_pybuffer_r.pybuffer.buf = NULL;
  __pyx_pybuffer_r.refcount = 0;
  __pyx_pybuffernd_r.data = NULL;
  __pyx_pybuffernd_r.rcbuffer = &amp;__pyx_pybuffer_r;
  __pyx_pybuffer_w.pybuffer.buf = NULL;
  __pyx_pybuffer_w.refcount = 0;
  __pyx_pybuffernd_w.data = NULL;
  __pyx_pybuffernd_w.rcbuffer = &amp;__pyx_pybuffer_w;
  __pyx_pybuffer_jhwr.pybuffer.buf = NULL;
  __pyx_pybuffer_jhwr.refcount = 0;
  __pyx_pybuffernd_jhwr.data = NULL;
  __pyx_pybuffernd_jhwr.rcbuffer = &amp;__pyx_pybuffer_jhwr;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jh, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES, 8, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jh.diminfo[0].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jh.diminfo[0].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jh.diminfo[1].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jh.diminfo[1].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jh.diminfo[2].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jh.diminfo[2].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jh.diminfo[3].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jh.diminfo[3].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jh.diminfo[4].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jh.diminfo[4].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jh.diminfo[5].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jh.diminfo[5].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_jh.diminfo[6].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_jh.diminfo[6].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[6]; __pyx_pybuffernd_jh.diminfo[7].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[7]; __pyx_pybuffernd_jh.diminfo[7].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[7];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_r, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES, 7, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_r.diminfo[0].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_r.diminfo[0].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_r.diminfo[1].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_r.diminfo[1].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_r.diminfo[2].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_r.diminfo[2].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_r.diminfo[3].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_r.diminfo[3].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_r.diminfo[4].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_r.diminfo[4].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_r.diminfo[5].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_r.diminfo[5].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_r.diminfo[6].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_r.diminfo[6].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[6];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_w, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 5, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_w.diminfo[0].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_w.diminfo[0].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_w.diminfo[1].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_w.diminfo[1].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_w.diminfo[2].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_w.diminfo[2].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_w.diminfo[3].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_w.diminfo[3].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_w.diminfo[4].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_w.diminfo[4].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[4];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jhwr, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jhwr.diminfo[0].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jhwr.diminfo[0].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jhwr.diminfo[1].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jhwr.diminfo[1].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jhwr.diminfo[2].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jhwr.diminfo[2].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jhwr.diminfo[3].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jhwr.diminfo[3].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jhwr.diminfo[4].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jhwr.diminfo[4].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jhwr.diminfo[5].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jhwr.diminfo[5].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[5];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_97);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_98);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_99);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_100);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_101);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_102);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_jhwr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
  __pyx_tuple__14 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Function_call_with_ambiguous_arg);<span class='error_goto'> if (unlikely(!__pyx_tuple__14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__14);
/* … */
  __pyx_tuple__62 = <span class='py_c_api'>PyTuple_Pack</span>(19, __pyx_n_s_jh, __pyx_n_s_r, __pyx_n_s_w, __pyx_n_s_jhwr, __pyx_n_s_t_int, __pyx_n_s_f_int, __pyx_n_s_d, __pyx_n_s_i, __pyx_n_s_t, __pyx_n_s_f, __pyx_n_s_aa, __pyx_n_s_ab, __pyx_n_s_rr, __pyx_n_s_rc, __pyx_n_s_n_dir, __pyx_n_s_n_mod, __pyx_n_s_n_tim, __pyx_n_s_n_fre, __pyx_n_s_n_ant);<span class='error_goto'> if (unlikely(!__pyx_tuple__62)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__62);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__62);
/* … */
  __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = __pyx_FusedFunction_NewEx(&amp;__pyx_fuse_0__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_29cycompute_jhwr, 0, __pyx_n_s_cycompute_jhwr, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__63));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_6, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_s_float_complex, __pyx_t_6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __pyx_FusedFunction_NewEx(&amp;__pyx_fuse_1__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_31cycompute_jhwr, 0, __pyx_n_s_cycompute_jhwr, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__63));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_6, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_s_double_complex, __pyx_t_6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __pyx_FusedFunction_NewEx(&amp;__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_5cycompute_jhwr, 0, __pyx_n_s_cycompute_jhwr, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__63));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_6, __pyx_empty_tuple);
  ((__pyx_FusedFunctionObject *) __pyx_t_6)-&gt;__signatures__ = __pyx_t_5;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_cycompute_jhwr, __pyx_t_6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_codeobj__63 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(6, 0, 19, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__62, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_ulrich_CubeCal_cubecal_ker, __pyx_n_s_cycompute_jhwr, 117, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__63)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">118</span>:                   np.ndarray[complex3264, ndim=7] r,</pre>
<pre class="cython line score-0">&#xA0;<span class="">119</span>:                   np.ndarray[np.double_t, ndim=5] w,</pre>
<pre class="cython line score-0">&#xA0;<span class="">120</span>:                   np.ndarray[complex3264, ndim=6] jhwr,</pre>
<pre class="cython line score-0">&#xA0;<span class="">121</span>:                   int t_int,</pre>
<pre class="cython line score-0">&#xA0;<span class="">122</span>:                   int f_int):</pre>
<pre class="cython line score-0">&#xA0;<span class="">123</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">124</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">125</span>:     This computes the jhwr term on the GN/LM method. Note that while jh is indexed by model, the</pre>
<pre class="cython line score-0">&#xA0;<span class="">126</span>:     resulting jhwr has no model index.</pre>
<pre class="cython line score-0">&#xA0;<span class="">127</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">128</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">129</span>:     cdef int d, i, t, f, aa, ab, rr, rc = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_rc = 0;
/* … */
  __pyx_v_rc = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">130</span>:     cdef int n_dir, n_mod, n_tim, n_fre, n_ant</pre>
<pre class="cython line score-0">&#xA0;<span class="">131</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">132</span>:     n_dir = jh.shape[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_dir = (__pyx_v_jh-&gt;dimensions[0]);
/* … */
  __pyx_v_n_dir = (__pyx_v_jh-&gt;dimensions[0]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">133</span>:     n_mod = jh.shape[1]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_mod = (__pyx_v_jh-&gt;dimensions[1]);
/* … */
  __pyx_v_n_mod = (__pyx_v_jh-&gt;dimensions[1]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">134</span>:     n_tim = jh.shape[2]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_tim = (__pyx_v_jh-&gt;dimensions[2]);
/* … */
  __pyx_v_n_tim = (__pyx_v_jh-&gt;dimensions[2]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">135</span>:     n_fre = jh.shape[3]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_fre = (__pyx_v_jh-&gt;dimensions[3]);
/* … */
  __pyx_v_n_fre = (__pyx_v_jh-&gt;dimensions[3]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">136</span>:     n_ant = jh.shape[4]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_ant = (__pyx_v_jh-&gt;dimensions[4]);
/* … */
  __pyx_v_n_ant = (__pyx_v_jh-&gt;dimensions[4]);
</pre><pre class="cython line score-0">&#xA0;<span class="">137</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">138</span>:     for d in xrange(n_dir):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_n_dir;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
/* … */
  __pyx_t_1 = __pyx_v_n_dir;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">139</span>:         for i in xrange(n_mod):</pre>
<pre class='cython code score-0 '>    __pyx_t_3 = __pyx_v_n_mod;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_i = __pyx_t_4;
/* … */
    __pyx_t_3 = __pyx_v_n_mod;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">140</span>:             for t in xrange(n_tim):</pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_n_tim;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_t = __pyx_t_6;
/* … */
      __pyx_t_5 = __pyx_v_n_tim;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_t = __pyx_t_6;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">141</span>:                 rr = t/t_int</pre>
<pre class='cython code score-0 '>        __pyx_v_rr = (__pyx_v_t / __pyx_v_t_int);
/* … */
        __pyx_v_rr = (__pyx_v_t / __pyx_v_t_int);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">142</span>:                 for f in xrange(n_fre):</pre>
<pre class='cython code score-0 '>        __pyx_t_7 = __pyx_v_n_fre;
        for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_f = __pyx_t_8;
/* … */
        __pyx_t_7 = __pyx_v_n_fre;
        for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_f = __pyx_t_8;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">143</span>:                     rc = f/f_int</pre>
<pre class='cython code score-0 '>          __pyx_v_rc = (__pyx_v_f / __pyx_v_f_int);
/* … */
          __pyx_v_rc = (__pyx_v_f / __pyx_v_f_int);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">144</span>:                     for aa in xrange(n_ant):</pre>
<pre class='cython code score-0 '>          __pyx_t_9 = __pyx_v_n_ant;
          for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
            __pyx_v_aa = __pyx_t_10;
/* … */
          __pyx_t_9 = __pyx_v_n_ant;
          for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
            __pyx_v_aa = __pyx_t_10;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">145</span>:                         for ab in xrange(n_ant):</pre>
<pre class='cython code score-0 '>            __pyx_t_11 = __pyx_v_n_ant;
            for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
              __pyx_v_ab = __pyx_t_12;
/* … */
            __pyx_t_11 = __pyx_v_n_ant;
            for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
              __pyx_v_ab = __pyx_t_12;
</pre><pre class="cython line score-4" onclick='toggleDiv(this)'>+<span class="">146</span>:                             jhwr[d,rr,rc,aa,0,0] = jhwr[d,rr,rc,aa,0,0] + \</pre>
<pre class='cython code score-4 '>              __pyx_t_13 = __pyx_v_d;
              __pyx_t_14 = __pyx_v_rr;
              __pyx_t_15 = __pyx_v_rc;
              __pyx_t_16 = __pyx_v_aa;
              __pyx_t_17 = 0;
              __pyx_t_18 = 0;
              __pyx_t_19 = (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_16, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_17, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_18, __pyx_pybuffernd_jhwr.diminfo[5].strides));
/* … */
              __pyx_t_65 = __pyx_v_d;
              __pyx_t_66 = __pyx_v_rr;
              __pyx_t_67 = __pyx_v_rc;
              __pyx_t_68 = __pyx_v_aa;
              __pyx_t_69 = 0;
              __pyx_t_70 = 0;
              *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_65, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_66, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_67, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_68, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_69, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_70, __pyx_pybuffernd_jhwr.diminfo[5].strides) = __pyx_t_float_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_64), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_64));
/* … */
              __pyx_t_13 = __pyx_v_d;
              __pyx_t_14 = __pyx_v_rr;
              __pyx_t_15 = __pyx_v_rc;
              __pyx_t_16 = __pyx_v_aa;
              __pyx_t_17 = 0;
              __pyx_t_18 = 0;
              __pyx_t_19 = (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_16, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_17, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_18, __pyx_pybuffernd_jhwr.diminfo[5].strides));
/* … */
              __pyx_t_65 = __pyx_v_d;
              __pyx_t_66 = __pyx_v_rr;
              __pyx_t_67 = __pyx_v_rc;
              __pyx_t_68 = __pyx_v_aa;
              __pyx_t_69 = 0;
              __pyx_t_70 = 0;
              *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_65, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_66, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_67, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_68, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_69, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_70, __pyx_pybuffernd_jhwr.diminfo[5].strides) = __pyx_t_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_64), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_64));
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">147</span>:                                                     w[i,t,f,aa,ab]*r[i,t,f,aa,ab,0,0]*jh[d,i,t,f,ab,aa,0,0] + \</pre>
<pre class='cython code score-20 '>              __pyx_t_20 = __pyx_v_i;
              __pyx_t_21 = __pyx_v_t;
              __pyx_t_22 = __pyx_v_f;
              __pyx_t_23 = __pyx_v_aa;
              __pyx_t_24 = __pyx_v_ab;
              __pyx_t_25 = __pyx_v_i;
              __pyx_t_26 = __pyx_v_t;
              __pyx_t_27 = __pyx_v_f;
              __pyx_t_28 = __pyx_v_aa;
              __pyx_t_29 = __pyx_v_ab;
              __pyx_t_30 = 0;
              __pyx_t_31 = 0;
              __pyx_t_32 = (*__Pyx_BufPtrStrided7d(__pyx_t_float_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_25, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_26, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_27, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_28, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_29, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_30, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_31, __pyx_pybuffernd_r.diminfo[6].strides));
              __pyx_t_33 = __pyx_v_d;
              __pyx_t_34 = __pyx_v_i;
              __pyx_t_35 = __pyx_v_t;
              __pyx_t_36 = __pyx_v_f;
              __pyx_t_37 = __pyx_v_ab;
              __pyx_t_38 = __pyx_v_aa;
              __pyx_t_39 = 0;
              __pyx_t_40 = 0;
              __pyx_t_41 = (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_34, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_35, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_36, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_37, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_38, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_39, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_40, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_64 = __Pyx_c_sum_npy_double(__Pyx_c_sum_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_19), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_19)), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_22, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_23, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_24, __pyx_pybuffernd_w.diminfo[4].strides)), 0), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_32), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_32))), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_41), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_41)))), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_42, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_43, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_44, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_45, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_46, __pyx_pybuffernd_w.diminfo[4].strides)), 0), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_54), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_54))), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_63), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_63))));
/* … */
              __pyx_t_20 = __pyx_v_i;
              __pyx_t_21 = __pyx_v_t;
              __pyx_t_22 = __pyx_v_f;
              __pyx_t_23 = __pyx_v_aa;
              __pyx_t_24 = __pyx_v_ab;
              __pyx_t_25 = __pyx_v_i;
              __pyx_t_26 = __pyx_v_t;
              __pyx_t_27 = __pyx_v_f;
              __pyx_t_28 = __pyx_v_aa;
              __pyx_t_29 = __pyx_v_ab;
              __pyx_t_30 = 0;
              __pyx_t_31 = 0;
              __pyx_t_32 = (*__Pyx_BufPtrStrided7d(__pyx_t_double_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_25, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_26, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_27, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_28, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_29, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_30, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_31, __pyx_pybuffernd_r.diminfo[6].strides));
              __pyx_t_33 = __pyx_v_d;
              __pyx_t_34 = __pyx_v_i;
              __pyx_t_35 = __pyx_v_t;
              __pyx_t_36 = __pyx_v_f;
              __pyx_t_37 = __pyx_v_ab;
              __pyx_t_38 = __pyx_v_aa;
              __pyx_t_39 = 0;
              __pyx_t_40 = 0;
              __pyx_t_41 = (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_34, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_35, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_36, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_37, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_38, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_39, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_40, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_64 = __Pyx_c_sum_npy_double(__Pyx_c_sum_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_19), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_19)), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_22, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_23, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_24, __pyx_pybuffernd_w.diminfo[4].strides)), 0), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_32), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_32))), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_41), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_41)))), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_42, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_43, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_44, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_45, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_46, __pyx_pybuffernd_w.diminfo[4].strides)), 0), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_54), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_54))), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_63), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_63))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">148</span>:                                                     w[i,t,f,aa,ab]*r[i,t,f,aa,ab,0,1]*jh[d,i,t,f,ab,aa,1,0]</pre>
<pre class='cython code score-0 '>              __pyx_t_42 = __pyx_v_i;
              __pyx_t_43 = __pyx_v_t;
              __pyx_t_44 = __pyx_v_f;
              __pyx_t_45 = __pyx_v_aa;
              __pyx_t_46 = __pyx_v_ab;
              __pyx_t_47 = __pyx_v_i;
              __pyx_t_48 = __pyx_v_t;
              __pyx_t_49 = __pyx_v_f;
              __pyx_t_50 = __pyx_v_aa;
              __pyx_t_51 = __pyx_v_ab;
              __pyx_t_52 = 0;
              __pyx_t_53 = 1;
              __pyx_t_54 = (*__Pyx_BufPtrStrided7d(__pyx_t_float_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_47, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_48, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_49, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_50, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_51, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_52, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_53, __pyx_pybuffernd_r.diminfo[6].strides));
              __pyx_t_55 = __pyx_v_d;
              __pyx_t_56 = __pyx_v_i;
              __pyx_t_57 = __pyx_v_t;
              __pyx_t_58 = __pyx_v_f;
              __pyx_t_59 = __pyx_v_ab;
              __pyx_t_60 = __pyx_v_aa;
              __pyx_t_61 = 1;
              __pyx_t_62 = 0;
              __pyx_t_63 = (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_55, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_56, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_57, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_58, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_59, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_60, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_61, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_62, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_42 = __pyx_v_i;
              __pyx_t_43 = __pyx_v_t;
              __pyx_t_44 = __pyx_v_f;
              __pyx_t_45 = __pyx_v_aa;
              __pyx_t_46 = __pyx_v_ab;
              __pyx_t_47 = __pyx_v_i;
              __pyx_t_48 = __pyx_v_t;
              __pyx_t_49 = __pyx_v_f;
              __pyx_t_50 = __pyx_v_aa;
              __pyx_t_51 = __pyx_v_ab;
              __pyx_t_52 = 0;
              __pyx_t_53 = 1;
              __pyx_t_54 = (*__Pyx_BufPtrStrided7d(__pyx_t_double_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_47, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_48, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_49, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_50, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_51, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_52, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_53, __pyx_pybuffernd_r.diminfo[6].strides));
              __pyx_t_55 = __pyx_v_d;
              __pyx_t_56 = __pyx_v_i;
              __pyx_t_57 = __pyx_v_t;
              __pyx_t_58 = __pyx_v_f;
              __pyx_t_59 = __pyx_v_ab;
              __pyx_t_60 = __pyx_v_aa;
              __pyx_t_61 = 1;
              __pyx_t_62 = 0;
              __pyx_t_63 = (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_55, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_56, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_57, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_58, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_59, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_60, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_61, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_62, __pyx_pybuffernd_jh.diminfo[7].strides));
</pre><pre class="cython line score-0">&#xA0;<span class="">149</span>: </pre>
<pre class="cython line score-22" onclick='toggleDiv(this)'>+<span class="">150</span>:                             jhwr[d,rr,rc,aa,0,1] = jhwr[d,rr,rc,aa,0,1] + \</pre>
<pre class='cython code score-22 '>              __pyx_t_71 = __pyx_v_d;
              __pyx_t_72 = __pyx_v_rr;
              __pyx_t_73 = __pyx_v_rc;
              __pyx_t_74 = __pyx_v_aa;
              __pyx_t_75 = 0;
              __pyx_t_76 = 1;
              __pyx_t_63 = (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_71, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_72, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_73, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_74, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_75, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_76, __pyx_pybuffernd_jhwr.diminfo[5].strides));
/* … */
              __pyx_t_64 = __Pyx_c_sum_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_63), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_63)), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_77, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_78, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_79, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_80, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_81, __pyx_pybuffernd_w.diminfo[4].strides)), 0), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_54), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_54))), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_41), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_41))));
              __pyx_t_97 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_64);<span class='error_goto'> if (unlikely(!__pyx_t_97)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_97);
/* … */
              __pyx_t_118 = __pyx_v_d;
              __pyx_t_119 = __pyx_v_rr;
              __pyx_t_120 = __pyx_v_rc;
              __pyx_t_121 = __pyx_v_aa;
              __pyx_t_122 = 0;
              __pyx_t_123 = 1;
              *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_118, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_119, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_120, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_121, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_122, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_123, __pyx_pybuffernd_jhwr.diminfo[5].strides) = __pyx_t_41;
/* … */
              __pyx_t_71 = __pyx_v_d;
              __pyx_t_72 = __pyx_v_rr;
              __pyx_t_73 = __pyx_v_rc;
              __pyx_t_74 = __pyx_v_aa;
              __pyx_t_75 = 0;
              __pyx_t_76 = 1;
              __pyx_t_63 = (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_71, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_72, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_73, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_74, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_75, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_76, __pyx_pybuffernd_jhwr.diminfo[5].strides));
/* … */
              __pyx_t_64 = __Pyx_c_sum_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_63), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_63)), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_77, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_78, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_79, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_80, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_81, __pyx_pybuffernd_w.diminfo[4].strides)), 0), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_54), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_54))), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_41), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_41))));
              __pyx_t_97 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_64);<span class='error_goto'> if (unlikely(!__pyx_t_97)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_97);
/* … */
              __pyx_t_118 = __pyx_v_d;
              __pyx_t_119 = __pyx_v_rr;
              __pyx_t_120 = __pyx_v_rc;
              __pyx_t_121 = __pyx_v_aa;
              __pyx_t_122 = 0;
              __pyx_t_123 = 1;
              *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_118, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_119, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_120, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_121, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_122, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_123, __pyx_pybuffernd_jhwr.diminfo[5].strides) = __pyx_t_41;
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">151</span>:                                                     w[i,t,f,aa,ab]*r[i,t,f,aa,ab,0,0]*jh[d,i,t,f,ab,aa,0,1] + \</pre>
<pre class='cython code score-20 '>              __pyx_t_77 = __pyx_v_i;
              __pyx_t_78 = __pyx_v_t;
              __pyx_t_79 = __pyx_v_f;
              __pyx_t_80 = __pyx_v_aa;
              __pyx_t_81 = __pyx_v_ab;
              __pyx_t_82 = __pyx_v_i;
              __pyx_t_83 = __pyx_v_t;
              __pyx_t_84 = __pyx_v_f;
              __pyx_t_85 = __pyx_v_aa;
              __pyx_t_86 = __pyx_v_ab;
              __pyx_t_87 = 0;
              __pyx_t_88 = 0;
              __pyx_t_54 = (*__Pyx_BufPtrStrided7d(__pyx_t_float_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_82, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_83, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_84, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_85, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_86, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_87, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_88, __pyx_pybuffernd_r.diminfo[6].strides));
              __pyx_t_89 = __pyx_v_d;
              __pyx_t_90 = __pyx_v_i;
              __pyx_t_91 = __pyx_v_t;
              __pyx_t_92 = __pyx_v_f;
              __pyx_t_93 = __pyx_v_ab;
              __pyx_t_94 = __pyx_v_aa;
              __pyx_t_95 = 0;
              __pyx_t_96 = 1;
              __pyx_t_41 = (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_89, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_90, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_91, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_92, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_93, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_94, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_95, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_96, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_102 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_97, __pyx_t_101);<span class='error_goto'> if (unlikely(!__pyx_t_102)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_102);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_97); __pyx_t_97 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_101); __pyx_t_101 = 0;
              __pyx_t_41 = <span class='pyx_c_api'>__Pyx_PyComplex_As___pyx_t_float_complex</span>(__pyx_t_102);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_102); __pyx_t_102 = 0;
/* … */
              __pyx_t_77 = __pyx_v_i;
              __pyx_t_78 = __pyx_v_t;
              __pyx_t_79 = __pyx_v_f;
              __pyx_t_80 = __pyx_v_aa;
              __pyx_t_81 = __pyx_v_ab;
              __pyx_t_82 = __pyx_v_i;
              __pyx_t_83 = __pyx_v_t;
              __pyx_t_84 = __pyx_v_f;
              __pyx_t_85 = __pyx_v_aa;
              __pyx_t_86 = __pyx_v_ab;
              __pyx_t_87 = 0;
              __pyx_t_88 = 0;
              __pyx_t_54 = (*__Pyx_BufPtrStrided7d(__pyx_t_double_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_82, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_83, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_84, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_85, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_86, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_87, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_88, __pyx_pybuffernd_r.diminfo[6].strides));
              __pyx_t_89 = __pyx_v_d;
              __pyx_t_90 = __pyx_v_i;
              __pyx_t_91 = __pyx_v_t;
              __pyx_t_92 = __pyx_v_f;
              __pyx_t_93 = __pyx_v_ab;
              __pyx_t_94 = __pyx_v_aa;
              __pyx_t_95 = 0;
              __pyx_t_96 = 1;
              __pyx_t_41 = (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_89, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_90, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_91, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_92, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_93, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_94, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_95, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_96, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_102 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_97, __pyx_t_101);<span class='error_goto'> if (unlikely(!__pyx_t_102)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_102);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_97); __pyx_t_97 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_101); __pyx_t_101 = 0;
              __pyx_t_41 = <span class='pyx_c_api'>__Pyx_PyComplex_As___pyx_t_double_complex</span>(__pyx_t_102);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_102); __pyx_t_102 = 0;
</pre><pre class="cython line score-94" onclick='toggleDiv(this)'>+<span class="">152</span>:                                                     w[i,t,aa,ab]*r[i,t,f,aa,ab,0,1]*jh[d,i,t,f,ab,aa,1,1]</pre>
<pre class='cython code score-94 '>              __pyx_t_98 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_98)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_98);
              __pyx_t_99 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_t);<span class='error_goto'> if (unlikely(!__pyx_t_99)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_99);
              __pyx_t_100 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_aa);<span class='error_goto'> if (unlikely(!__pyx_t_100)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_100);
              __pyx_t_101 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_ab);<span class='error_goto'> if (unlikely(!__pyx_t_101)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_101);
              __pyx_t_102 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_102)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_102);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_98);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_102, 0, __pyx_t_98);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_99);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_102, 1, __pyx_t_99);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_100);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_102, 2, __pyx_t_100);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_101);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_102, 3, __pyx_t_101);
              __pyx_t_98 = 0;
              __pyx_t_99 = 0;
              __pyx_t_100 = 0;
              __pyx_t_101 = 0;
              __pyx_t_101 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_w), __pyx_t_102);<span class='error_goto'> if (unlikely(__pyx_t_101 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_101);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_102); __pyx_t_102 = 0;
              __pyx_t_103 = __pyx_v_i;
              __pyx_t_104 = __pyx_v_t;
              __pyx_t_105 = __pyx_v_f;
              __pyx_t_106 = __pyx_v_aa;
              __pyx_t_107 = __pyx_v_ab;
              __pyx_t_108 = 0;
              __pyx_t_109 = 1;
              __pyx_t_41 = (*__Pyx_BufPtrStrided7d(__pyx_t_float_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_103, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_104, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_105, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_106, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_107, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_108, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_109, __pyx_pybuffernd_r.diminfo[6].strides));
              __pyx_t_102 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_41);<span class='error_goto'> if (unlikely(!__pyx_t_102)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_102);
              __pyx_t_100 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_101, __pyx_t_102);<span class='error_goto'> if (unlikely(!__pyx_t_100)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_100);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_101); __pyx_t_101 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_102); __pyx_t_102 = 0;
              __pyx_t_110 = __pyx_v_d;
              __pyx_t_111 = __pyx_v_i;
              __pyx_t_112 = __pyx_v_t;
              __pyx_t_113 = __pyx_v_f;
              __pyx_t_114 = __pyx_v_ab;
              __pyx_t_115 = __pyx_v_aa;
              __pyx_t_116 = 1;
              __pyx_t_117 = 1;
              __pyx_t_41 = (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_110, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_111, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_112, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_113, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_114, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_115, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_116, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_117, __pyx_pybuffernd_jh.diminfo[7].strides));
              __pyx_t_102 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_41);<span class='error_goto'> if (unlikely(!__pyx_t_102)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_102);
              __pyx_t_101 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_100, __pyx_t_102);<span class='error_goto'> if (unlikely(!__pyx_t_101)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_101);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_100); __pyx_t_100 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_102); __pyx_t_102 = 0;
/* … */
              __pyx_t_98 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_98)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_98);
              __pyx_t_99 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_t);<span class='error_goto'> if (unlikely(!__pyx_t_99)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_99);
              __pyx_t_100 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_aa);<span class='error_goto'> if (unlikely(!__pyx_t_100)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_100);
              __pyx_t_101 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_ab);<span class='error_goto'> if (unlikely(!__pyx_t_101)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_101);
              __pyx_t_102 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_102)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_102);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_98);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_102, 0, __pyx_t_98);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_99);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_102, 1, __pyx_t_99);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_100);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_102, 2, __pyx_t_100);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_101);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_102, 3, __pyx_t_101);
              __pyx_t_98 = 0;
              __pyx_t_99 = 0;
              __pyx_t_100 = 0;
              __pyx_t_101 = 0;
              __pyx_t_101 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_w), __pyx_t_102);<span class='error_goto'> if (unlikely(__pyx_t_101 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_101);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_102); __pyx_t_102 = 0;
              __pyx_t_103 = __pyx_v_i;
              __pyx_t_104 = __pyx_v_t;
              __pyx_t_105 = __pyx_v_f;
              __pyx_t_106 = __pyx_v_aa;
              __pyx_t_107 = __pyx_v_ab;
              __pyx_t_108 = 0;
              __pyx_t_109 = 1;
              __pyx_t_41 = (*__Pyx_BufPtrStrided7d(__pyx_t_double_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_103, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_104, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_105, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_106, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_107, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_108, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_109, __pyx_pybuffernd_r.diminfo[6].strides));
              __pyx_t_102 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_41);<span class='error_goto'> if (unlikely(!__pyx_t_102)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_102);
              __pyx_t_100 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_101, __pyx_t_102);<span class='error_goto'> if (unlikely(!__pyx_t_100)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_100);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_101); __pyx_t_101 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_102); __pyx_t_102 = 0;
              __pyx_t_110 = __pyx_v_d;
              __pyx_t_111 = __pyx_v_i;
              __pyx_t_112 = __pyx_v_t;
              __pyx_t_113 = __pyx_v_f;
              __pyx_t_114 = __pyx_v_ab;
              __pyx_t_115 = __pyx_v_aa;
              __pyx_t_116 = 1;
              __pyx_t_117 = 1;
              __pyx_t_41 = (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_110, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_111, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_112, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_113, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_114, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_115, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_116, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_117, __pyx_pybuffernd_jh.diminfo[7].strides));
              __pyx_t_102 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_41);<span class='error_goto'> if (unlikely(!__pyx_t_102)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_102);
              __pyx_t_101 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_100, __pyx_t_102);<span class='error_goto'> if (unlikely(!__pyx_t_101)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_101);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_100); __pyx_t_100 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_102); __pyx_t_102 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">153</span>: </pre>
<pre class="cython line score-4" onclick='toggleDiv(this)'>+<span class="">154</span>:                             jhwr[d,rr,rc,aa,1,0] = jhwr[d,rr,rc,aa,1,0] + \</pre>
<pre class='cython code score-4 '>              __pyx_t_124 = __pyx_v_d;
              __pyx_t_125 = __pyx_v_rr;
              __pyx_t_126 = __pyx_v_rc;
              __pyx_t_127 = __pyx_v_aa;
              __pyx_t_128 = 1;
              __pyx_t_129 = 0;
              __pyx_t_41 = (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_124, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_125, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_126, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_127, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_128, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_129, __pyx_pybuffernd_jhwr.diminfo[5].strides));
/* … */
              __pyx_t_170 = __pyx_v_d;
              __pyx_t_171 = __pyx_v_rr;
              __pyx_t_172 = __pyx_v_rc;
              __pyx_t_173 = __pyx_v_aa;
              __pyx_t_174 = 1;
              __pyx_t_175 = 0;
              *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_170, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_171, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_172, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_173, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_174, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_175, __pyx_pybuffernd_jhwr.diminfo[5].strides) = __pyx_t_float_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_64), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_64));
/* … */
              __pyx_t_124 = __pyx_v_d;
              __pyx_t_125 = __pyx_v_rr;
              __pyx_t_126 = __pyx_v_rc;
              __pyx_t_127 = __pyx_v_aa;
              __pyx_t_128 = 1;
              __pyx_t_129 = 0;
              __pyx_t_41 = (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_124, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_125, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_126, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_127, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_128, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_129, __pyx_pybuffernd_jhwr.diminfo[5].strides));
/* … */
              __pyx_t_170 = __pyx_v_d;
              __pyx_t_171 = __pyx_v_rr;
              __pyx_t_172 = __pyx_v_rc;
              __pyx_t_173 = __pyx_v_aa;
              __pyx_t_174 = 1;
              __pyx_t_175 = 0;
              *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_170, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_171, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_172, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_173, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_174, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_175, __pyx_pybuffernd_jhwr.diminfo[5].strides) = __pyx_t_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_64), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_64));
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">155</span>:                                                     w[i,t,f,aa,ab]*r[i,t,f,aa,ab,1,0]*jh[d,i,t,f,ab,aa,0,0] + \</pre>
<pre class='cython code score-20 '>              __pyx_t_130 = __pyx_v_i;
              __pyx_t_131 = __pyx_v_t;
              __pyx_t_132 = __pyx_v_f;
              __pyx_t_133 = __pyx_v_aa;
              __pyx_t_134 = __pyx_v_ab;
              __pyx_t_135 = __pyx_v_i;
              __pyx_t_136 = __pyx_v_t;
              __pyx_t_137 = __pyx_v_f;
              __pyx_t_138 = __pyx_v_aa;
              __pyx_t_139 = __pyx_v_ab;
              __pyx_t_140 = 1;
              __pyx_t_141 = 0;
              __pyx_t_54 = (*__Pyx_BufPtrStrided7d(__pyx_t_float_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_135, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_136, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_137, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_138, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_139, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_140, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_141, __pyx_pybuffernd_r.diminfo[6].strides));
              __pyx_t_142 = __pyx_v_d;
              __pyx_t_143 = __pyx_v_i;
              __pyx_t_144 = __pyx_v_t;
              __pyx_t_145 = __pyx_v_f;
              __pyx_t_146 = __pyx_v_ab;
              __pyx_t_147 = __pyx_v_aa;
              __pyx_t_148 = 0;
              __pyx_t_149 = 0;
              __pyx_t_63 = (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_142, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_143, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_144, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_145, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_146, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_147, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_148, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_149, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_64 = __Pyx_c_sum_npy_double(__Pyx_c_sum_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_41), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_41)), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_130, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_131, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_132, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_133, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_134, __pyx_pybuffernd_w.diminfo[4].strides)), 0), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_54), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_54))), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_63), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_63)))), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_150, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_151, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_152, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_153, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_154, __pyx_pybuffernd_w.diminfo[4].strides)), 0), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_32), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_32))), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_19), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_19))));
/* … */
              __pyx_t_130 = __pyx_v_i;
              __pyx_t_131 = __pyx_v_t;
              __pyx_t_132 = __pyx_v_f;
              __pyx_t_133 = __pyx_v_aa;
              __pyx_t_134 = __pyx_v_ab;
              __pyx_t_135 = __pyx_v_i;
              __pyx_t_136 = __pyx_v_t;
              __pyx_t_137 = __pyx_v_f;
              __pyx_t_138 = __pyx_v_aa;
              __pyx_t_139 = __pyx_v_ab;
              __pyx_t_140 = 1;
              __pyx_t_141 = 0;
              __pyx_t_54 = (*__Pyx_BufPtrStrided7d(__pyx_t_double_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_135, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_136, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_137, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_138, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_139, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_140, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_141, __pyx_pybuffernd_r.diminfo[6].strides));
              __pyx_t_142 = __pyx_v_d;
              __pyx_t_143 = __pyx_v_i;
              __pyx_t_144 = __pyx_v_t;
              __pyx_t_145 = __pyx_v_f;
              __pyx_t_146 = __pyx_v_ab;
              __pyx_t_147 = __pyx_v_aa;
              __pyx_t_148 = 0;
              __pyx_t_149 = 0;
              __pyx_t_63 = (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_142, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_143, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_144, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_145, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_146, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_147, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_148, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_149, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_64 = __Pyx_c_sum_npy_double(__Pyx_c_sum_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_41), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_41)), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_130, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_131, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_132, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_133, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_134, __pyx_pybuffernd_w.diminfo[4].strides)), 0), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_54), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_54))), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_63), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_63)))), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_150, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_151, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_152, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_153, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_154, __pyx_pybuffernd_w.diminfo[4].strides)), 0), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_32), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_32))), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_19), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_19))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">156</span>:                                                     w[i,t,f,aa,ab]*r[i,t,f,aa,ab,1,1]*jh[d,i,t,f,ab,aa,1,0]</pre>
<pre class='cython code score-0 '>              __pyx_t_150 = __pyx_v_i;
              __pyx_t_151 = __pyx_v_t;
              __pyx_t_152 = __pyx_v_f;
              __pyx_t_153 = __pyx_v_aa;
              __pyx_t_154 = __pyx_v_ab;
              __pyx_t_155 = __pyx_v_i;
              __pyx_t_156 = __pyx_v_t;
              __pyx_t_157 = __pyx_v_f;
              __pyx_t_158 = __pyx_v_aa;
              __pyx_t_159 = __pyx_v_ab;
              __pyx_t_160 = 1;
              __pyx_t_161 = 1;
              __pyx_t_32 = (*__Pyx_BufPtrStrided7d(__pyx_t_float_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_155, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_156, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_157, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_158, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_159, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_160, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_161, __pyx_pybuffernd_r.diminfo[6].strides));
              __pyx_t_162 = __pyx_v_d;
              __pyx_t_163 = __pyx_v_i;
              __pyx_t_164 = __pyx_v_t;
              __pyx_t_165 = __pyx_v_f;
              __pyx_t_166 = __pyx_v_ab;
              __pyx_t_167 = __pyx_v_aa;
              __pyx_t_168 = 1;
              __pyx_t_169 = 0;
              __pyx_t_19 = (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_162, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_163, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_164, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_165, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_166, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_167, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_168, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_169, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_150 = __pyx_v_i;
              __pyx_t_151 = __pyx_v_t;
              __pyx_t_152 = __pyx_v_f;
              __pyx_t_153 = __pyx_v_aa;
              __pyx_t_154 = __pyx_v_ab;
              __pyx_t_155 = __pyx_v_i;
              __pyx_t_156 = __pyx_v_t;
              __pyx_t_157 = __pyx_v_f;
              __pyx_t_158 = __pyx_v_aa;
              __pyx_t_159 = __pyx_v_ab;
              __pyx_t_160 = 1;
              __pyx_t_161 = 1;
              __pyx_t_32 = (*__Pyx_BufPtrStrided7d(__pyx_t_double_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_155, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_156, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_157, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_158, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_159, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_160, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_161, __pyx_pybuffernd_r.diminfo[6].strides));
              __pyx_t_162 = __pyx_v_d;
              __pyx_t_163 = __pyx_v_i;
              __pyx_t_164 = __pyx_v_t;
              __pyx_t_165 = __pyx_v_f;
              __pyx_t_166 = __pyx_v_ab;
              __pyx_t_167 = __pyx_v_aa;
              __pyx_t_168 = 1;
              __pyx_t_169 = 0;
              __pyx_t_19 = (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_162, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_163, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_164, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_165, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_166, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_167, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_168, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_169, __pyx_pybuffernd_jh.diminfo[7].strides));
</pre><pre class="cython line score-0">&#xA0;<span class="">157</span>: </pre>
<pre class="cython line score-4" onclick='toggleDiv(this)'>+<span class="">158</span>:                             jhwr[d,rr,rc,aa,1,1] = jhwr[d,rr,rc,aa,1,1] + \</pre>
<pre class='cython code score-4 '>              __pyx_t_176 = __pyx_v_d;
              __pyx_t_177 = __pyx_v_rr;
              __pyx_t_178 = __pyx_v_rc;
              __pyx_t_179 = __pyx_v_aa;
              __pyx_t_180 = 1;
              __pyx_t_181 = 1;
              __pyx_t_19 = (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_176, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_177, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_178, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_179, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_180, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_181, __pyx_pybuffernd_jhwr.diminfo[5].strides));
/* … */
              __pyx_t_222 = __pyx_v_d;
              __pyx_t_223 = __pyx_v_rr;
              __pyx_t_224 = __pyx_v_rc;
              __pyx_t_225 = __pyx_v_aa;
              __pyx_t_226 = 1;
              __pyx_t_227 = 1;
              *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_222, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_223, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_224, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_225, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_226, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_227, __pyx_pybuffernd_jhwr.diminfo[5].strides) = __pyx_t_float_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_64), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_64));
            }
          }
        }
      }
    }
  }
/* … */
              __pyx_t_176 = __pyx_v_d;
              __pyx_t_177 = __pyx_v_rr;
              __pyx_t_178 = __pyx_v_rc;
              __pyx_t_179 = __pyx_v_aa;
              __pyx_t_180 = 1;
              __pyx_t_181 = 1;
              __pyx_t_19 = (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_176, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_177, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_178, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_179, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_180, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_181, __pyx_pybuffernd_jhwr.diminfo[5].strides));
/* … */
              __pyx_t_222 = __pyx_v_d;
              __pyx_t_223 = __pyx_v_rr;
              __pyx_t_224 = __pyx_v_rc;
              __pyx_t_225 = __pyx_v_aa;
              __pyx_t_226 = 1;
              __pyx_t_227 = 1;
              *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_222, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_223, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_224, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_225, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_226, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_227, __pyx_pybuffernd_jhwr.diminfo[5].strides) = __pyx_t_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_64), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_64));
            }
          }
        }
      }
    }
  }
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">159</span>:                                                     w[i,t,f,aa,ab]*r[i,t,f,aa,ab,1,0]*jh[d,i,t,f,ab,aa,0,1] + \</pre>
<pre class='cython code score-20 '>              __pyx_t_182 = __pyx_v_i;
              __pyx_t_183 = __pyx_v_t;
              __pyx_t_184 = __pyx_v_f;
              __pyx_t_185 = __pyx_v_aa;
              __pyx_t_186 = __pyx_v_ab;
              __pyx_t_187 = __pyx_v_i;
              __pyx_t_188 = __pyx_v_t;
              __pyx_t_189 = __pyx_v_f;
              __pyx_t_190 = __pyx_v_aa;
              __pyx_t_191 = __pyx_v_ab;
              __pyx_t_192 = 1;
              __pyx_t_193 = 0;
              __pyx_t_32 = (*__Pyx_BufPtrStrided7d(__pyx_t_float_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_187, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_188, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_189, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_190, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_191, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_192, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_193, __pyx_pybuffernd_r.diminfo[6].strides));
              __pyx_t_194 = __pyx_v_d;
              __pyx_t_195 = __pyx_v_i;
              __pyx_t_196 = __pyx_v_t;
              __pyx_t_197 = __pyx_v_f;
              __pyx_t_198 = __pyx_v_ab;
              __pyx_t_199 = __pyx_v_aa;
              __pyx_t_200 = 0;
              __pyx_t_201 = 1;
              __pyx_t_63 = (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_194, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_195, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_196, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_197, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_198, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_199, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_200, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_201, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_64 = __Pyx_c_sum_npy_double(__Pyx_c_sum_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_19), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_19)), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_182, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_183, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_184, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_185, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_186, __pyx_pybuffernd_w.diminfo[4].strides)), 0), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_32), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_32))), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_63), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_63)))), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_202, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_203, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_204, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_205, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_206, __pyx_pybuffernd_w.diminfo[4].strides)), 0), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_54), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_54))), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_41), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_41))));
/* … */
              __pyx_t_182 = __pyx_v_i;
              __pyx_t_183 = __pyx_v_t;
              __pyx_t_184 = __pyx_v_f;
              __pyx_t_185 = __pyx_v_aa;
              __pyx_t_186 = __pyx_v_ab;
              __pyx_t_187 = __pyx_v_i;
              __pyx_t_188 = __pyx_v_t;
              __pyx_t_189 = __pyx_v_f;
              __pyx_t_190 = __pyx_v_aa;
              __pyx_t_191 = __pyx_v_ab;
              __pyx_t_192 = 1;
              __pyx_t_193 = 0;
              __pyx_t_32 = (*__Pyx_BufPtrStrided7d(__pyx_t_double_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_187, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_188, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_189, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_190, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_191, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_192, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_193, __pyx_pybuffernd_r.diminfo[6].strides));
              __pyx_t_194 = __pyx_v_d;
              __pyx_t_195 = __pyx_v_i;
              __pyx_t_196 = __pyx_v_t;
              __pyx_t_197 = __pyx_v_f;
              __pyx_t_198 = __pyx_v_ab;
              __pyx_t_199 = __pyx_v_aa;
              __pyx_t_200 = 0;
              __pyx_t_201 = 1;
              __pyx_t_63 = (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_194, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_195, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_196, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_197, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_198, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_199, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_200, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_201, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_64 = __Pyx_c_sum_npy_double(__Pyx_c_sum_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_19), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_19)), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_182, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_183, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_184, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_185, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_186, __pyx_pybuffernd_w.diminfo[4].strides)), 0), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_32), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_32))), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_63), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_63)))), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_202, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_203, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_204, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_205, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_206, __pyx_pybuffernd_w.diminfo[4].strides)), 0), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_54), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_54))), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_41), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_41))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">160</span>:                                                     w[i,t,f,aa,ab]*r[i,t,f,aa,ab,1,1]*jh[d,i,t,f,ab,aa,1,1]</pre>
<pre class='cython code score-0 '>              __pyx_t_202 = __pyx_v_i;
              __pyx_t_203 = __pyx_v_t;
              __pyx_t_204 = __pyx_v_f;
              __pyx_t_205 = __pyx_v_aa;
              __pyx_t_206 = __pyx_v_ab;
              __pyx_t_207 = __pyx_v_i;
              __pyx_t_208 = __pyx_v_t;
              __pyx_t_209 = __pyx_v_f;
              __pyx_t_210 = __pyx_v_aa;
              __pyx_t_211 = __pyx_v_ab;
              __pyx_t_212 = 1;
              __pyx_t_213 = 1;
              __pyx_t_54 = (*__Pyx_BufPtrStrided7d(__pyx_t_float_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_207, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_208, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_209, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_210, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_211, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_212, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_213, __pyx_pybuffernd_r.diminfo[6].strides));
              __pyx_t_214 = __pyx_v_d;
              __pyx_t_215 = __pyx_v_i;
              __pyx_t_216 = __pyx_v_t;
              __pyx_t_217 = __pyx_v_f;
              __pyx_t_218 = __pyx_v_ab;
              __pyx_t_219 = __pyx_v_aa;
              __pyx_t_220 = 1;
              __pyx_t_221 = 1;
              __pyx_t_41 = (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_214, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_215, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_216, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_217, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_218, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_219, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_220, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_221, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_202 = __pyx_v_i;
              __pyx_t_203 = __pyx_v_t;
              __pyx_t_204 = __pyx_v_f;
              __pyx_t_205 = __pyx_v_aa;
              __pyx_t_206 = __pyx_v_ab;
              __pyx_t_207 = __pyx_v_i;
              __pyx_t_208 = __pyx_v_t;
              __pyx_t_209 = __pyx_v_f;
              __pyx_t_210 = __pyx_v_aa;
              __pyx_t_211 = __pyx_v_ab;
              __pyx_t_212 = 1;
              __pyx_t_213 = 1;
              __pyx_t_54 = (*__Pyx_BufPtrStrided7d(__pyx_t_double_complex *, __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.buf, __pyx_t_207, __pyx_pybuffernd_r.diminfo[0].strides, __pyx_t_208, __pyx_pybuffernd_r.diminfo[1].strides, __pyx_t_209, __pyx_pybuffernd_r.diminfo[2].strides, __pyx_t_210, __pyx_pybuffernd_r.diminfo[3].strides, __pyx_t_211, __pyx_pybuffernd_r.diminfo[4].strides, __pyx_t_212, __pyx_pybuffernd_r.diminfo[5].strides, __pyx_t_213, __pyx_pybuffernd_r.diminfo[6].strides));
              __pyx_t_214 = __pyx_v_d;
              __pyx_t_215 = __pyx_v_i;
              __pyx_t_216 = __pyx_v_t;
              __pyx_t_217 = __pyx_v_f;
              __pyx_t_218 = __pyx_v_ab;
              __pyx_t_219 = __pyx_v_aa;
              __pyx_t_220 = 1;
              __pyx_t_221 = 1;
              __pyx_t_41 = (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_214, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_215, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_216, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_217, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_218, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_219, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_220, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_221, __pyx_pybuffernd_jh.diminfo[7].strides));
</pre><pre class="cython line score-0">&#xA0;<span class="">161</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">162</span>: @cython.cdivision(True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">163</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">164</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">165</span>: @cython.nonecheck(False)</pre>
<pre class="cython line score-637" onclick='toggleDiv(this)'>+<span class="">166</span>: def cycompute_jhwj(np.ndarray[complex3264, ndim=8] jh,</pre>
<pre class='cython code score-637 '>/* Python wrapper */
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_7cycompute_jhwj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_6cycompute_jhwj[] = "\n    This computes the approximation to the Hessian, jhj. \n    ";
static PyMethodDef __pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_7cycompute_jhwj = {"cycompute_jhwj", (PyCFunction)__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_7cycompute_jhwj, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_6cycompute_jhwj};
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_7cycompute_jhwj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_signatures = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED PyObject *__pyx_v_defaults = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fused_cpdef (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_signatures,&amp;__pyx_n_s_args,&amp;__pyx_n_s_kwargs,&amp;__pyx_n_s_defaults,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_signatures)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_args)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_kwargs)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_defaults)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_fused_cpdef") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_signatures = values[0];
    __pyx_v_args = values[1];
    __pyx_v_kwargs = values[2];
    __pyx_v_defaults = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_6cycompute_jhwj(__pyx_self, __pyx_v_signatures, __pyx_v_args, __pyx_v_kwargs, __pyx_v_defaults);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_6cycompute_jhwj(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_signatures, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs, CYTHON_UNUSED PyObject *__pyx_v_defaults) {
  PyObject *__pyx_v_dest_sig = NULL;
  PyTypeObject *__pyx_v_ndarray = 0;
  PyObject *__pyx_v_numpy = NULL;
  __Pyx_memviewslice __pyx_v_memslice;
  Py_ssize_t __pyx_v_itemsize;
  CYTHON_UNUSED int __pyx_v_dtype_signed;
  char __pyx_v_kind;
  PyObject *__pyx_v_arg = NULL;
  PyObject *__pyx_v_dtype = NULL;
  PyObject *__pyx_v_arg_base = NULL;
  PyObject *__pyx_v_candidates = NULL;
  PyObject *__pyx_v_sig = NULL;
  int __pyx_v_match_found;
  PyObject *__pyx_v_src_type = NULL;
  PyObject *__pyx_v_dst_type = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_jhwj", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kwargs);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, Py_None);
  __pyx_v_dest_sig = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_2 = (__pyx_v_kwargs == Py_None);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kwargs, __pyx_t_1);
    __pyx_t_1 = 0;
  }
  {
    /*try:*/ {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_v_numpy = __pyx_t_1;
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_numpy, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!(likely(<span class='py_c_api'>PyType_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "type", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      __pyx_v_ndarray = ((PyTypeObject*)__pyx_t_1);
      __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L11_try_end;
    __pyx_L4_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_ImportError) || <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_AttributeError) || <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_TypeError);
    if (__pyx_t_7) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_1, &amp;__pyx_t_8, &amp;__pyx_t_9) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L6_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ndarray, ((PyTypeObject*)Py_None));
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L5_exception_handled;
    }
    goto __pyx_L6_except_error;
    __pyx_L6_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    goto __pyx_L1_error;
    __pyx_L5_exception_handled:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    __pyx_L11_try_end:;
  }
  __pyx_v_itemsize = -1L;
  if (unlikely(__pyx_v_args == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = ((0 &lt; __pyx_t_10) != 0);
  if (__pyx_t_3) {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(((PyObject*)__pyx_v_args), 0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
    __pyx_v_arg = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L14;
  }
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyDict_ContainsTF</span>(__pyx_n_s_jh, ((PyObject*)__pyx_v_kwargs), Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {
    if (unlikely(__pyx_v_kwargs == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_kwargs), __pyx_n_s_jh);<span class='error_goto'> if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_v_arg = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L14;
  }
  /*else*/ {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_Expected_at_least_d_arguments, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_L14:;
  while (1) {
    __pyx_t_2 = (__pyx_v_ndarray != ((PyTypeObject*)Py_None));
    __pyx_t_3 = (__pyx_t_2 != 0);
    if (__pyx_t_3) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_arg, __pyx_v_ndarray); 
      __pyx_t_2 = (__pyx_t_3 != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_v_dtype = __pyx_t_8;
        __pyx_t_8 = 0;
        goto __pyx_L18;
      }
      __pyx_t_2 = (__pyx_memoryview_check(__pyx_v_arg) != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_base);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_v_arg_base = __pyx_t_8;
        __pyx_t_8 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_arg_base, __pyx_v_ndarray); 
        __pyx_t_3 = (__pyx_t_2 != 0);
        if (__pyx_t_3) {
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg_base, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_v_dtype = __pyx_t_8;
          __pyx_t_8 = 0;
          goto __pyx_L19;
        }
        /*else*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
          __pyx_v_dtype = Py_None;
        }
        __pyx_L19:;
        goto __pyx_L18;
      }
      /*else*/ {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
        __pyx_v_dtype = Py_None;
      }
      __pyx_L18:;
      __pyx_v_itemsize = -1L;
      __pyx_t_3 = (__pyx_v_dtype != Py_None);
      __pyx_t_2 = (__pyx_t_3 != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dtype, __pyx_n_s_itemsize);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_itemsize = __pyx_t_10;
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dtype, __pyx_n_s_kind);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Ord</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(__pyx_t_11 == (long)(Py_UCS4)-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_kind = __pyx_t_11;
        __pyx_v_dtype_signed = (__pyx_v_kind == 'i');
        switch (__pyx_v_kind) {
          case 'i':
          case 'u':
          break;
          case 'f':
          break;
          case 'c':
          __pyx_t_3 = (((sizeof(__pyx_t_float_complex)) == __pyx_v_itemsize) != 0);
          if (__pyx_t_3) {
          } else {
            __pyx_t_2 = __pyx_t_3;
            goto __pyx_L22_bool_binop_done;
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_3 = ((((Py_ssize_t)__pyx_t_10) == 8) != 0);
          __pyx_t_2 = __pyx_t_3;
          __pyx_L22_bool_binop_done:;
          if (__pyx_t_2) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            goto __pyx_L16_break;
          }
          __pyx_t_3 = (((sizeof(__pyx_t_double_complex)) == __pyx_v_itemsize) != 0);
          if (__pyx_t_3) {
          } else {
            __pyx_t_2 = __pyx_t_3;
            goto __pyx_L25_bool_binop_done;
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_3 = ((((Py_ssize_t)__pyx_t_10) == 8) != 0);
          __pyx_t_2 = __pyx_t_3;
          __pyx_L25_bool_binop_done:;
          if (__pyx_t_2) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            goto __pyx_L16_break;
          }
          break;
          case 'O':
          break;
          default: break;
        }
      }
    }
    __pyx_t_3 = ((__pyx_v_itemsize == -1L) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L28_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_itemsize == (sizeof(__pyx_t_float_complex))) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L28_bool_binop_done:;
    if (__pyx_t_2) {
      __pyx_v_memslice = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsdsdsdsds___pyx_t_float_complex</span>(__pyx_v_arg);
      __pyx_t_2 = (__pyx_v_memslice.memview != 0);
      if (__pyx_t_2) {
        __PYX_XDEC_MEMVIEW((&amp;__pyx_v_memslice), 1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L16_break;
      }
      /*else*/ {
        <span class='py_c_api'>PyErr_Clear</span>();
      }
    }
    __pyx_t_3 = ((__pyx_v_itemsize == -1L) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L32_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_itemsize == (sizeof(__pyx_t_double_complex))) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L32_bool_binop_done:;
    if (__pyx_t_2) {
      __pyx_v_memslice = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsdsdsdsds___pyx_t_double_complex</span>(__pyx_v_arg);
      __pyx_t_2 = (__pyx_v_memslice.memview != 0);
      if (__pyx_t_2) {
        __PYX_XDEC_MEMVIEW((&amp;__pyx_v_memslice), 1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L16_break;
      }
      /*else*/ {
        <span class='py_c_api'>PyErr_Clear</span>();
      }
    }
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, Py_None, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L16_break;
  }
  __pyx_L16_break:;
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_v_candidates = ((PyObject*)__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_10 = 0;
  if (unlikely(__pyx_v_signatures == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_9 = __Pyx_dict_iterator(((PyObject*)__pyx_v_signatures), 1, ((PyObject *)NULL), (&amp;__pyx_t_12), (&amp;__pyx_t_7));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __pyx_t_8 = __pyx_t_9;
  __pyx_t_9 = 0;
  while (1) {
    __pyx_t_13 = __Pyx_dict_iter_next(__pyx_t_8, __pyx_t_12, &amp;__pyx_t_10, &amp;__pyx_t_9, NULL, NULL, __pyx_t_7);
    if (unlikely(__pyx_t_13 == 0)) break;
    if (unlikely(__pyx_t_13 == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_sig, __pyx_t_9);
    __pyx_t_9 = 0;
    __pyx_v_match_found = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_sig, __pyx_n_s_strip);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__15, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_split);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__15 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_);<span class='error_goto'> if (unlikely(!__pyx_tuple__15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__15);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dest_sig);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dest_sig);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_dest_sig);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_9 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_14 = 0;
      __pyx_t_15 = NULL;
    } else {
      __pyx_t_14 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_15 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_15)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_15(__pyx_t_9);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        PyObject* sequence = __pyx_t_1;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_16 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_17 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_16 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_17 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
        #else
        __pyx_t_16 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        __pyx_t_17 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_18 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_19 = Py_TYPE(__pyx_t_18)-&gt;tp_iternext;
        index = 0; __pyx_t_16 = __pyx_t_19(__pyx_t_18); if (unlikely(!__pyx_t_16)) goto __pyx_L39_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        index = 1; __pyx_t_17 = __pyx_t_19(__pyx_t_18); if (unlikely(!__pyx_t_17)) goto __pyx_L39_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_19(__pyx_t_18), 2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_19 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        goto __pyx_L40_unpacking_done;
        __pyx_L39_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_t_19 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_L40_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_src_type, __pyx_t_16);
      __pyx_t_16 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dst_type, __pyx_t_17);
      __pyx_t_17 = 0;
      __pyx_t_2 = (__pyx_v_dst_type != Py_None);
      __pyx_t_3 = (__pyx_t_2 != 0);
      if (__pyx_t_3) {
        __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_src_type, __pyx_v_dst_type, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (__pyx_t_3) {
          __pyx_v_match_found = 1;
          goto __pyx_L42;
        }
        /*else*/ {
          __pyx_v_match_found = 0;
          goto __pyx_L38_break;
        }
        __pyx_L42:;
      }
    }
    __pyx_L38_break:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_3 = (__pyx_v_match_found != 0);
    if (__pyx_t_3) {
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_candidates, __pyx_v_sig);<span class='error_goto'> if (unlikely(__pyx_t_20 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_3 = (__pyx_v_candidates != Py_None) &amp;&amp; (<span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates) != 0);
  __pyx_t_2 = ((!__pyx_t_3) != 0);
  if (__pyx_t_2) {
  __pyx_tuple__16 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s__3);<span class='error_goto'> if (unlikely(!__pyx_tuple__16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__16);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__17, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_12 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates);<span class='error_goto'> if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = ((__pyx_t_12 &gt; 1) != 0);
  if (__pyx_t_2) {
  __pyx_tuple__17 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_No_matching_signature_found);<span class='error_goto'> if (unlikely(!__pyx_tuple__17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__17);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__18, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(__pyx_v_signatures == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_signatures), <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_candidates, 0));<span class='error_goto'> if (unlikely(__pyx_t_8 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_r = __pyx_t_8;
    __pyx_t_8 = 0;
    goto __pyx_L0;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dest_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_numpy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dtype);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg_base);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_candidates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_src_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dst_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_35cycompute_jhwj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_fuse_0__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_35cycompute_jhwj = {"__pyx_fuse_0cycompute_jhwj", (PyCFunction)__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_35cycompute_jhwj, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_6cycompute_jhwj};
static PyObject *__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_35cycompute_jhwj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_jh = 0;
  PyArrayObject *__pyx_v_w = 0;
  PyArrayObject *__pyx_v_jhwj = 0;
  int __pyx_v_t_int;
  int __pyx_v_f_int;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_jhwj (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_jh,&amp;__pyx_n_s_w,&amp;__pyx_n_s_jhwj,&amp;__pyx_n_s_t_int,&amp;__pyx_n_s_f_int,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_w)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwj", 1, 5, 5, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jhwj)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwj", 1, 5, 5, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_t_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwj", 1, 5, 5, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwj", 1, 5, 5, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cycompute_jhwj") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_jh = ((PyArrayObject *)values[0]);
    __pyx_v_w = ((PyArrayObject *)values[1]);
    __pyx_v_jhwj = ((PyArrayObject *)values[2]);
    __pyx_v_t_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_t_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 169; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_f_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_f_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwj", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_jhwj", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jh), __pyx_ptype_5numpy_ndarray, 1, "jh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_w), __pyx_ptype_5numpy_ndarray, 1, "w", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jhwj), __pyx_ptype_5numpy_ndarray, 1, "jhwj", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_34cycompute_jhwj(__pyx_self, __pyx_v_jh, __pyx_v_w, __pyx_v_jhwj, __pyx_v_t_int, __pyx_v_f_int);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_34cycompute_jhwj(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_jh, PyArrayObject *__pyx_v_w, PyArrayObject *__pyx_v_jhwj, int __pyx_v_t_int, int __pyx_v_f_int) {
  int __pyx_v_d;
  int __pyx_v_i;
  int __pyx_v_t;
  int __pyx_v_f;
  int __pyx_v_aa;
  int __pyx_v_ab;
  int __pyx_v_rr;
  int __pyx_v_rc;
  int __pyx_v_n_dir;
  int __pyx_v_n_mod;
  int __pyx_v_n_tim;
  int __pyx_v_n_fre;
  int __pyx_v_n_ant;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jh;
  __Pyx_Buffer __pyx_pybuffer_jh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jhwj;
  __Pyx_Buffer __pyx_pybuffer_jhwj;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_w;
  __Pyx_Buffer __pyx_pybuffer_w;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_0cycompute_jhwj", 0);
  __pyx_pybuffer_jh.pybuffer.buf = NULL;
  __pyx_pybuffer_jh.refcount = 0;
  __pyx_pybuffernd_jh.data = NULL;
  __pyx_pybuffernd_jh.rcbuffer = &amp;__pyx_pybuffer_jh;
  __pyx_pybuffer_w.pybuffer.buf = NULL;
  __pyx_pybuffer_w.refcount = 0;
  __pyx_pybuffernd_w.data = NULL;
  __pyx_pybuffernd_w.rcbuffer = &amp;__pyx_pybuffer_w;
  __pyx_pybuffer_jhwj.pybuffer.buf = NULL;
  __pyx_pybuffer_jhwj.refcount = 0;
  __pyx_pybuffernd_jhwj.data = NULL;
  __pyx_pybuffernd_jhwj.rcbuffer = &amp;__pyx_pybuffer_jhwj;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jh, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 8, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jh.diminfo[0].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jh.diminfo[0].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jh.diminfo[1].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jh.diminfo[1].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jh.diminfo[2].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jh.diminfo[2].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jh.diminfo[3].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jh.diminfo[3].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jh.diminfo[4].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jh.diminfo[4].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jh.diminfo[5].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jh.diminfo[5].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_jh.diminfo[6].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_jh.diminfo[6].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[6]; __pyx_pybuffernd_jh.diminfo[7].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[7]; __pyx_pybuffernd_jh.diminfo[7].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[7];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_w, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 5, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_w.diminfo[0].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_w.diminfo[0].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_w.diminfo[1].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_w.diminfo[1].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_w.diminfo[2].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_w.diminfo[2].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_w.diminfo[3].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_w.diminfo[3].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_w.diminfo[4].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_w.diminfo[4].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[4];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jhwj, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jhwj.diminfo[0].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jhwj.diminfo[0].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jhwj.diminfo[1].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jhwj.diminfo[1].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jhwj.diminfo[2].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jhwj.diminfo[2].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jhwj.diminfo[3].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jhwj.diminfo[3].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jhwj.diminfo[4].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jhwj.diminfo[4].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jhwj.diminfo[5].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jhwj.diminfo[5].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[5];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_jhwj", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_37cycompute_jhwj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_fuse_1__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_37cycompute_jhwj = {"__pyx_fuse_1cycompute_jhwj", (PyCFunction)__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_37cycompute_jhwj, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_6cycompute_jhwj};
static PyObject *__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_37cycompute_jhwj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_jh = 0;
  PyArrayObject *__pyx_v_w = 0;
  PyArrayObject *__pyx_v_jhwj = 0;
  int __pyx_v_t_int;
  int __pyx_v_f_int;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_jhwj (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_jh,&amp;__pyx_n_s_w,&amp;__pyx_n_s_jhwj,&amp;__pyx_n_s_t_int,&amp;__pyx_n_s_f_int,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_w)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwj", 1, 5, 5, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jhwj)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwj", 1, 5, 5, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_t_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwj", 1, 5, 5, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwj", 1, 5, 5, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cycompute_jhwj") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_jh = ((PyArrayObject *)values[0]);
    __pyx_v_w = ((PyArrayObject *)values[1]);
    __pyx_v_jhwj = ((PyArrayObject *)values[2]);
    __pyx_v_t_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_t_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 169; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_f_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_f_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwj", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_jhwj", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jh), __pyx_ptype_5numpy_ndarray, 1, "jh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_w), __pyx_ptype_5numpy_ndarray, 1, "w", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jhwj), __pyx_ptype_5numpy_ndarray, 1, "jhwj", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_36cycompute_jhwj(__pyx_self, __pyx_v_jh, __pyx_v_w, __pyx_v_jhwj, __pyx_v_t_int, __pyx_v_f_int);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_36cycompute_jhwj(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_jh, PyArrayObject *__pyx_v_w, PyArrayObject *__pyx_v_jhwj, int __pyx_v_t_int, int __pyx_v_f_int) {
  int __pyx_v_d;
  int __pyx_v_i;
  int __pyx_v_t;
  int __pyx_v_f;
  int __pyx_v_aa;
  int __pyx_v_ab;
  int __pyx_v_rr;
  int __pyx_v_rc;
  int __pyx_v_n_dir;
  int __pyx_v_n_mod;
  int __pyx_v_n_tim;
  int __pyx_v_n_fre;
  int __pyx_v_n_ant;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jh;
  __Pyx_Buffer __pyx_pybuffer_jh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jhwj;
  __Pyx_Buffer __pyx_pybuffer_jhwj;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_w;
  __Pyx_Buffer __pyx_pybuffer_w;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_1cycompute_jhwj", 0);
  __pyx_pybuffer_jh.pybuffer.buf = NULL;
  __pyx_pybuffer_jh.refcount = 0;
  __pyx_pybuffernd_jh.data = NULL;
  __pyx_pybuffernd_jh.rcbuffer = &amp;__pyx_pybuffer_jh;
  __pyx_pybuffer_w.pybuffer.buf = NULL;
  __pyx_pybuffer_w.refcount = 0;
  __pyx_pybuffernd_w.data = NULL;
  __pyx_pybuffernd_w.rcbuffer = &amp;__pyx_pybuffer_w;
  __pyx_pybuffer_jhwj.pybuffer.buf = NULL;
  __pyx_pybuffer_jhwj.refcount = 0;
  __pyx_pybuffernd_jhwj.data = NULL;
  __pyx_pybuffernd_jhwj.rcbuffer = &amp;__pyx_pybuffer_jhwj;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jh, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES, 8, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jh.diminfo[0].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jh.diminfo[0].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jh.diminfo[1].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jh.diminfo[1].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jh.diminfo[2].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jh.diminfo[2].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jh.diminfo[3].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jh.diminfo[3].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jh.diminfo[4].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jh.diminfo[4].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jh.diminfo[5].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jh.diminfo[5].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_jh.diminfo[6].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_jh.diminfo[6].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[6]; __pyx_pybuffernd_jh.diminfo[7].strides = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.strides[7]; __pyx_pybuffernd_jh.diminfo[7].shape = __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.shape[7];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_w, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 5, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_w.diminfo[0].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_w.diminfo[0].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_w.diminfo[1].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_w.diminfo[1].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_w.diminfo[2].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_w.diminfo[2].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_w.diminfo[3].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_w.diminfo[3].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_w.diminfo[4].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_w.diminfo[4].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[4];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jhwj, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jhwj.diminfo[0].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jhwj.diminfo[0].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jhwj.diminfo[1].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jhwj.diminfo[1].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jhwj.diminfo[2].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jhwj.diminfo[2].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jhwj.diminfo[3].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jhwj.diminfo[3].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jhwj.diminfo[4].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jhwj.diminfo[4].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jhwj.diminfo[5].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jhwj.diminfo[5].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[5];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_jhwj", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
  __pyx_tuple__18 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Function_call_with_ambiguous_arg);<span class='error_goto'> if (unlikely(!__pyx_tuple__18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__18);
/* … */
  __pyx_tuple__64 = <span class='py_c_api'>PyTuple_Pack</span>(18, __pyx_n_s_jh, __pyx_n_s_w, __pyx_n_s_jhwj, __pyx_n_s_t_int, __pyx_n_s_f_int, __pyx_n_s_d, __pyx_n_s_i, __pyx_n_s_t, __pyx_n_s_f, __pyx_n_s_aa, __pyx_n_s_ab, __pyx_n_s_rr, __pyx_n_s_rc, __pyx_n_s_n_dir, __pyx_n_s_n_mod, __pyx_n_s_n_tim, __pyx_n_s_n_fre, __pyx_n_s_n_ant);<span class='error_goto'> if (unlikely(!__pyx_tuple__64)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__64);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__64);
/* … */
  __pyx_t_7 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = __pyx_FusedFunction_NewEx(&amp;__pyx_fuse_0__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_35cycompute_jhwj, 0, __pyx_n_s_cycompute_jhwj, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__65));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_8, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_kp_s_float_complex, __pyx_t_8) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = __pyx_FusedFunction_NewEx(&amp;__pyx_fuse_1__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_37cycompute_jhwj, 0, __pyx_n_s_cycompute_jhwj, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__65));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_8, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_kp_s_double_complex, __pyx_t_8) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = __pyx_FusedFunction_NewEx(&amp;__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_7cycompute_jhwj, 0, __pyx_n_s_cycompute_jhwj, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__65));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_8, __pyx_empty_tuple);
  ((__pyx_FusedFunctionObject *) __pyx_t_8)-&gt;__signatures__ = __pyx_t_7;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_cycompute_jhwj, __pyx_t_8) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_codeobj__65 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 18, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__64, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_ulrich_CubeCal_cubecal_ker, __pyx_n_s_cycompute_jhwj, 166, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__65)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">167</span>:                   np.ndarray[np.double_t, ndim=5] w,</pre>
<pre class="cython line score-0">&#xA0;<span class="">168</span>:                   np.ndarray[complex3264, ndim=6] jhwj,</pre>
<pre class="cython line score-0">&#xA0;<span class="">169</span>:                   int t_int,</pre>
<pre class="cython line score-0">&#xA0;<span class="">170</span>:                   int f_int):</pre>
<pre class="cython line score-0">&#xA0;<span class="">171</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">172</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">173</span>:     This computes the approximation to the Hessian, jhj.</pre>
<pre class="cython line score-0">&#xA0;<span class="">174</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">175</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">176</span>:     cdef int d, i, t, f, aa, ab, rr, rc = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_rc = 0;
/* … */
  __pyx_v_rc = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">177</span>:     cdef int n_dir, n_mod, n_tim, n_fre, n_ant</pre>
<pre class="cython line score-0">&#xA0;<span class="">178</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">179</span>:     n_dir = jh.shape[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_dir = (__pyx_v_jh-&gt;dimensions[0]);
/* … */
  __pyx_v_n_dir = (__pyx_v_jh-&gt;dimensions[0]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">180</span>:     n_mod = jh.shape[1]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_mod = (__pyx_v_jh-&gt;dimensions[1]);
/* … */
  __pyx_v_n_mod = (__pyx_v_jh-&gt;dimensions[1]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">181</span>:     n_tim = jh.shape[2]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_tim = (__pyx_v_jh-&gt;dimensions[2]);
/* … */
  __pyx_v_n_tim = (__pyx_v_jh-&gt;dimensions[2]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">182</span>:     n_fre = jh.shape[3]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_fre = (__pyx_v_jh-&gt;dimensions[3]);
/* … */
  __pyx_v_n_fre = (__pyx_v_jh-&gt;dimensions[3]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">183</span>:     n_ant = jh.shape[4]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_ant = (__pyx_v_jh-&gt;dimensions[4]);
/* … */
  __pyx_v_n_ant = (__pyx_v_jh-&gt;dimensions[4]);
</pre><pre class="cython line score-0">&#xA0;<span class="">184</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">185</span>:     for d in xrange(n_dir):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_n_dir;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
/* … */
  __pyx_t_1 = __pyx_v_n_dir;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">186</span>:         for i in xrange(n_mod):</pre>
<pre class='cython code score-0 '>    __pyx_t_3 = __pyx_v_n_mod;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_i = __pyx_t_4;
/* … */
    __pyx_t_3 = __pyx_v_n_mod;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">187</span>:             for t in xrange(n_tim):</pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_n_tim;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_t = __pyx_t_6;
/* … */
      __pyx_t_5 = __pyx_v_n_tim;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_t = __pyx_t_6;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">188</span>:                 rr = t/t_int</pre>
<pre class='cython code score-0 '>        __pyx_v_rr = (__pyx_v_t / __pyx_v_t_int);
/* … */
        __pyx_v_rr = (__pyx_v_t / __pyx_v_t_int);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">189</span>:                 for f in xrange(n_fre):</pre>
<pre class='cython code score-0 '>        __pyx_t_7 = __pyx_v_n_fre;
        for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_f = __pyx_t_8;
/* … */
        __pyx_t_7 = __pyx_v_n_fre;
        for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_f = __pyx_t_8;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">190</span>:                     rc = f/f_int</pre>
<pre class='cython code score-0 '>          __pyx_v_rc = (__pyx_v_f / __pyx_v_f_int);
/* … */
          __pyx_v_rc = (__pyx_v_f / __pyx_v_f_int);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">191</span>:                     for aa in xrange(n_ant):</pre>
<pre class='cython code score-0 '>          __pyx_t_9 = __pyx_v_n_ant;
          for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
            __pyx_v_aa = __pyx_t_10;
/* … */
          __pyx_t_9 = __pyx_v_n_ant;
          for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
            __pyx_v_aa = __pyx_t_10;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">192</span>:                         for ab in xrange(n_ant):</pre>
<pre class='cython code score-0 '>            __pyx_t_11 = __pyx_v_n_ant;
            for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
              __pyx_v_ab = __pyx_t_12;
/* … */
            __pyx_t_11 = __pyx_v_n_ant;
            for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
              __pyx_v_ab = __pyx_t_12;
</pre><pre class="cython line score-4" onclick='toggleDiv(this)'>+<span class="">193</span>:                             jhwj[d,rr,rc,aa,0,0] = jhwj[d,rr,rc,aa,0,0] + \</pre>
<pre class='cython code score-4 '>              __pyx_t_13 = __pyx_v_d;
              __pyx_t_14 = __pyx_v_rr;
              __pyx_t_15 = __pyx_v_rc;
              __pyx_t_16 = __pyx_v_aa;
              __pyx_t_17 = 0;
              __pyx_t_18 = 0;
              __pyx_t_19 = (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_16, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_17, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_18, __pyx_pybuffernd_jhwj.diminfo[5].strides));
/* … */
              __pyx_t_67 = __pyx_v_d;
              __pyx_t_68 = __pyx_v_rr;
              __pyx_t_69 = __pyx_v_rc;
              __pyx_t_70 = __pyx_v_aa;
              __pyx_t_71 = 0;
              __pyx_t_72 = 0;
              *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_67, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_68, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_69, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_70, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_71, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_72, __pyx_pybuffernd_jhwj.diminfo[5].strides) = __pyx_t_float_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_66), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_66));
/* … */
              __pyx_t_13 = __pyx_v_d;
              __pyx_t_14 = __pyx_v_rr;
              __pyx_t_15 = __pyx_v_rc;
              __pyx_t_16 = __pyx_v_aa;
              __pyx_t_17 = 0;
              __pyx_t_18 = 0;
              __pyx_t_19 = (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_16, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_17, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_18, __pyx_pybuffernd_jhwj.diminfo[5].strides));
/* … */
              __pyx_t_67 = __pyx_v_d;
              __pyx_t_68 = __pyx_v_rr;
              __pyx_t_69 = __pyx_v_rc;
              __pyx_t_70 = __pyx_v_aa;
              __pyx_t_71 = 0;
              __pyx_t_72 = 0;
              *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_67, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_68, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_69, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_70, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_71, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_72, __pyx_pybuffernd_jhwj.diminfo[5].strides) = __pyx_t_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_66), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_66));
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">194</span>:                             jh[d,i,t,f,ab,aa,0,0].conjugate()*w[i,t,f,aa,ab]*jh[d,i,t,f,ab,aa,0,0] + \</pre>
<pre class='cython code score-20 '>              __pyx_t_20 = __pyx_v_d;
              __pyx_t_21 = __pyx_v_i;
              __pyx_t_22 = __pyx_v_t;
              __pyx_t_23 = __pyx_v_f;
              __pyx_t_24 = __pyx_v_ab;
              __pyx_t_25 = __pyx_v_aa;
              __pyx_t_26 = 0;
              __pyx_t_27 = 0;
              __pyx_t_28 = __Pyx_c_conjf((*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_22, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_23, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_24, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_25, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_26, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_27, __pyx_pybuffernd_jh.diminfo[7].strides)));
              __pyx_t_29 = __pyx_v_i;
              __pyx_t_30 = __pyx_v_t;
              __pyx_t_31 = __pyx_v_f;
              __pyx_t_32 = __pyx_v_aa;
              __pyx_t_33 = __pyx_v_ab;
              __pyx_t_34 = __pyx_v_d;
              __pyx_t_35 = __pyx_v_i;
              __pyx_t_36 = __pyx_v_t;
              __pyx_t_37 = __pyx_v_f;
              __pyx_t_38 = __pyx_v_ab;
              __pyx_t_39 = __pyx_v_aa;
              __pyx_t_40 = 0;
              __pyx_t_41 = 0;
              __pyx_t_42 = (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_35, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_36, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_37, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_38, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_39, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_40, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_41, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_66 = __Pyx_c_sum_npy_double(__Pyx_c_sum_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_19), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_19)), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_28), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_28)), __pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_30, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_31, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_32, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_33, __pyx_pybuffernd_w.diminfo[4].strides)), 0)), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_42), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_42)))), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_51), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_51)), __pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_52, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_53, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_54, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_55, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_56, __pyx_pybuffernd_w.diminfo[4].strides)), 0)), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_65), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_65))));
/* … */
              __pyx_t_20 = __pyx_v_d;
              __pyx_t_21 = __pyx_v_i;
              __pyx_t_22 = __pyx_v_t;
              __pyx_t_23 = __pyx_v_f;
              __pyx_t_24 = __pyx_v_ab;
              __pyx_t_25 = __pyx_v_aa;
              __pyx_t_26 = 0;
              __pyx_t_27 = 0;
              __pyx_t_28 = __Pyx_c_conj((*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_22, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_23, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_24, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_25, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_26, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_27, __pyx_pybuffernd_jh.diminfo[7].strides)));
              __pyx_t_29 = __pyx_v_i;
              __pyx_t_30 = __pyx_v_t;
              __pyx_t_31 = __pyx_v_f;
              __pyx_t_32 = __pyx_v_aa;
              __pyx_t_33 = __pyx_v_ab;
              __pyx_t_34 = __pyx_v_d;
              __pyx_t_35 = __pyx_v_i;
              __pyx_t_36 = __pyx_v_t;
              __pyx_t_37 = __pyx_v_f;
              __pyx_t_38 = __pyx_v_ab;
              __pyx_t_39 = __pyx_v_aa;
              __pyx_t_40 = 0;
              __pyx_t_41 = 0;
              __pyx_t_42 = (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_35, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_36, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_37, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_38, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_39, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_40, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_41, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_66 = __Pyx_c_sum_npy_double(__Pyx_c_sum_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_19), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_19)), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_28), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_28)), __pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_30, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_31, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_32, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_33, __pyx_pybuffernd_w.diminfo[4].strides)), 0)), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_42), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_42)))), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_51), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_51)), __pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_52, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_53, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_54, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_55, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_56, __pyx_pybuffernd_w.diminfo[4].strides)), 0)), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_65), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_65))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">195</span>:                             jh[d,i,t,f,ab,aa,1,0].conjugate()*w[i,t,f,aa,ab]*jh[d,i,t,f,ab,aa,1,0]</pre>
<pre class='cython code score-0 '>              __pyx_t_43 = __pyx_v_d;
              __pyx_t_44 = __pyx_v_i;
              __pyx_t_45 = __pyx_v_t;
              __pyx_t_46 = __pyx_v_f;
              __pyx_t_47 = __pyx_v_ab;
              __pyx_t_48 = __pyx_v_aa;
              __pyx_t_49 = 1;
              __pyx_t_50 = 0;
              __pyx_t_51 = __Pyx_c_conjf((*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_43, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_44, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_45, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_46, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_47, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_48, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_49, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_50, __pyx_pybuffernd_jh.diminfo[7].strides)));
              __pyx_t_52 = __pyx_v_i;
              __pyx_t_53 = __pyx_v_t;
              __pyx_t_54 = __pyx_v_f;
              __pyx_t_55 = __pyx_v_aa;
              __pyx_t_56 = __pyx_v_ab;
              __pyx_t_57 = __pyx_v_d;
              __pyx_t_58 = __pyx_v_i;
              __pyx_t_59 = __pyx_v_t;
              __pyx_t_60 = __pyx_v_f;
              __pyx_t_61 = __pyx_v_ab;
              __pyx_t_62 = __pyx_v_aa;
              __pyx_t_63 = 1;
              __pyx_t_64 = 0;
              __pyx_t_65 = (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_57, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_58, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_59, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_60, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_61, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_62, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_63, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_64, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_43 = __pyx_v_d;
              __pyx_t_44 = __pyx_v_i;
              __pyx_t_45 = __pyx_v_t;
              __pyx_t_46 = __pyx_v_f;
              __pyx_t_47 = __pyx_v_ab;
              __pyx_t_48 = __pyx_v_aa;
              __pyx_t_49 = 1;
              __pyx_t_50 = 0;
              __pyx_t_51 = __Pyx_c_conj((*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_43, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_44, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_45, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_46, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_47, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_48, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_49, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_50, __pyx_pybuffernd_jh.diminfo[7].strides)));
              __pyx_t_52 = __pyx_v_i;
              __pyx_t_53 = __pyx_v_t;
              __pyx_t_54 = __pyx_v_f;
              __pyx_t_55 = __pyx_v_aa;
              __pyx_t_56 = __pyx_v_ab;
              __pyx_t_57 = __pyx_v_d;
              __pyx_t_58 = __pyx_v_i;
              __pyx_t_59 = __pyx_v_t;
              __pyx_t_60 = __pyx_v_f;
              __pyx_t_61 = __pyx_v_ab;
              __pyx_t_62 = __pyx_v_aa;
              __pyx_t_63 = 1;
              __pyx_t_64 = 0;
              __pyx_t_65 = (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_57, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_58, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_59, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_60, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_61, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_62, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_63, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_64, __pyx_pybuffernd_jh.diminfo[7].strides));
</pre><pre class="cython line score-0">&#xA0;<span class="">196</span>: </pre>
<pre class="cython line score-4" onclick='toggleDiv(this)'>+<span class="">197</span>:                             jhwj[d,rr,rc,aa,0,1] = jhwj[d,rr,rc,aa,0,1] + \</pre>
<pre class='cython code score-4 '>              __pyx_t_73 = __pyx_v_d;
              __pyx_t_74 = __pyx_v_rr;
              __pyx_t_75 = __pyx_v_rc;
              __pyx_t_76 = __pyx_v_aa;
              __pyx_t_77 = 0;
              __pyx_t_78 = 1;
              __pyx_t_65 = (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_73, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_74, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_75, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_76, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_77, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_78, __pyx_pybuffernd_jhwj.diminfo[5].strides));
/* … */
              __pyx_t_121 = __pyx_v_d;
              __pyx_t_122 = __pyx_v_rr;
              __pyx_t_123 = __pyx_v_rc;
              __pyx_t_124 = __pyx_v_aa;
              __pyx_t_125 = 0;
              __pyx_t_126 = 1;
              *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_121, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_122, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_123, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_124, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_125, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_126, __pyx_pybuffernd_jhwj.diminfo[5].strides) = __pyx_t_float_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_66), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_66));
/* … */
              __pyx_t_73 = __pyx_v_d;
              __pyx_t_74 = __pyx_v_rr;
              __pyx_t_75 = __pyx_v_rc;
              __pyx_t_76 = __pyx_v_aa;
              __pyx_t_77 = 0;
              __pyx_t_78 = 1;
              __pyx_t_65 = (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_73, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_74, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_75, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_76, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_77, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_78, __pyx_pybuffernd_jhwj.diminfo[5].strides));
/* … */
              __pyx_t_121 = __pyx_v_d;
              __pyx_t_122 = __pyx_v_rr;
              __pyx_t_123 = __pyx_v_rc;
              __pyx_t_124 = __pyx_v_aa;
              __pyx_t_125 = 0;
              __pyx_t_126 = 1;
              *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_121, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_122, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_123, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_124, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_125, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_126, __pyx_pybuffernd_jhwj.diminfo[5].strides) = __pyx_t_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_66), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_66));
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">198</span>:                             jh[d,i,t,f,ab,aa,0,0].conjugate()*w[i,t,f,aa,ab]*jh[d,i,t,f,ab,aa,0,1] + \</pre>
<pre class='cython code score-20 '>              __pyx_t_79 = __pyx_v_d;
              __pyx_t_80 = __pyx_v_i;
              __pyx_t_81 = __pyx_v_t;
              __pyx_t_82 = __pyx_v_f;
              __pyx_t_83 = __pyx_v_ab;
              __pyx_t_84 = __pyx_v_aa;
              __pyx_t_85 = 0;
              __pyx_t_86 = 0;
              __pyx_t_51 = __Pyx_c_conjf((*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_79, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_80, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_81, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_82, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_83, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_84, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_85, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_86, __pyx_pybuffernd_jh.diminfo[7].strides)));
              __pyx_t_87 = __pyx_v_i;
              __pyx_t_88 = __pyx_v_t;
              __pyx_t_89 = __pyx_v_f;
              __pyx_t_90 = __pyx_v_aa;
              __pyx_t_91 = __pyx_v_ab;
              __pyx_t_92 = __pyx_v_d;
              __pyx_t_93 = __pyx_v_i;
              __pyx_t_94 = __pyx_v_t;
              __pyx_t_95 = __pyx_v_f;
              __pyx_t_96 = __pyx_v_ab;
              __pyx_t_97 = __pyx_v_aa;
              __pyx_t_98 = 0;
              __pyx_t_99 = 1;
              __pyx_t_42 = (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_92, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_93, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_94, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_95, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_96, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_97, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_98, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_99, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_66 = __Pyx_c_sum_npy_double(__Pyx_c_sum_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_65), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_65)), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_51), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_51)), __pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_87, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_88, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_89, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_90, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_91, __pyx_pybuffernd_w.diminfo[4].strides)), 0)), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_42), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_42)))), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_28), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_28)), __pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_108, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_109, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_110, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_111, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_112, __pyx_pybuffernd_w.diminfo[4].strides)), 0)), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_19), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_19))));
/* … */
              __pyx_t_79 = __pyx_v_d;
              __pyx_t_80 = __pyx_v_i;
              __pyx_t_81 = __pyx_v_t;
              __pyx_t_82 = __pyx_v_f;
              __pyx_t_83 = __pyx_v_ab;
              __pyx_t_84 = __pyx_v_aa;
              __pyx_t_85 = 0;
              __pyx_t_86 = 0;
              __pyx_t_51 = __Pyx_c_conj((*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_79, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_80, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_81, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_82, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_83, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_84, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_85, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_86, __pyx_pybuffernd_jh.diminfo[7].strides)));
              __pyx_t_87 = __pyx_v_i;
              __pyx_t_88 = __pyx_v_t;
              __pyx_t_89 = __pyx_v_f;
              __pyx_t_90 = __pyx_v_aa;
              __pyx_t_91 = __pyx_v_ab;
              __pyx_t_92 = __pyx_v_d;
              __pyx_t_93 = __pyx_v_i;
              __pyx_t_94 = __pyx_v_t;
              __pyx_t_95 = __pyx_v_f;
              __pyx_t_96 = __pyx_v_ab;
              __pyx_t_97 = __pyx_v_aa;
              __pyx_t_98 = 0;
              __pyx_t_99 = 1;
              __pyx_t_42 = (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_92, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_93, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_94, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_95, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_96, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_97, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_98, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_99, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_66 = __Pyx_c_sum_npy_double(__Pyx_c_sum_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_65), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_65)), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_51), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_51)), __pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_87, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_88, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_89, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_90, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_91, __pyx_pybuffernd_w.diminfo[4].strides)), 0)), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_42), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_42)))), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_28), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_28)), __pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_108, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_109, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_110, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_111, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_112, __pyx_pybuffernd_w.diminfo[4].strides)), 0)), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_19), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_19))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">199</span>:                             jh[d,i,t,f,ab,aa,1,0].conjugate()*w[i,t,f,aa,ab]*jh[d,i,t,f,ab,aa,1,1]</pre>
<pre class='cython code score-0 '>              __pyx_t_100 = __pyx_v_d;
              __pyx_t_101 = __pyx_v_i;
              __pyx_t_102 = __pyx_v_t;
              __pyx_t_103 = __pyx_v_f;
              __pyx_t_104 = __pyx_v_ab;
              __pyx_t_105 = __pyx_v_aa;
              __pyx_t_106 = 1;
              __pyx_t_107 = 0;
              __pyx_t_28 = __Pyx_c_conjf((*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_100, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_101, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_102, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_103, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_104, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_105, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_106, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_107, __pyx_pybuffernd_jh.diminfo[7].strides)));
              __pyx_t_108 = __pyx_v_i;
              __pyx_t_109 = __pyx_v_t;
              __pyx_t_110 = __pyx_v_f;
              __pyx_t_111 = __pyx_v_aa;
              __pyx_t_112 = __pyx_v_ab;
              __pyx_t_113 = __pyx_v_d;
              __pyx_t_114 = __pyx_v_i;
              __pyx_t_115 = __pyx_v_t;
              __pyx_t_116 = __pyx_v_f;
              __pyx_t_117 = __pyx_v_ab;
              __pyx_t_118 = __pyx_v_aa;
              __pyx_t_119 = 1;
              __pyx_t_120 = 1;
              __pyx_t_19 = (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_113, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_114, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_115, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_116, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_117, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_118, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_119, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_120, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_100 = __pyx_v_d;
              __pyx_t_101 = __pyx_v_i;
              __pyx_t_102 = __pyx_v_t;
              __pyx_t_103 = __pyx_v_f;
              __pyx_t_104 = __pyx_v_ab;
              __pyx_t_105 = __pyx_v_aa;
              __pyx_t_106 = 1;
              __pyx_t_107 = 0;
              __pyx_t_28 = __Pyx_c_conj((*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_100, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_101, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_102, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_103, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_104, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_105, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_106, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_107, __pyx_pybuffernd_jh.diminfo[7].strides)));
              __pyx_t_108 = __pyx_v_i;
              __pyx_t_109 = __pyx_v_t;
              __pyx_t_110 = __pyx_v_f;
              __pyx_t_111 = __pyx_v_aa;
              __pyx_t_112 = __pyx_v_ab;
              __pyx_t_113 = __pyx_v_d;
              __pyx_t_114 = __pyx_v_i;
              __pyx_t_115 = __pyx_v_t;
              __pyx_t_116 = __pyx_v_f;
              __pyx_t_117 = __pyx_v_ab;
              __pyx_t_118 = __pyx_v_aa;
              __pyx_t_119 = 1;
              __pyx_t_120 = 1;
              __pyx_t_19 = (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_113, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_114, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_115, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_116, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_117, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_118, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_119, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_120, __pyx_pybuffernd_jh.diminfo[7].strides));
</pre><pre class="cython line score-0">&#xA0;<span class="">200</span>: </pre>
<pre class="cython line score-4" onclick='toggleDiv(this)'>+<span class="">201</span>:                             jhwj[d,rr,rc,aa,1,0] = jhwj[d,rr,rc,aa,1,0] + \</pre>
<pre class='cython code score-4 '>              __pyx_t_127 = __pyx_v_d;
              __pyx_t_128 = __pyx_v_rr;
              __pyx_t_129 = __pyx_v_rc;
              __pyx_t_130 = __pyx_v_aa;
              __pyx_t_131 = 1;
              __pyx_t_132 = 0;
              __pyx_t_19 = (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_127, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_128, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_129, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_130, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_131, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_132, __pyx_pybuffernd_jhwj.diminfo[5].strides));
/* … */
              __pyx_t_175 = __pyx_v_d;
              __pyx_t_176 = __pyx_v_rr;
              __pyx_t_177 = __pyx_v_rc;
              __pyx_t_178 = __pyx_v_aa;
              __pyx_t_179 = 1;
              __pyx_t_180 = 0;
              *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_175, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_176, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_177, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_178, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_179, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_180, __pyx_pybuffernd_jhwj.diminfo[5].strides) = __pyx_t_float_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_66), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_66));
/* … */
              __pyx_t_127 = __pyx_v_d;
              __pyx_t_128 = __pyx_v_rr;
              __pyx_t_129 = __pyx_v_rc;
              __pyx_t_130 = __pyx_v_aa;
              __pyx_t_131 = 1;
              __pyx_t_132 = 0;
              __pyx_t_19 = (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_127, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_128, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_129, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_130, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_131, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_132, __pyx_pybuffernd_jhwj.diminfo[5].strides));
/* … */
              __pyx_t_175 = __pyx_v_d;
              __pyx_t_176 = __pyx_v_rr;
              __pyx_t_177 = __pyx_v_rc;
              __pyx_t_178 = __pyx_v_aa;
              __pyx_t_179 = 1;
              __pyx_t_180 = 0;
              *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_175, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_176, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_177, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_178, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_179, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_180, __pyx_pybuffernd_jhwj.diminfo[5].strides) = __pyx_t_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_66), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_66));
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">202</span>:                             jh[d,i,t,f,ab,aa,0,1].conjugate()*w[i,t,f,aa,ab]*jh[d,i,t,f,ab,aa,0,0] + \</pre>
<pre class='cython code score-20 '>              __pyx_t_133 = __pyx_v_d;
              __pyx_t_134 = __pyx_v_i;
              __pyx_t_135 = __pyx_v_t;
              __pyx_t_136 = __pyx_v_f;
              __pyx_t_137 = __pyx_v_ab;
              __pyx_t_138 = __pyx_v_aa;
              __pyx_t_139 = 0;
              __pyx_t_140 = 1;
              __pyx_t_28 = __Pyx_c_conjf((*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_133, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_134, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_135, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_136, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_137, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_138, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_139, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_140, __pyx_pybuffernd_jh.diminfo[7].strides)));
              __pyx_t_141 = __pyx_v_i;
              __pyx_t_142 = __pyx_v_t;
              __pyx_t_143 = __pyx_v_f;
              __pyx_t_144 = __pyx_v_aa;
              __pyx_t_145 = __pyx_v_ab;
              __pyx_t_146 = __pyx_v_d;
              __pyx_t_147 = __pyx_v_i;
              __pyx_t_148 = __pyx_v_t;
              __pyx_t_149 = __pyx_v_f;
              __pyx_t_150 = __pyx_v_ab;
              __pyx_t_151 = __pyx_v_aa;
              __pyx_t_152 = 0;
              __pyx_t_153 = 0;
              __pyx_t_42 = (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_146, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_147, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_148, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_149, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_150, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_151, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_152, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_153, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_66 = __Pyx_c_sum_npy_double(__Pyx_c_sum_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_19), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_19)), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_28), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_28)), __pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_141, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_142, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_143, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_144, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_145, __pyx_pybuffernd_w.diminfo[4].strides)), 0)), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_42), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_42)))), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_51), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_51)), __pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_162, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_163, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_164, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_165, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_166, __pyx_pybuffernd_w.diminfo[4].strides)), 0)), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_65), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_65))));
/* … */
              __pyx_t_133 = __pyx_v_d;
              __pyx_t_134 = __pyx_v_i;
              __pyx_t_135 = __pyx_v_t;
              __pyx_t_136 = __pyx_v_f;
              __pyx_t_137 = __pyx_v_ab;
              __pyx_t_138 = __pyx_v_aa;
              __pyx_t_139 = 0;
              __pyx_t_140 = 1;
              __pyx_t_28 = __Pyx_c_conj((*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_133, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_134, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_135, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_136, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_137, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_138, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_139, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_140, __pyx_pybuffernd_jh.diminfo[7].strides)));
              __pyx_t_141 = __pyx_v_i;
              __pyx_t_142 = __pyx_v_t;
              __pyx_t_143 = __pyx_v_f;
              __pyx_t_144 = __pyx_v_aa;
              __pyx_t_145 = __pyx_v_ab;
              __pyx_t_146 = __pyx_v_d;
              __pyx_t_147 = __pyx_v_i;
              __pyx_t_148 = __pyx_v_t;
              __pyx_t_149 = __pyx_v_f;
              __pyx_t_150 = __pyx_v_ab;
              __pyx_t_151 = __pyx_v_aa;
              __pyx_t_152 = 0;
              __pyx_t_153 = 0;
              __pyx_t_42 = (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_146, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_147, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_148, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_149, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_150, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_151, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_152, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_153, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_66 = __Pyx_c_sum_npy_double(__Pyx_c_sum_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_19), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_19)), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_28), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_28)), __pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_141, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_142, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_143, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_144, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_145, __pyx_pybuffernd_w.diminfo[4].strides)), 0)), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_42), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_42)))), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_51), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_51)), __pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_162, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_163, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_164, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_165, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_166, __pyx_pybuffernd_w.diminfo[4].strides)), 0)), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_65), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_65))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">203</span>:                             jh[d,i,t,f,ab,aa,1,1].conjugate()*w[i,t,f,aa,ab]*jh[d,i,t,f,ab,aa,1,0]</pre>
<pre class='cython code score-0 '>              __pyx_t_154 = __pyx_v_d;
              __pyx_t_155 = __pyx_v_i;
              __pyx_t_156 = __pyx_v_t;
              __pyx_t_157 = __pyx_v_f;
              __pyx_t_158 = __pyx_v_ab;
              __pyx_t_159 = __pyx_v_aa;
              __pyx_t_160 = 1;
              __pyx_t_161 = 1;
              __pyx_t_51 = __Pyx_c_conjf((*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_154, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_155, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_156, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_157, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_158, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_159, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_160, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_161, __pyx_pybuffernd_jh.diminfo[7].strides)));
              __pyx_t_162 = __pyx_v_i;
              __pyx_t_163 = __pyx_v_t;
              __pyx_t_164 = __pyx_v_f;
              __pyx_t_165 = __pyx_v_aa;
              __pyx_t_166 = __pyx_v_ab;
              __pyx_t_167 = __pyx_v_d;
              __pyx_t_168 = __pyx_v_i;
              __pyx_t_169 = __pyx_v_t;
              __pyx_t_170 = __pyx_v_f;
              __pyx_t_171 = __pyx_v_ab;
              __pyx_t_172 = __pyx_v_aa;
              __pyx_t_173 = 1;
              __pyx_t_174 = 0;
              __pyx_t_65 = (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_167, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_168, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_169, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_170, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_171, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_172, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_173, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_174, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_154 = __pyx_v_d;
              __pyx_t_155 = __pyx_v_i;
              __pyx_t_156 = __pyx_v_t;
              __pyx_t_157 = __pyx_v_f;
              __pyx_t_158 = __pyx_v_ab;
              __pyx_t_159 = __pyx_v_aa;
              __pyx_t_160 = 1;
              __pyx_t_161 = 1;
              __pyx_t_51 = __Pyx_c_conj((*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_154, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_155, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_156, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_157, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_158, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_159, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_160, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_161, __pyx_pybuffernd_jh.diminfo[7].strides)));
              __pyx_t_162 = __pyx_v_i;
              __pyx_t_163 = __pyx_v_t;
              __pyx_t_164 = __pyx_v_f;
              __pyx_t_165 = __pyx_v_aa;
              __pyx_t_166 = __pyx_v_ab;
              __pyx_t_167 = __pyx_v_d;
              __pyx_t_168 = __pyx_v_i;
              __pyx_t_169 = __pyx_v_t;
              __pyx_t_170 = __pyx_v_f;
              __pyx_t_171 = __pyx_v_ab;
              __pyx_t_172 = __pyx_v_aa;
              __pyx_t_173 = 1;
              __pyx_t_174 = 0;
              __pyx_t_65 = (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_167, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_168, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_169, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_170, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_171, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_172, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_173, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_174, __pyx_pybuffernd_jh.diminfo[7].strides));
</pre><pre class="cython line score-0">&#xA0;<span class="">204</span>: </pre>
<pre class="cython line score-4" onclick='toggleDiv(this)'>+<span class="">205</span>:                             jhwj[d,rr,rc,aa,1,1] = jhwj[d,rr,rc,aa,1,1] + \</pre>
<pre class='cython code score-4 '>              __pyx_t_181 = __pyx_v_d;
              __pyx_t_182 = __pyx_v_rr;
              __pyx_t_183 = __pyx_v_rc;
              __pyx_t_184 = __pyx_v_aa;
              __pyx_t_185 = 1;
              __pyx_t_186 = 1;
              __pyx_t_65 = (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_181, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_182, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_183, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_184, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_185, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_186, __pyx_pybuffernd_jhwj.diminfo[5].strides));
/* … */
              __pyx_t_229 = __pyx_v_d;
              __pyx_t_230 = __pyx_v_rr;
              __pyx_t_231 = __pyx_v_rc;
              __pyx_t_232 = __pyx_v_aa;
              __pyx_t_233 = 1;
              __pyx_t_234 = 1;
              *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_229, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_230, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_231, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_232, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_233, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_234, __pyx_pybuffernd_jhwj.diminfo[5].strides) = __pyx_t_float_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_66), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_66));
            }
          }
        }
      }
    }
  }
/* … */
              __pyx_t_181 = __pyx_v_d;
              __pyx_t_182 = __pyx_v_rr;
              __pyx_t_183 = __pyx_v_rc;
              __pyx_t_184 = __pyx_v_aa;
              __pyx_t_185 = 1;
              __pyx_t_186 = 1;
              __pyx_t_65 = (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_181, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_182, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_183, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_184, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_185, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_186, __pyx_pybuffernd_jhwj.diminfo[5].strides));
/* … */
              __pyx_t_229 = __pyx_v_d;
              __pyx_t_230 = __pyx_v_rr;
              __pyx_t_231 = __pyx_v_rc;
              __pyx_t_232 = __pyx_v_aa;
              __pyx_t_233 = 1;
              __pyx_t_234 = 1;
              *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_229, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_230, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_231, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_232, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_233, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_234, __pyx_pybuffernd_jhwj.diminfo[5].strides) = __pyx_t_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_66), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_66));
            }
          }
        }
      }
    }
  }
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">206</span>:                             jh[d,i,t,f,ab,aa,0,1].conjugate()*w[i,t,f,aa,ab]*jh[d,i,t,f,ab,aa,0,1] + \</pre>
<pre class='cython code score-20 '>              __pyx_t_187 = __pyx_v_d;
              __pyx_t_188 = __pyx_v_i;
              __pyx_t_189 = __pyx_v_t;
              __pyx_t_190 = __pyx_v_f;
              __pyx_t_191 = __pyx_v_ab;
              __pyx_t_192 = __pyx_v_aa;
              __pyx_t_193 = 0;
              __pyx_t_194 = 1;
              __pyx_t_51 = __Pyx_c_conjf((*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_187, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_188, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_189, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_190, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_191, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_192, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_193, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_194, __pyx_pybuffernd_jh.diminfo[7].strides)));
              __pyx_t_195 = __pyx_v_i;
              __pyx_t_196 = __pyx_v_t;
              __pyx_t_197 = __pyx_v_f;
              __pyx_t_198 = __pyx_v_aa;
              __pyx_t_199 = __pyx_v_ab;
              __pyx_t_200 = __pyx_v_d;
              __pyx_t_201 = __pyx_v_i;
              __pyx_t_202 = __pyx_v_t;
              __pyx_t_203 = __pyx_v_f;
              __pyx_t_204 = __pyx_v_ab;
              __pyx_t_205 = __pyx_v_aa;
              __pyx_t_206 = 0;
              __pyx_t_207 = 1;
              __pyx_t_42 = (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_200, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_201, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_202, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_203, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_204, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_205, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_206, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_207, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_66 = __Pyx_c_sum_npy_double(__Pyx_c_sum_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_65), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_65)), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_51), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_51)), __pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_195, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_196, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_197, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_198, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_199, __pyx_pybuffernd_w.diminfo[4].strides)), 0)), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_42), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_42)))), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_28), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_28)), __pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_216, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_217, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_218, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_219, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_220, __pyx_pybuffernd_w.diminfo[4].strides)), 0)), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_19), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_19))));
/* … */
              __pyx_t_187 = __pyx_v_d;
              __pyx_t_188 = __pyx_v_i;
              __pyx_t_189 = __pyx_v_t;
              __pyx_t_190 = __pyx_v_f;
              __pyx_t_191 = __pyx_v_ab;
              __pyx_t_192 = __pyx_v_aa;
              __pyx_t_193 = 0;
              __pyx_t_194 = 1;
              __pyx_t_51 = __Pyx_c_conj((*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_187, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_188, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_189, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_190, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_191, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_192, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_193, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_194, __pyx_pybuffernd_jh.diminfo[7].strides)));
              __pyx_t_195 = __pyx_v_i;
              __pyx_t_196 = __pyx_v_t;
              __pyx_t_197 = __pyx_v_f;
              __pyx_t_198 = __pyx_v_aa;
              __pyx_t_199 = __pyx_v_ab;
              __pyx_t_200 = __pyx_v_d;
              __pyx_t_201 = __pyx_v_i;
              __pyx_t_202 = __pyx_v_t;
              __pyx_t_203 = __pyx_v_f;
              __pyx_t_204 = __pyx_v_ab;
              __pyx_t_205 = __pyx_v_aa;
              __pyx_t_206 = 0;
              __pyx_t_207 = 1;
              __pyx_t_42 = (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_200, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_201, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_202, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_203, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_204, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_205, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_206, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_207, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_66 = __Pyx_c_sum_npy_double(__Pyx_c_sum_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_65), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_65)), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_51), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_51)), __pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_195, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_196, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_197, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_198, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_199, __pyx_pybuffernd_w.diminfo[4].strides)), 0)), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_42), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_42)))), __Pyx_c_prod_npy_double(__Pyx_c_prod_npy_double(__pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_28), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_28)), __pyx_t_npy_double_complex_from_parts((*__Pyx_BufPtrStrided5d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.buf, __pyx_t_216, __pyx_pybuffernd_w.diminfo[0].strides, __pyx_t_217, __pyx_pybuffernd_w.diminfo[1].strides, __pyx_t_218, __pyx_pybuffernd_w.diminfo[2].strides, __pyx_t_219, __pyx_pybuffernd_w.diminfo[3].strides, __pyx_t_220, __pyx_pybuffernd_w.diminfo[4].strides)), 0)), __pyx_t_npy_double_complex_from_parts(<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_t_19), <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_t_19))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">207</span>:                             jh[d,i,t,f,ab,aa,1,1].conjugate()*w[i,t,f,aa,ab]*jh[d,i,t,f,ab,aa,1,1]</pre>
<pre class='cython code score-0 '>              __pyx_t_208 = __pyx_v_d;
              __pyx_t_209 = __pyx_v_i;
              __pyx_t_210 = __pyx_v_t;
              __pyx_t_211 = __pyx_v_f;
              __pyx_t_212 = __pyx_v_ab;
              __pyx_t_213 = __pyx_v_aa;
              __pyx_t_214 = 1;
              __pyx_t_215 = 1;
              __pyx_t_28 = __Pyx_c_conjf((*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_208, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_209, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_210, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_211, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_212, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_213, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_214, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_215, __pyx_pybuffernd_jh.diminfo[7].strides)));
              __pyx_t_216 = __pyx_v_i;
              __pyx_t_217 = __pyx_v_t;
              __pyx_t_218 = __pyx_v_f;
              __pyx_t_219 = __pyx_v_aa;
              __pyx_t_220 = __pyx_v_ab;
              __pyx_t_221 = __pyx_v_d;
              __pyx_t_222 = __pyx_v_i;
              __pyx_t_223 = __pyx_v_t;
              __pyx_t_224 = __pyx_v_f;
              __pyx_t_225 = __pyx_v_ab;
              __pyx_t_226 = __pyx_v_aa;
              __pyx_t_227 = 1;
              __pyx_t_228 = 1;
              __pyx_t_19 = (*__Pyx_BufPtrStrided8d(__pyx_t_float_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_221, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_222, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_223, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_224, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_225, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_226, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_227, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_228, __pyx_pybuffernd_jh.diminfo[7].strides));
/* … */
              __pyx_t_208 = __pyx_v_d;
              __pyx_t_209 = __pyx_v_i;
              __pyx_t_210 = __pyx_v_t;
              __pyx_t_211 = __pyx_v_f;
              __pyx_t_212 = __pyx_v_ab;
              __pyx_t_213 = __pyx_v_aa;
              __pyx_t_214 = 1;
              __pyx_t_215 = 1;
              __pyx_t_28 = __Pyx_c_conj((*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_208, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_209, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_210, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_211, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_212, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_213, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_214, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_215, __pyx_pybuffernd_jh.diminfo[7].strides)));
              __pyx_t_216 = __pyx_v_i;
              __pyx_t_217 = __pyx_v_t;
              __pyx_t_218 = __pyx_v_f;
              __pyx_t_219 = __pyx_v_aa;
              __pyx_t_220 = __pyx_v_ab;
              __pyx_t_221 = __pyx_v_d;
              __pyx_t_222 = __pyx_v_i;
              __pyx_t_223 = __pyx_v_t;
              __pyx_t_224 = __pyx_v_f;
              __pyx_t_225 = __pyx_v_ab;
              __pyx_t_226 = __pyx_v_aa;
              __pyx_t_227 = 1;
              __pyx_t_228 = 1;
              __pyx_t_19 = (*__Pyx_BufPtrStrided8d(__pyx_t_double_complex *, __pyx_pybuffernd_jh.rcbuffer-&gt;pybuffer.buf, __pyx_t_221, __pyx_pybuffernd_jh.diminfo[0].strides, __pyx_t_222, __pyx_pybuffernd_jh.diminfo[1].strides, __pyx_t_223, __pyx_pybuffernd_jh.diminfo[2].strides, __pyx_t_224, __pyx_pybuffernd_jh.diminfo[3].strides, __pyx_t_225, __pyx_pybuffernd_jh.diminfo[4].strides, __pyx_t_226, __pyx_pybuffernd_jh.diminfo[5].strides, __pyx_t_227, __pyx_pybuffernd_jh.diminfo[6].strides, __pyx_t_228, __pyx_pybuffernd_jh.diminfo[7].strides));
</pre><pre class="cython line score-0">&#xA0;<span class="">208</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">209</span>: @cython.cdivision(True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">210</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">211</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">212</span>: @cython.nonecheck(False)</pre>
<pre class="cython line score-559" onclick='toggleDiv(this)'>+<span class="">213</span>: def cycompute_jhwjinv(np.ndarray[complex3264, ndim=6] jhwj,</pre>
<pre class='cython code score-559 '>/* Python wrapper */
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_9cycompute_jhwjinv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_8cycompute_jhwjinv[] = "\n    This inverts the approximation to the Hessian, jhwj. Note that as a useful side effect, it is \n    also suitable for inverting the gains.\n    ";
static PyMethodDef __pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_9cycompute_jhwjinv = {"cycompute_jhwjinv", (PyCFunction)__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_9cycompute_jhwjinv, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_8cycompute_jhwjinv};
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_9cycompute_jhwjinv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_signatures = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED PyObject *__pyx_v_defaults = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fused_cpdef (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_signatures,&amp;__pyx_n_s_args,&amp;__pyx_n_s_kwargs,&amp;__pyx_n_s_defaults,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_signatures)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_args)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_kwargs)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_defaults)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_fused_cpdef") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_signatures = values[0];
    __pyx_v_args = values[1];
    __pyx_v_kwargs = values[2];
    __pyx_v_defaults = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_8cycompute_jhwjinv(__pyx_self, __pyx_v_signatures, __pyx_v_args, __pyx_v_kwargs, __pyx_v_defaults);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_8cycompute_jhwjinv(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_signatures, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs, CYTHON_UNUSED PyObject *__pyx_v_defaults) {
  PyObject *__pyx_v_dest_sig = NULL;
  PyTypeObject *__pyx_v_ndarray = 0;
  PyObject *__pyx_v_numpy = NULL;
  __Pyx_memviewslice __pyx_v_memslice;
  Py_ssize_t __pyx_v_itemsize;
  CYTHON_UNUSED int __pyx_v_dtype_signed;
  char __pyx_v_kind;
  PyObject *__pyx_v_arg = NULL;
  PyObject *__pyx_v_dtype = NULL;
  PyObject *__pyx_v_arg_base = NULL;
  PyObject *__pyx_v_candidates = NULL;
  PyObject *__pyx_v_sig = NULL;
  int __pyx_v_match_found;
  PyObject *__pyx_v_src_type = NULL;
  PyObject *__pyx_v_dst_type = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_jhwjinv", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kwargs);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, Py_None);
  __pyx_v_dest_sig = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_2 = (__pyx_v_kwargs == Py_None);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kwargs, __pyx_t_1);
    __pyx_t_1 = 0;
  }
  {
    /*try:*/ {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_v_numpy = __pyx_t_1;
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_numpy, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!(likely(<span class='py_c_api'>PyType_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "type", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      __pyx_v_ndarray = ((PyTypeObject*)__pyx_t_1);
      __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L11_try_end;
    __pyx_L4_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_ImportError) || <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_AttributeError) || <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_TypeError);
    if (__pyx_t_7) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_1, &amp;__pyx_t_8, &amp;__pyx_t_9) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L6_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ndarray, ((PyTypeObject*)Py_None));
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L5_exception_handled;
    }
    goto __pyx_L6_except_error;
    __pyx_L6_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    goto __pyx_L1_error;
    __pyx_L5_exception_handled:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    __pyx_L11_try_end:;
  }
  __pyx_v_itemsize = -1L;
  if (unlikely(__pyx_v_args == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = ((0 &lt; __pyx_t_10) != 0);
  if (__pyx_t_3) {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(((PyObject*)__pyx_v_args), 0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
    __pyx_v_arg = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L14;
  }
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyDict_ContainsTF</span>(__pyx_n_s_jhwj, ((PyObject*)__pyx_v_kwargs), Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {
    if (unlikely(__pyx_v_kwargs == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_kwargs), __pyx_n_s_jhwj);<span class='error_goto'> if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_v_arg = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L14;
  }
  /*else*/ {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_Expected_at_least_d_arguments, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_L14:;
  while (1) {
    __pyx_t_2 = (__pyx_v_ndarray != ((PyTypeObject*)Py_None));
    __pyx_t_3 = (__pyx_t_2 != 0);
    if (__pyx_t_3) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_arg, __pyx_v_ndarray); 
      __pyx_t_2 = (__pyx_t_3 != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_v_dtype = __pyx_t_8;
        __pyx_t_8 = 0;
        goto __pyx_L18;
      }
      __pyx_t_2 = (__pyx_memoryview_check(__pyx_v_arg) != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_base);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_v_arg_base = __pyx_t_8;
        __pyx_t_8 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_arg_base, __pyx_v_ndarray); 
        __pyx_t_3 = (__pyx_t_2 != 0);
        if (__pyx_t_3) {
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg_base, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_v_dtype = __pyx_t_8;
          __pyx_t_8 = 0;
          goto __pyx_L19;
        }
        /*else*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
          __pyx_v_dtype = Py_None;
        }
        __pyx_L19:;
        goto __pyx_L18;
      }
      /*else*/ {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
        __pyx_v_dtype = Py_None;
      }
      __pyx_L18:;
      __pyx_v_itemsize = -1L;
      __pyx_t_3 = (__pyx_v_dtype != Py_None);
      __pyx_t_2 = (__pyx_t_3 != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dtype, __pyx_n_s_itemsize);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_itemsize = __pyx_t_10;
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dtype, __pyx_n_s_kind);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Ord</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(__pyx_t_11 == (long)(Py_UCS4)-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_kind = __pyx_t_11;
        __pyx_v_dtype_signed = (__pyx_v_kind == 'i');
        switch (__pyx_v_kind) {
          case 'i':
          case 'u':
          break;
          case 'f':
          break;
          case 'c':
          __pyx_t_3 = (((sizeof(__pyx_t_float_complex)) == __pyx_v_itemsize) != 0);
          if (__pyx_t_3) {
          } else {
            __pyx_t_2 = __pyx_t_3;
            goto __pyx_L22_bool_binop_done;
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_3 = ((((Py_ssize_t)__pyx_t_10) == 6) != 0);
          __pyx_t_2 = __pyx_t_3;
          __pyx_L22_bool_binop_done:;
          if (__pyx_t_2) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            goto __pyx_L16_break;
          }
          __pyx_t_3 = (((sizeof(__pyx_t_double_complex)) == __pyx_v_itemsize) != 0);
          if (__pyx_t_3) {
          } else {
            __pyx_t_2 = __pyx_t_3;
            goto __pyx_L25_bool_binop_done;
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_3 = ((((Py_ssize_t)__pyx_t_10) == 6) != 0);
          __pyx_t_2 = __pyx_t_3;
          __pyx_L25_bool_binop_done:;
          if (__pyx_t_2) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            goto __pyx_L16_break;
          }
          break;
          case 'O':
          break;
          default: break;
        }
      }
    }
    __pyx_t_3 = ((__pyx_v_itemsize == -1L) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L28_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_itemsize == (sizeof(__pyx_t_float_complex))) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L28_bool_binop_done:;
    if (__pyx_t_2) {
      __pyx_v_memslice = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsdsds___pyx_t_float_complex</span>(__pyx_v_arg);
      __pyx_t_2 = (__pyx_v_memslice.memview != 0);
      if (__pyx_t_2) {
        __PYX_XDEC_MEMVIEW((&amp;__pyx_v_memslice), 1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L16_break;
      }
      /*else*/ {
        <span class='py_c_api'>PyErr_Clear</span>();
      }
    }
    __pyx_t_3 = ((__pyx_v_itemsize == -1L) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L32_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_itemsize == (sizeof(__pyx_t_double_complex))) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L32_bool_binop_done:;
    if (__pyx_t_2) {
      __pyx_v_memslice = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsdsds___pyx_t_double_complex</span>(__pyx_v_arg);
      __pyx_t_2 = (__pyx_v_memslice.memview != 0);
      if (__pyx_t_2) {
        __PYX_XDEC_MEMVIEW((&amp;__pyx_v_memslice), 1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L16_break;
      }
      /*else*/ {
        <span class='py_c_api'>PyErr_Clear</span>();
      }
    }
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, Py_None, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L16_break;
  }
  __pyx_L16_break:;
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_v_candidates = ((PyObject*)__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_10 = 0;
  if (unlikely(__pyx_v_signatures == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_9 = __Pyx_dict_iterator(((PyObject*)__pyx_v_signatures), 1, ((PyObject *)NULL), (&amp;__pyx_t_12), (&amp;__pyx_t_7));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __pyx_t_8 = __pyx_t_9;
  __pyx_t_9 = 0;
  while (1) {
    __pyx_t_13 = __Pyx_dict_iter_next(__pyx_t_8, __pyx_t_12, &amp;__pyx_t_10, &amp;__pyx_t_9, NULL, NULL, __pyx_t_7);
    if (unlikely(__pyx_t_13 == 0)) break;
    if (unlikely(__pyx_t_13 == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_sig, __pyx_t_9);
    __pyx_t_9 = 0;
    __pyx_v_match_found = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_sig, __pyx_n_s_strip);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__19, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_split);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__19 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_);<span class='error_goto'> if (unlikely(!__pyx_tuple__19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__19);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__20, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dest_sig);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dest_sig);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_dest_sig);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_9 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_14 = 0;
      __pyx_t_15 = NULL;
    } else {
      __pyx_t_14 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_15 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_15)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_15(__pyx_t_9);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        PyObject* sequence = __pyx_t_1;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_16 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_17 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_16 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_17 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
        #else
        __pyx_t_16 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        __pyx_t_17 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_18 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_19 = Py_TYPE(__pyx_t_18)-&gt;tp_iternext;
        index = 0; __pyx_t_16 = __pyx_t_19(__pyx_t_18); if (unlikely(!__pyx_t_16)) goto __pyx_L39_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        index = 1; __pyx_t_17 = __pyx_t_19(__pyx_t_18); if (unlikely(!__pyx_t_17)) goto __pyx_L39_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_19(__pyx_t_18), 2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_19 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        goto __pyx_L40_unpacking_done;
        __pyx_L39_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_t_19 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_L40_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_src_type, __pyx_t_16);
      __pyx_t_16 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dst_type, __pyx_t_17);
      __pyx_t_17 = 0;
      __pyx_t_2 = (__pyx_v_dst_type != Py_None);
      __pyx_t_3 = (__pyx_t_2 != 0);
      if (__pyx_t_3) {
        __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_src_type, __pyx_v_dst_type, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (__pyx_t_3) {
          __pyx_v_match_found = 1;
          goto __pyx_L42;
        }
        /*else*/ {
          __pyx_v_match_found = 0;
          goto __pyx_L38_break;
        }
        __pyx_L42:;
      }
    }
    __pyx_L38_break:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_3 = (__pyx_v_match_found != 0);
    if (__pyx_t_3) {
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_candidates, __pyx_v_sig);<span class='error_goto'> if (unlikely(__pyx_t_20 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_3 = (__pyx_v_candidates != Py_None) &amp;&amp; (<span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates) != 0);
  __pyx_t_2 = ((!__pyx_t_3) != 0);
  if (__pyx_t_2) {
  __pyx_tuple__20 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s__3);<span class='error_goto'> if (unlikely(!__pyx_tuple__20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__20);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__21, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_12 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates);<span class='error_goto'> if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = ((__pyx_t_12 &gt; 1) != 0);
  if (__pyx_t_2) {
  __pyx_tuple__21 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_No_matching_signature_found);<span class='error_goto'> if (unlikely(!__pyx_tuple__21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__21);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__22, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(__pyx_v_signatures == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_signatures), <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_candidates, 0));<span class='error_goto'> if (unlikely(__pyx_t_8 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_r = __pyx_t_8;
    __pyx_t_8 = 0;
    goto __pyx_L0;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dest_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_numpy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dtype);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg_base);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_candidates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_src_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dst_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_41cycompute_jhwjinv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_fuse_0__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_41cycompute_jhwjinv = {"__pyx_fuse_0cycompute_jhwjinv", (PyCFunction)__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_41cycompute_jhwjinv, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_8cycompute_jhwjinv};
static PyObject *__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_41cycompute_jhwjinv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_jhwj = 0;
  PyArrayObject *__pyx_v_jhwjinv = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_jhwjinv (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_jhwj,&amp;__pyx_n_s_jhwjinv,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jhwj)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jhwjinv)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwjinv", 1, 2, 2, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cycompute_jhwjinv") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_jhwj = ((PyArrayObject *)values[0]);
    __pyx_v_jhwjinv = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwjinv", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_jhwjinv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jhwj), __pyx_ptype_5numpy_ndarray, 1, "jhwj", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jhwjinv), __pyx_ptype_5numpy_ndarray, 1, "jhwjinv", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_40cycompute_jhwjinv(__pyx_self, __pyx_v_jhwj, __pyx_v_jhwjinv);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_40cycompute_jhwjinv(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_jhwj, PyArrayObject *__pyx_v_jhwjinv) {
  int __pyx_v_d;
  int __pyx_v_t;
  int __pyx_v_f;
  int __pyx_v_aa;
  CYTHON_UNUSED int __pyx_v_ab;
  int __pyx_v_n_dir;
  int __pyx_v_n_tim;
  int __pyx_v_n_fre;
  int __pyx_v_n_ant;
  __pyx_t_float_complex __pyx_v_denom;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jhwj;
  __Pyx_Buffer __pyx_pybuffer_jhwj;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jhwjinv;
  __Pyx_Buffer __pyx_pybuffer_jhwjinv;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_0cycompute_jhwjinv", 0);
  __pyx_pybuffer_jhwj.pybuffer.buf = NULL;
  __pyx_pybuffer_jhwj.refcount = 0;
  __pyx_pybuffernd_jhwj.data = NULL;
  __pyx_pybuffernd_jhwj.rcbuffer = &amp;__pyx_pybuffer_jhwj;
  __pyx_pybuffer_jhwjinv.pybuffer.buf = NULL;
  __pyx_pybuffer_jhwjinv.refcount = 0;
  __pyx_pybuffernd_jhwjinv.data = NULL;
  __pyx_pybuffernd_jhwjinv.rcbuffer = &amp;__pyx_pybuffer_jhwjinv;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jhwj, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jhwj.diminfo[0].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jhwj.diminfo[0].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jhwj.diminfo[1].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jhwj.diminfo[1].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jhwj.diminfo[2].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jhwj.diminfo[2].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jhwj.diminfo[3].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jhwj.diminfo[3].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jhwj.diminfo[4].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jhwj.diminfo[4].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jhwj.diminfo[5].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jhwj.diminfo[5].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jhwjinv, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jhwjinv.diminfo[0].strides = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jhwjinv.diminfo[0].shape = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jhwjinv.diminfo[1].strides = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jhwjinv.diminfo[1].shape = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jhwjinv.diminfo[2].strides = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jhwjinv.diminfo[2].shape = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jhwjinv.diminfo[3].strides = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jhwjinv.diminfo[3].shape = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jhwjinv.diminfo[4].strides = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jhwjinv.diminfo[4].shape = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jhwjinv.diminfo[5].strides = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jhwjinv.diminfo[5].shape = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.shape[5];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_jhwjinv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_43cycompute_jhwjinv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_fuse_1__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_43cycompute_jhwjinv = {"__pyx_fuse_1cycompute_jhwjinv", (PyCFunction)__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_43cycompute_jhwjinv, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_8cycompute_jhwjinv};
static PyObject *__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_43cycompute_jhwjinv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_jhwj = 0;
  PyArrayObject *__pyx_v_jhwjinv = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_jhwjinv (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_jhwj,&amp;__pyx_n_s_jhwjinv,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jhwj)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jhwjinv)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwjinv", 1, 2, 2, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cycompute_jhwjinv") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_jhwj = ((PyArrayObject *)values[0]);
    __pyx_v_jhwjinv = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_jhwjinv", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_jhwjinv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jhwj), __pyx_ptype_5numpy_ndarray, 1, "jhwj", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jhwjinv), __pyx_ptype_5numpy_ndarray, 1, "jhwjinv", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_42cycompute_jhwjinv(__pyx_self, __pyx_v_jhwj, __pyx_v_jhwjinv);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_42cycompute_jhwjinv(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_jhwj, PyArrayObject *__pyx_v_jhwjinv) {
  int __pyx_v_d;
  int __pyx_v_t;
  int __pyx_v_f;
  int __pyx_v_aa;
  CYTHON_UNUSED int __pyx_v_ab;
  int __pyx_v_n_dir;
  int __pyx_v_n_tim;
  int __pyx_v_n_fre;
  int __pyx_v_n_ant;
  __pyx_t_double_complex __pyx_v_denom;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jhwj;
  __Pyx_Buffer __pyx_pybuffer_jhwj;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jhwjinv;
  __Pyx_Buffer __pyx_pybuffer_jhwjinv;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_1cycompute_jhwjinv", 0);
  __pyx_pybuffer_jhwj.pybuffer.buf = NULL;
  __pyx_pybuffer_jhwj.refcount = 0;
  __pyx_pybuffernd_jhwj.data = NULL;
  __pyx_pybuffernd_jhwj.rcbuffer = &amp;__pyx_pybuffer_jhwj;
  __pyx_pybuffer_jhwjinv.pybuffer.buf = NULL;
  __pyx_pybuffer_jhwjinv.refcount = 0;
  __pyx_pybuffernd_jhwjinv.data = NULL;
  __pyx_pybuffernd_jhwjinv.rcbuffer = &amp;__pyx_pybuffer_jhwjinv;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jhwj, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jhwj.diminfo[0].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jhwj.diminfo[0].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jhwj.diminfo[1].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jhwj.diminfo[1].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jhwj.diminfo[2].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jhwj.diminfo[2].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jhwj.diminfo[3].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jhwj.diminfo[3].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jhwj.diminfo[4].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jhwj.diminfo[4].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jhwj.diminfo[5].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jhwj.diminfo[5].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jhwjinv, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jhwjinv.diminfo[0].strides = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jhwjinv.diminfo[0].shape = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jhwjinv.diminfo[1].strides = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jhwjinv.diminfo[1].shape = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jhwjinv.diminfo[2].strides = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jhwjinv.diminfo[2].shape = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jhwjinv.diminfo[3].strides = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jhwjinv.diminfo[3].shape = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jhwjinv.diminfo[4].strides = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jhwjinv.diminfo[4].shape = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jhwjinv.diminfo[5].strides = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jhwjinv.diminfo[5].shape = __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.shape[5];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_jhwjinv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
  __pyx_tuple__22 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Function_call_with_ambiguous_arg);<span class='error_goto'> if (unlikely(!__pyx_tuple__22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__22);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__22);
/* … */
  __pyx_tuple__66 = <span class='py_c_api'>PyTuple_Pack</span>(12, __pyx_n_s_jhwj, __pyx_n_s_jhwjinv, __pyx_n_s_d, __pyx_n_s_t, __pyx_n_s_f, __pyx_n_s_aa, __pyx_n_s_ab, __pyx_n_s_n_dir, __pyx_n_s_n_tim, __pyx_n_s_n_fre, __pyx_n_s_n_ant, __pyx_n_s_denom);<span class='error_goto'> if (unlikely(!__pyx_tuple__66)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__66);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__66);
/* … */
  __pyx_t_9 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = __pyx_FusedFunction_NewEx(&amp;__pyx_fuse_0__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_41cycompute_jhwjinv, 0, __pyx_n_s_cycompute_jhwjinv, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__67));<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_10, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_kp_s_float_complex, __pyx_t_10) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = __pyx_FusedFunction_NewEx(&amp;__pyx_fuse_1__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_43cycompute_jhwjinv, 0, __pyx_n_s_cycompute_jhwjinv, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__67));<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_10, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_kp_s_double_complex, __pyx_t_10) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = __pyx_FusedFunction_NewEx(&amp;__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_9cycompute_jhwjinv, 0, __pyx_n_s_cycompute_jhwjinv, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__67));<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_10, __pyx_empty_tuple);
  ((__pyx_FusedFunctionObject *) __pyx_t_10)-&gt;__signatures__ = __pyx_t_9;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_cycompute_jhwjinv, __pyx_t_10) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_codeobj__67 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 12, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__66, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_ulrich_CubeCal_cubecal_ker, __pyx_n_s_cycompute_jhwjinv, 213, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__67)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">214</span>:                      np.ndarray[complex3264, ndim=6] jhwjinv):</pre>
<pre class="cython line score-0">&#xA0;<span class="">215</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">216</span>:     This inverts the approximation to the Hessian, jhwj. Note that as a useful side effect, it is</pre>
<pre class="cython line score-0">&#xA0;<span class="">217</span>:     also suitable for inverting the gains.</pre>
<pre class="cython line score-0">&#xA0;<span class="">218</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">219</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">220</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">221</span>:     cdef int d, t, f, aa, ab = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_ab = 0;
/* … */
  __pyx_v_ab = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">222</span>:     cdef int n_dir, n_tim, n_fre, n_ant</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">223</span>:     cdef complex3264 denom = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_denom = __pyx_t_float_complex_from_parts(0, 0);
/* … */
  __pyx_v_denom = __pyx_t_double_complex_from_parts(0, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">224</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">225</span>:     n_dir = jhwj.shape[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_dir = (__pyx_v_jhwj-&gt;dimensions[0]);
/* … */
  __pyx_v_n_dir = (__pyx_v_jhwj-&gt;dimensions[0]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">226</span>:     n_tim = jhwj.shape[1]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_tim = (__pyx_v_jhwj-&gt;dimensions[1]);
/* … */
  __pyx_v_n_tim = (__pyx_v_jhwj-&gt;dimensions[1]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">227</span>:     n_fre = jhwj.shape[2]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_fre = (__pyx_v_jhwj-&gt;dimensions[2]);
/* … */
  __pyx_v_n_fre = (__pyx_v_jhwj-&gt;dimensions[2]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">228</span>:     n_ant = jhwj.shape[3]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_ant = (__pyx_v_jhwj-&gt;dimensions[3]);
/* … */
  __pyx_v_n_ant = (__pyx_v_jhwj-&gt;dimensions[3]);
</pre><pre class="cython line score-0">&#xA0;<span class="">229</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">230</span>:     for d in xrange(n_dir):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_n_dir;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
/* … */
  __pyx_t_1 = __pyx_v_n_dir;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">231</span>:         for t in xrange(n_tim):</pre>
<pre class='cython code score-0 '>    __pyx_t_3 = __pyx_v_n_tim;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_t = __pyx_t_4;
/* … */
    __pyx_t_3 = __pyx_v_n_tim;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_t = __pyx_t_4;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">232</span>:             for f in xrange(n_fre):</pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_n_fre;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_f = __pyx_t_6;
/* … */
      __pyx_t_5 = __pyx_v_n_fre;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_f = __pyx_t_6;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">233</span>:                 for aa in xrange(n_ant):</pre>
<pre class='cython code score-0 '>        __pyx_t_7 = __pyx_v_n_ant;
        for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_aa = __pyx_t_8;
/* … */
        __pyx_t_7 = __pyx_v_n_ant;
        for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_aa = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">234</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">235</span>:                     denom = jhwj[d,t,f,aa,0,0] * jhwj[d,t,f,aa,1,1] - \</pre>
<pre class='cython code score-0 '>          __pyx_t_9 = __pyx_v_d;
          __pyx_t_10 = __pyx_v_t;
          __pyx_t_11 = __pyx_v_f;
          __pyx_t_12 = __pyx_v_aa;
          __pyx_t_13 = 0;
          __pyx_t_14 = 0;
          __pyx_t_15 = __pyx_v_d;
          __pyx_t_16 = __pyx_v_t;
          __pyx_t_17 = __pyx_v_f;
          __pyx_t_18 = __pyx_v_aa;
          __pyx_t_19 = 1;
          __pyx_t_20 = 1;
/* … */
          __pyx_v_denom = __Pyx_c_difff(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_11, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_12, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_13, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_14, __pyx_pybuffernd_jhwj.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_17, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_18, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_19, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_20, __pyx_pybuffernd_jhwj.diminfo[5].strides))), __Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_23, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_24, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_25, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_26, __pyx_pybuffernd_jhwj.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_28, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_29, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_30, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_31, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_32, __pyx_pybuffernd_jhwj.diminfo[5].strides))));
/* … */
          __pyx_t_9 = __pyx_v_d;
          __pyx_t_10 = __pyx_v_t;
          __pyx_t_11 = __pyx_v_f;
          __pyx_t_12 = __pyx_v_aa;
          __pyx_t_13 = 0;
          __pyx_t_14 = 0;
          __pyx_t_15 = __pyx_v_d;
          __pyx_t_16 = __pyx_v_t;
          __pyx_t_17 = __pyx_v_f;
          __pyx_t_18 = __pyx_v_aa;
          __pyx_t_19 = 1;
          __pyx_t_20 = 1;
/* … */
          __pyx_v_denom = __Pyx_c_diff(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_11, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_12, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_13, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_14, __pyx_pybuffernd_jhwj.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_17, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_18, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_19, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_20, __pyx_pybuffernd_jhwj.diminfo[5].strides))), __Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_23, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_24, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_25, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_26, __pyx_pybuffernd_jhwj.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_28, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_29, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_30, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_31, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_32, __pyx_pybuffernd_jhwj.diminfo[5].strides))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">236</span>:                             jhwj[d,t,f,aa,0,1] * jhwj[d,t,f,aa,1,0]</pre>
<pre class='cython code score-0 '>          __pyx_t_21 = __pyx_v_d;
          __pyx_t_22 = __pyx_v_t;
          __pyx_t_23 = __pyx_v_f;
          __pyx_t_24 = __pyx_v_aa;
          __pyx_t_25 = 0;
          __pyx_t_26 = 1;
          __pyx_t_27 = __pyx_v_d;
          __pyx_t_28 = __pyx_v_t;
          __pyx_t_29 = __pyx_v_f;
          __pyx_t_30 = __pyx_v_aa;
          __pyx_t_31 = 1;
          __pyx_t_32 = 0;
/* … */
          __pyx_t_21 = __pyx_v_d;
          __pyx_t_22 = __pyx_v_t;
          __pyx_t_23 = __pyx_v_f;
          __pyx_t_24 = __pyx_v_aa;
          __pyx_t_25 = 0;
          __pyx_t_26 = 1;
          __pyx_t_27 = __pyx_v_d;
          __pyx_t_28 = __pyx_v_t;
          __pyx_t_29 = __pyx_v_f;
          __pyx_t_30 = __pyx_v_aa;
          __pyx_t_31 = 1;
          __pyx_t_32 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">237</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">238</span>:                     if denom==0:</pre>
<pre class='cython code score-0 '>          __pyx_t_33 = ((__Pyx_c_eqf(__pyx_v_denom, __pyx_t_float_complex_from_parts(0, 0))) != 0);
          if (__pyx_t_33) {
/* … */
          }
/* … */
          __pyx_t_33 = ((__Pyx_c_eq(__pyx_v_denom, __pyx_t_double_complex_from_parts(0, 0))) != 0);
          if (__pyx_t_33) {
/* … */
          }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">239</span>:                         denom = 1</pre>
<pre class='cython code score-0 '>            __pyx_v_denom = __pyx_t_float_complex_from_parts(1, 0);
/* … */
            __pyx_v_denom = __pyx_t_double_complex_from_parts(1, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">240</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">241</span>:                     jhwjinv[d,t,f,aa,0,0] = jhwj[d,t,f,aa,1,1]/denom</pre>
<pre class='cython code score-0 '>          __pyx_t_34 = __pyx_v_d;
          __pyx_t_35 = __pyx_v_t;
          __pyx_t_36 = __pyx_v_f;
          __pyx_t_37 = __pyx_v_aa;
          __pyx_t_38 = 1;
          __pyx_t_39 = 1;
          __pyx_t_40 = __pyx_v_d;
          __pyx_t_41 = __pyx_v_t;
          __pyx_t_42 = __pyx_v_f;
          __pyx_t_43 = __pyx_v_aa;
          __pyx_t_44 = 0;
          __pyx_t_45 = 0;
          *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.buf, __pyx_t_40, __pyx_pybuffernd_jhwjinv.diminfo[0].strides, __pyx_t_41, __pyx_pybuffernd_jhwjinv.diminfo[1].strides, __pyx_t_42, __pyx_pybuffernd_jhwjinv.diminfo[2].strides, __pyx_t_43, __pyx_pybuffernd_jhwjinv.diminfo[3].strides, __pyx_t_44, __pyx_pybuffernd_jhwjinv.diminfo[4].strides, __pyx_t_45, __pyx_pybuffernd_jhwjinv.diminfo[5].strides) = __Pyx_c_quotf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_35, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_36, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_37, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_38, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_39, __pyx_pybuffernd_jhwj.diminfo[5].strides)), __pyx_v_denom);
/* … */
          __pyx_t_34 = __pyx_v_d;
          __pyx_t_35 = __pyx_v_t;
          __pyx_t_36 = __pyx_v_f;
          __pyx_t_37 = __pyx_v_aa;
          __pyx_t_38 = 1;
          __pyx_t_39 = 1;
          __pyx_t_40 = __pyx_v_d;
          __pyx_t_41 = __pyx_v_t;
          __pyx_t_42 = __pyx_v_f;
          __pyx_t_43 = __pyx_v_aa;
          __pyx_t_44 = 0;
          __pyx_t_45 = 0;
          *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.buf, __pyx_t_40, __pyx_pybuffernd_jhwjinv.diminfo[0].strides, __pyx_t_41, __pyx_pybuffernd_jhwjinv.diminfo[1].strides, __pyx_t_42, __pyx_pybuffernd_jhwjinv.diminfo[2].strides, __pyx_t_43, __pyx_pybuffernd_jhwjinv.diminfo[3].strides, __pyx_t_44, __pyx_pybuffernd_jhwjinv.diminfo[4].strides, __pyx_t_45, __pyx_pybuffernd_jhwjinv.diminfo[5].strides) = __Pyx_c_quot((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_35, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_36, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_37, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_38, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_39, __pyx_pybuffernd_jhwj.diminfo[5].strides)), __pyx_v_denom);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">242</span>:                     jhwjinv[d,t,f,aa,1,1] = jhwj[d,t,f,aa,0,0]/denom</pre>
<pre class='cython code score-0 '>          __pyx_t_46 = __pyx_v_d;
          __pyx_t_47 = __pyx_v_t;
          __pyx_t_48 = __pyx_v_f;
          __pyx_t_49 = __pyx_v_aa;
          __pyx_t_50 = 0;
          __pyx_t_51 = 0;
          __pyx_t_52 = __pyx_v_d;
          __pyx_t_53 = __pyx_v_t;
          __pyx_t_54 = __pyx_v_f;
          __pyx_t_55 = __pyx_v_aa;
          __pyx_t_56 = 1;
          __pyx_t_57 = 1;
          *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.buf, __pyx_t_52, __pyx_pybuffernd_jhwjinv.diminfo[0].strides, __pyx_t_53, __pyx_pybuffernd_jhwjinv.diminfo[1].strides, __pyx_t_54, __pyx_pybuffernd_jhwjinv.diminfo[2].strides, __pyx_t_55, __pyx_pybuffernd_jhwjinv.diminfo[3].strides, __pyx_t_56, __pyx_pybuffernd_jhwjinv.diminfo[4].strides, __pyx_t_57, __pyx_pybuffernd_jhwjinv.diminfo[5].strides) = __Pyx_c_quotf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_46, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_47, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_48, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_49, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_50, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_51, __pyx_pybuffernd_jhwj.diminfo[5].strides)), __pyx_v_denom);
/* … */
          __pyx_t_46 = __pyx_v_d;
          __pyx_t_47 = __pyx_v_t;
          __pyx_t_48 = __pyx_v_f;
          __pyx_t_49 = __pyx_v_aa;
          __pyx_t_50 = 0;
          __pyx_t_51 = 0;
          __pyx_t_52 = __pyx_v_d;
          __pyx_t_53 = __pyx_v_t;
          __pyx_t_54 = __pyx_v_f;
          __pyx_t_55 = __pyx_v_aa;
          __pyx_t_56 = 1;
          __pyx_t_57 = 1;
          *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.buf, __pyx_t_52, __pyx_pybuffernd_jhwjinv.diminfo[0].strides, __pyx_t_53, __pyx_pybuffernd_jhwjinv.diminfo[1].strides, __pyx_t_54, __pyx_pybuffernd_jhwjinv.diminfo[2].strides, __pyx_t_55, __pyx_pybuffernd_jhwjinv.diminfo[3].strides, __pyx_t_56, __pyx_pybuffernd_jhwjinv.diminfo[4].strides, __pyx_t_57, __pyx_pybuffernd_jhwjinv.diminfo[5].strides) = __Pyx_c_quot((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_46, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_47, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_48, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_49, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_50, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_51, __pyx_pybuffernd_jhwj.diminfo[5].strides)), __pyx_v_denom);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">243</span>:                     jhwjinv[d,t,f,aa,0,1] = -1 * jhwj[d,t,f,aa,0,1]/denom</pre>
<pre class='cython code score-0 '>          __pyx_t_58 = __pyx_v_d;
          __pyx_t_59 = __pyx_v_t;
          __pyx_t_60 = __pyx_v_f;
          __pyx_t_61 = __pyx_v_aa;
          __pyx_t_62 = 0;
          __pyx_t_63 = 1;
          __pyx_t_64 = __pyx_v_d;
          __pyx_t_65 = __pyx_v_t;
          __pyx_t_66 = __pyx_v_f;
          __pyx_t_67 = __pyx_v_aa;
          __pyx_t_68 = 0;
          __pyx_t_69 = 1;
          *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.buf, __pyx_t_64, __pyx_pybuffernd_jhwjinv.diminfo[0].strides, __pyx_t_65, __pyx_pybuffernd_jhwjinv.diminfo[1].strides, __pyx_t_66, __pyx_pybuffernd_jhwjinv.diminfo[2].strides, __pyx_t_67, __pyx_pybuffernd_jhwjinv.diminfo[3].strides, __pyx_t_68, __pyx_pybuffernd_jhwjinv.diminfo[4].strides, __pyx_t_69, __pyx_pybuffernd_jhwjinv.diminfo[5].strides) = __Pyx_c_quotf(__Pyx_c_prodf(__pyx_t_float_complex_from_parts(-1L, 0), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_58, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_59, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_60, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_61, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_62, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_63, __pyx_pybuffernd_jhwj.diminfo[5].strides))), __pyx_v_denom);
/* … */
          __pyx_t_58 = __pyx_v_d;
          __pyx_t_59 = __pyx_v_t;
          __pyx_t_60 = __pyx_v_f;
          __pyx_t_61 = __pyx_v_aa;
          __pyx_t_62 = 0;
          __pyx_t_63 = 1;
          __pyx_t_64 = __pyx_v_d;
          __pyx_t_65 = __pyx_v_t;
          __pyx_t_66 = __pyx_v_f;
          __pyx_t_67 = __pyx_v_aa;
          __pyx_t_68 = 0;
          __pyx_t_69 = 1;
          *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.buf, __pyx_t_64, __pyx_pybuffernd_jhwjinv.diminfo[0].strides, __pyx_t_65, __pyx_pybuffernd_jhwjinv.diminfo[1].strides, __pyx_t_66, __pyx_pybuffernd_jhwjinv.diminfo[2].strides, __pyx_t_67, __pyx_pybuffernd_jhwjinv.diminfo[3].strides, __pyx_t_68, __pyx_pybuffernd_jhwjinv.diminfo[4].strides, __pyx_t_69, __pyx_pybuffernd_jhwjinv.diminfo[5].strides) = __Pyx_c_quot(__Pyx_c_prod(__pyx_t_double_complex_from_parts(-1L, 0), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_58, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_59, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_60, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_61, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_62, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_63, __pyx_pybuffernd_jhwj.diminfo[5].strides))), __pyx_v_denom);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">244</span>:                     jhwjinv[d,t,f,aa,1,0] = -1 * jhwj[d,t,f,aa,1,0]/denom</pre>
<pre class='cython code score-0 '>          __pyx_t_70 = __pyx_v_d;
          __pyx_t_71 = __pyx_v_t;
          __pyx_t_72 = __pyx_v_f;
          __pyx_t_73 = __pyx_v_aa;
          __pyx_t_74 = 1;
          __pyx_t_75 = 0;
          __pyx_t_76 = __pyx_v_d;
          __pyx_t_77 = __pyx_v_t;
          __pyx_t_78 = __pyx_v_f;
          __pyx_t_79 = __pyx_v_aa;
          __pyx_t_80 = 1;
          __pyx_t_81 = 0;
          *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.buf, __pyx_t_76, __pyx_pybuffernd_jhwjinv.diminfo[0].strides, __pyx_t_77, __pyx_pybuffernd_jhwjinv.diminfo[1].strides, __pyx_t_78, __pyx_pybuffernd_jhwjinv.diminfo[2].strides, __pyx_t_79, __pyx_pybuffernd_jhwjinv.diminfo[3].strides, __pyx_t_80, __pyx_pybuffernd_jhwjinv.diminfo[4].strides, __pyx_t_81, __pyx_pybuffernd_jhwjinv.diminfo[5].strides) = __Pyx_c_quotf(__Pyx_c_prodf(__pyx_t_float_complex_from_parts(-1L, 0), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_70, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_71, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_72, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_73, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_74, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_75, __pyx_pybuffernd_jhwj.diminfo[5].strides))), __pyx_v_denom);
        }
      }
    }
  }
/* … */
          __pyx_t_70 = __pyx_v_d;
          __pyx_t_71 = __pyx_v_t;
          __pyx_t_72 = __pyx_v_f;
          __pyx_t_73 = __pyx_v_aa;
          __pyx_t_74 = 1;
          __pyx_t_75 = 0;
          __pyx_t_76 = __pyx_v_d;
          __pyx_t_77 = __pyx_v_t;
          __pyx_t_78 = __pyx_v_f;
          __pyx_t_79 = __pyx_v_aa;
          __pyx_t_80 = 1;
          __pyx_t_81 = 0;
          *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwjinv.rcbuffer-&gt;pybuffer.buf, __pyx_t_76, __pyx_pybuffernd_jhwjinv.diminfo[0].strides, __pyx_t_77, __pyx_pybuffernd_jhwjinv.diminfo[1].strides, __pyx_t_78, __pyx_pybuffernd_jhwjinv.diminfo[2].strides, __pyx_t_79, __pyx_pybuffernd_jhwjinv.diminfo[3].strides, __pyx_t_80, __pyx_pybuffernd_jhwjinv.diminfo[4].strides, __pyx_t_81, __pyx_pybuffernd_jhwjinv.diminfo[5].strides) = __Pyx_c_quot(__Pyx_c_prod(__pyx_t_double_complex_from_parts(-1L, 0), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_70, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_71, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_72, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_73, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_74, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_75, __pyx_pybuffernd_jhwj.diminfo[5].strides))), __pyx_v_denom);
        }
      }
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">245</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">246</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">247</span>: @cython.cdivision(True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">248</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">249</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">250</span>: @cython.nonecheck(False)</pre>
<pre class="cython line score-593" onclick='toggleDiv(this)'>+<span class="">251</span>: def cycompute_update(np.ndarray[complex3264, ndim=6] jhwr,</pre>
<pre class='cython code score-593 '>/* Python wrapper */
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_11cycompute_update(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_10cycompute_update[] = "\n    This computes the update by computing the product of jhwj and jhwr. These should already have been\n    reduced to the correct dimension so that this operation is very simple. \n    ";
static PyMethodDef __pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_11cycompute_update = {"cycompute_update", (PyCFunction)__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_11cycompute_update, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_10cycompute_update};
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_11cycompute_update(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_signatures = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED PyObject *__pyx_v_defaults = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fused_cpdef (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_signatures,&amp;__pyx_n_s_args,&amp;__pyx_n_s_kwargs,&amp;__pyx_n_s_defaults,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_signatures)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_args)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_kwargs)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_defaults)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_fused_cpdef") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_signatures = values[0];
    __pyx_v_args = values[1];
    __pyx_v_kwargs = values[2];
    __pyx_v_defaults = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_10cycompute_update(__pyx_self, __pyx_v_signatures, __pyx_v_args, __pyx_v_kwargs, __pyx_v_defaults);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_10cycompute_update(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_signatures, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs, CYTHON_UNUSED PyObject *__pyx_v_defaults) {
  PyObject *__pyx_v_dest_sig = NULL;
  PyTypeObject *__pyx_v_ndarray = 0;
  PyObject *__pyx_v_numpy = NULL;
  __Pyx_memviewslice __pyx_v_memslice;
  Py_ssize_t __pyx_v_itemsize;
  CYTHON_UNUSED int __pyx_v_dtype_signed;
  char __pyx_v_kind;
  PyObject *__pyx_v_arg = NULL;
  PyObject *__pyx_v_dtype = NULL;
  PyObject *__pyx_v_arg_base = NULL;
  PyObject *__pyx_v_candidates = NULL;
  PyObject *__pyx_v_sig = NULL;
  int __pyx_v_match_found;
  PyObject *__pyx_v_src_type = NULL;
  PyObject *__pyx_v_dst_type = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_update", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kwargs);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, Py_None);
  __pyx_v_dest_sig = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_2 = (__pyx_v_kwargs == Py_None);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kwargs, __pyx_t_1);
    __pyx_t_1 = 0;
  }
  {
    /*try:*/ {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_v_numpy = __pyx_t_1;
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_numpy, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!(likely(<span class='py_c_api'>PyType_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "type", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      __pyx_v_ndarray = ((PyTypeObject*)__pyx_t_1);
      __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L11_try_end;
    __pyx_L4_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_ImportError) || <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_AttributeError) || <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_TypeError);
    if (__pyx_t_7) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_1, &amp;__pyx_t_8, &amp;__pyx_t_9) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L6_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ndarray, ((PyTypeObject*)Py_None));
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L5_exception_handled;
    }
    goto __pyx_L6_except_error;
    __pyx_L6_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    goto __pyx_L1_error;
    __pyx_L5_exception_handled:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    __pyx_L11_try_end:;
  }
  __pyx_v_itemsize = -1L;
  if (unlikely(__pyx_v_args == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = ((0 &lt; __pyx_t_10) != 0);
  if (__pyx_t_3) {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(((PyObject*)__pyx_v_args), 0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
    __pyx_v_arg = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L14;
  }
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyDict_ContainsTF</span>(__pyx_n_s_jhwr, ((PyObject*)__pyx_v_kwargs), Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {
    if (unlikely(__pyx_v_kwargs == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_kwargs), __pyx_n_s_jhwr);<span class='error_goto'> if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_v_arg = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L14;
  }
  /*else*/ {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_Expected_at_least_d_arguments, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_L14:;
  while (1) {
    __pyx_t_2 = (__pyx_v_ndarray != ((PyTypeObject*)Py_None));
    __pyx_t_3 = (__pyx_t_2 != 0);
    if (__pyx_t_3) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_arg, __pyx_v_ndarray); 
      __pyx_t_2 = (__pyx_t_3 != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_v_dtype = __pyx_t_8;
        __pyx_t_8 = 0;
        goto __pyx_L18;
      }
      __pyx_t_2 = (__pyx_memoryview_check(__pyx_v_arg) != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_base);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_v_arg_base = __pyx_t_8;
        __pyx_t_8 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_arg_base, __pyx_v_ndarray); 
        __pyx_t_3 = (__pyx_t_2 != 0);
        if (__pyx_t_3) {
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg_base, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_v_dtype = __pyx_t_8;
          __pyx_t_8 = 0;
          goto __pyx_L19;
        }
        /*else*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
          __pyx_v_dtype = Py_None;
        }
        __pyx_L19:;
        goto __pyx_L18;
      }
      /*else*/ {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
        __pyx_v_dtype = Py_None;
      }
      __pyx_L18:;
      __pyx_v_itemsize = -1L;
      __pyx_t_3 = (__pyx_v_dtype != Py_None);
      __pyx_t_2 = (__pyx_t_3 != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dtype, __pyx_n_s_itemsize);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_itemsize = __pyx_t_10;
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dtype, __pyx_n_s_kind);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Ord</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(__pyx_t_11 == (long)(Py_UCS4)-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_kind = __pyx_t_11;
        __pyx_v_dtype_signed = (__pyx_v_kind == 'i');
        switch (__pyx_v_kind) {
          case 'i':
          case 'u':
          break;
          case 'f':
          break;
          case 'c':
          __pyx_t_3 = (((sizeof(__pyx_t_float_complex)) == __pyx_v_itemsize) != 0);
          if (__pyx_t_3) {
          } else {
            __pyx_t_2 = __pyx_t_3;
            goto __pyx_L22_bool_binop_done;
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_3 = ((((Py_ssize_t)__pyx_t_10) == 6) != 0);
          __pyx_t_2 = __pyx_t_3;
          __pyx_L22_bool_binop_done:;
          if (__pyx_t_2) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            goto __pyx_L16_break;
          }
          __pyx_t_3 = (((sizeof(__pyx_t_double_complex)) == __pyx_v_itemsize) != 0);
          if (__pyx_t_3) {
          } else {
            __pyx_t_2 = __pyx_t_3;
            goto __pyx_L25_bool_binop_done;
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_3 = ((((Py_ssize_t)__pyx_t_10) == 6) != 0);
          __pyx_t_2 = __pyx_t_3;
          __pyx_L25_bool_binop_done:;
          if (__pyx_t_2) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            goto __pyx_L16_break;
          }
          break;
          case 'O':
          break;
          default: break;
        }
      }
    }
    __pyx_t_3 = ((__pyx_v_itemsize == -1L) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L28_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_itemsize == (sizeof(__pyx_t_float_complex))) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L28_bool_binop_done:;
    if (__pyx_t_2) {
      __pyx_v_memslice = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsdsds___pyx_t_float_complex</span>(__pyx_v_arg);
      __pyx_t_2 = (__pyx_v_memslice.memview != 0);
      if (__pyx_t_2) {
        __PYX_XDEC_MEMVIEW((&amp;__pyx_v_memslice), 1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L16_break;
      }
      /*else*/ {
        <span class='py_c_api'>PyErr_Clear</span>();
      }
    }
    __pyx_t_3 = ((__pyx_v_itemsize == -1L) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L32_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_itemsize == (sizeof(__pyx_t_double_complex))) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L32_bool_binop_done:;
    if (__pyx_t_2) {
      __pyx_v_memslice = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsdsds___pyx_t_double_complex</span>(__pyx_v_arg);
      __pyx_t_2 = (__pyx_v_memslice.memview != 0);
      if (__pyx_t_2) {
        __PYX_XDEC_MEMVIEW((&amp;__pyx_v_memslice), 1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L16_break;
      }
      /*else*/ {
        <span class='py_c_api'>PyErr_Clear</span>();
      }
    }
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, Py_None, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L16_break;
  }
  __pyx_L16_break:;
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_v_candidates = ((PyObject*)__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_10 = 0;
  if (unlikely(__pyx_v_signatures == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_9 = __Pyx_dict_iterator(((PyObject*)__pyx_v_signatures), 1, ((PyObject *)NULL), (&amp;__pyx_t_12), (&amp;__pyx_t_7));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __pyx_t_8 = __pyx_t_9;
  __pyx_t_9 = 0;
  while (1) {
    __pyx_t_13 = __Pyx_dict_iter_next(__pyx_t_8, __pyx_t_12, &amp;__pyx_t_10, &amp;__pyx_t_9, NULL, NULL, __pyx_t_7);
    if (unlikely(__pyx_t_13 == 0)) break;
    if (unlikely(__pyx_t_13 == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_sig, __pyx_t_9);
    __pyx_t_9 = 0;
    __pyx_v_match_found = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_sig, __pyx_n_s_strip);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__23, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_split);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__23 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_);<span class='error_goto'> if (unlikely(!__pyx_tuple__23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__23);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__24, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dest_sig);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dest_sig);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_dest_sig);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_9 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_14 = 0;
      __pyx_t_15 = NULL;
    } else {
      __pyx_t_14 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_15 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_15)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_15(__pyx_t_9);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        PyObject* sequence = __pyx_t_1;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_16 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_17 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_16 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_17 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
        #else
        __pyx_t_16 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        __pyx_t_17 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_18 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_19 = Py_TYPE(__pyx_t_18)-&gt;tp_iternext;
        index = 0; __pyx_t_16 = __pyx_t_19(__pyx_t_18); if (unlikely(!__pyx_t_16)) goto __pyx_L39_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        index = 1; __pyx_t_17 = __pyx_t_19(__pyx_t_18); if (unlikely(!__pyx_t_17)) goto __pyx_L39_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_19(__pyx_t_18), 2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_19 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        goto __pyx_L40_unpacking_done;
        __pyx_L39_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_t_19 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_L40_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_src_type, __pyx_t_16);
      __pyx_t_16 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dst_type, __pyx_t_17);
      __pyx_t_17 = 0;
      __pyx_t_2 = (__pyx_v_dst_type != Py_None);
      __pyx_t_3 = (__pyx_t_2 != 0);
      if (__pyx_t_3) {
        __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_src_type, __pyx_v_dst_type, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (__pyx_t_3) {
          __pyx_v_match_found = 1;
          goto __pyx_L42;
        }
        /*else*/ {
          __pyx_v_match_found = 0;
          goto __pyx_L38_break;
        }
        __pyx_L42:;
      }
    }
    __pyx_L38_break:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_3 = (__pyx_v_match_found != 0);
    if (__pyx_t_3) {
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_candidates, __pyx_v_sig);<span class='error_goto'> if (unlikely(__pyx_t_20 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_3 = (__pyx_v_candidates != Py_None) &amp;&amp; (<span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates) != 0);
  __pyx_t_2 = ((!__pyx_t_3) != 0);
  if (__pyx_t_2) {
  __pyx_tuple__24 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s__3);<span class='error_goto'> if (unlikely(!__pyx_tuple__24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__24);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__25, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_12 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates);<span class='error_goto'> if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = ((__pyx_t_12 &gt; 1) != 0);
  if (__pyx_t_2) {
  __pyx_tuple__25 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_No_matching_signature_found);<span class='error_goto'> if (unlikely(!__pyx_tuple__25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__25);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__25);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__26, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(__pyx_v_signatures == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_signatures), <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_candidates, 0));<span class='error_goto'> if (unlikely(__pyx_t_8 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_r = __pyx_t_8;
    __pyx_t_8 = 0;
    goto __pyx_L0;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dest_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_numpy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dtype);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg_base);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_candidates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_src_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dst_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_47cycompute_update(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_fuse_0__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_47cycompute_update = {"__pyx_fuse_0cycompute_update", (PyCFunction)__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_47cycompute_update, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_10cycompute_update};
static PyObject *__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_47cycompute_update(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_jhwr = 0;
  PyArrayObject *__pyx_v_jhwj = 0;
  PyArrayObject *__pyx_v_upd = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_update (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_jhwr,&amp;__pyx_n_s_jhwj,&amp;__pyx_n_s_upd,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jhwr)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jhwj)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_update", 1, 3, 3, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_upd)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_update", 1, 3, 3, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cycompute_update") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_jhwr = ((PyArrayObject *)values[0]);
    __pyx_v_jhwj = ((PyArrayObject *)values[1]);
    __pyx_v_upd = ((PyArrayObject *)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_update", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jhwr), __pyx_ptype_5numpy_ndarray, 1, "jhwr", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jhwj), __pyx_ptype_5numpy_ndarray, 1, "jhwj", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_upd), __pyx_ptype_5numpy_ndarray, 1, "upd", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_46cycompute_update(__pyx_self, __pyx_v_jhwr, __pyx_v_jhwj, __pyx_v_upd);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_46cycompute_update(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_jhwr, PyArrayObject *__pyx_v_jhwj, PyArrayObject *__pyx_v_upd) {
  int __pyx_v_d;
  int __pyx_v_t;
  int __pyx_v_f;
  int __pyx_v_aa;
  int __pyx_v_n_dir;
  int __pyx_v_n_tim;
  int __pyx_v_n_fre;
  int __pyx_v_n_ant;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jhwj;
  __Pyx_Buffer __pyx_pybuffer_jhwj;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jhwr;
  __Pyx_Buffer __pyx_pybuffer_jhwr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_upd;
  __Pyx_Buffer __pyx_pybuffer_upd;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_0cycompute_update", 0);
  __pyx_pybuffer_jhwr.pybuffer.buf = NULL;
  __pyx_pybuffer_jhwr.refcount = 0;
  __pyx_pybuffernd_jhwr.data = NULL;
  __pyx_pybuffernd_jhwr.rcbuffer = &amp;__pyx_pybuffer_jhwr;
  __pyx_pybuffer_jhwj.pybuffer.buf = NULL;
  __pyx_pybuffer_jhwj.refcount = 0;
  __pyx_pybuffernd_jhwj.data = NULL;
  __pyx_pybuffernd_jhwj.rcbuffer = &amp;__pyx_pybuffer_jhwj;
  __pyx_pybuffer_upd.pybuffer.buf = NULL;
  __pyx_pybuffer_upd.refcount = 0;
  __pyx_pybuffernd_upd.data = NULL;
  __pyx_pybuffernd_upd.rcbuffer = &amp;__pyx_pybuffer_upd;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jhwr, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jhwr.diminfo[0].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jhwr.diminfo[0].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jhwr.diminfo[1].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jhwr.diminfo[1].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jhwr.diminfo[2].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jhwr.diminfo[2].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jhwr.diminfo[3].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jhwr.diminfo[3].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jhwr.diminfo[4].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jhwr.diminfo[4].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jhwr.diminfo[5].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jhwr.diminfo[5].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jhwj, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jhwj.diminfo[0].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jhwj.diminfo[0].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jhwj.diminfo[1].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jhwj.diminfo[1].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jhwj.diminfo[2].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jhwj.diminfo[2].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jhwj.diminfo[3].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jhwj.diminfo[3].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jhwj.diminfo[4].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jhwj.diminfo[4].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jhwj.diminfo[5].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jhwj.diminfo[5].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_upd, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_upd.diminfo[0].strides = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_upd.diminfo[0].shape = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_upd.diminfo[1].strides = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_upd.diminfo[1].shape = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_upd.diminfo[2].strides = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_upd.diminfo[2].shape = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_upd.diminfo[3].strides = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_upd.diminfo[3].shape = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_upd.diminfo[4].strides = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_upd.diminfo[4].shape = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_upd.diminfo[5].strides = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_upd.diminfo[5].shape = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.shape[5];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_49cycompute_update(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_fuse_1__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_49cycompute_update = {"__pyx_fuse_1cycompute_update", (PyCFunction)__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_49cycompute_update, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_10cycompute_update};
static PyObject *__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_49cycompute_update(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_jhwr = 0;
  PyArrayObject *__pyx_v_jhwj = 0;
  PyArrayObject *__pyx_v_upd = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_update (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_jhwr,&amp;__pyx_n_s_jhwj,&amp;__pyx_n_s_upd,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jhwr)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jhwj)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_update", 1, 3, 3, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_upd)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_update", 1, 3, 3, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cycompute_update") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_jhwr = ((PyArrayObject *)values[0]);
    __pyx_v_jhwj = ((PyArrayObject *)values[1]);
    __pyx_v_upd = ((PyArrayObject *)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_update", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jhwr), __pyx_ptype_5numpy_ndarray, 1, "jhwr", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_jhwj), __pyx_ptype_5numpy_ndarray, 1, "jhwj", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_upd), __pyx_ptype_5numpy_ndarray, 1, "upd", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_48cycompute_update(__pyx_self, __pyx_v_jhwr, __pyx_v_jhwj, __pyx_v_upd);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_48cycompute_update(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_jhwr, PyArrayObject *__pyx_v_jhwj, PyArrayObject *__pyx_v_upd) {
  int __pyx_v_d;
  int __pyx_v_t;
  int __pyx_v_f;
  int __pyx_v_aa;
  int __pyx_v_n_dir;
  int __pyx_v_n_tim;
  int __pyx_v_n_fre;
  int __pyx_v_n_ant;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jhwj;
  __Pyx_Buffer __pyx_pybuffer_jhwj;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jhwr;
  __Pyx_Buffer __pyx_pybuffer_jhwr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_upd;
  __Pyx_Buffer __pyx_pybuffer_upd;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_1cycompute_update", 0);
  __pyx_pybuffer_jhwr.pybuffer.buf = NULL;
  __pyx_pybuffer_jhwr.refcount = 0;
  __pyx_pybuffernd_jhwr.data = NULL;
  __pyx_pybuffernd_jhwr.rcbuffer = &amp;__pyx_pybuffer_jhwr;
  __pyx_pybuffer_jhwj.pybuffer.buf = NULL;
  __pyx_pybuffer_jhwj.refcount = 0;
  __pyx_pybuffernd_jhwj.data = NULL;
  __pyx_pybuffernd_jhwj.rcbuffer = &amp;__pyx_pybuffer_jhwj;
  __pyx_pybuffer_upd.pybuffer.buf = NULL;
  __pyx_pybuffer_upd.refcount = 0;
  __pyx_pybuffernd_upd.data = NULL;
  __pyx_pybuffernd_upd.rcbuffer = &amp;__pyx_pybuffer_upd;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jhwr, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jhwr.diminfo[0].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jhwr.diminfo[0].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jhwr.diminfo[1].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jhwr.diminfo[1].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jhwr.diminfo[2].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jhwr.diminfo[2].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jhwr.diminfo[3].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jhwr.diminfo[3].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jhwr.diminfo[4].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jhwr.diminfo[4].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jhwr.diminfo[5].strides = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jhwr.diminfo[5].shape = __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jhwj, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_jhwj.diminfo[0].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jhwj.diminfo[0].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jhwj.diminfo[1].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jhwj.diminfo[1].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_jhwj.diminfo[2].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_jhwj.diminfo[2].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_jhwj.diminfo[3].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_jhwj.diminfo[3].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_jhwj.diminfo[4].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_jhwj.diminfo[4].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_jhwj.diminfo[5].strides = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_jhwj.diminfo[5].shape = __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_upd, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_upd.diminfo[0].strides = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_upd.diminfo[0].shape = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_upd.diminfo[1].strides = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_upd.diminfo[1].shape = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_upd.diminfo[2].strides = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_upd.diminfo[2].shape = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_upd.diminfo[3].strides = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_upd.diminfo[3].shape = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_upd.diminfo[4].strides = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_upd.diminfo[4].shape = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_upd.diminfo[5].strides = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_upd.diminfo[5].shape = __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.shape[5];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
  __pyx_tuple__26 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Function_call_with_ambiguous_arg);<span class='error_goto'> if (unlikely(!__pyx_tuple__26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__26);
/* … */
  __pyx_tuple__68 = <span class='py_c_api'>PyTuple_Pack</span>(11, __pyx_n_s_jhwr, __pyx_n_s_jhwj, __pyx_n_s_upd, __pyx_n_s_d, __pyx_n_s_t, __pyx_n_s_f, __pyx_n_s_aa, __pyx_n_s_n_dir, __pyx_n_s_n_tim, __pyx_n_s_n_fre, __pyx_n_s_n_ant);<span class='error_goto'> if (unlikely(!__pyx_tuple__68)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__68);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__68);
/* … */
  __pyx_t_11 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_12 = __pyx_FusedFunction_NewEx(&amp;__pyx_fuse_0__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_47cycompute_update, 0, __pyx_n_s_cycompute_update, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__69));<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_12, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_kp_s_float_complex, __pyx_t_12) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = __pyx_FusedFunction_NewEx(&amp;__pyx_fuse_1__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_49cycompute_update, 0, __pyx_n_s_cycompute_update, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__69));<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_12, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_kp_s_double_complex, __pyx_t_12) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = __pyx_FusedFunction_NewEx(&amp;__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_11cycompute_update, 0, __pyx_n_s_cycompute_update, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__69));<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_12, __pyx_empty_tuple);
  ((__pyx_FusedFunctionObject *) __pyx_t_12)-&gt;__signatures__ = __pyx_t_11;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_cycompute_update, __pyx_t_12) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_codeobj__69 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 11, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__68, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_ulrich_CubeCal_cubecal_ker, __pyx_n_s_cycompute_update, 251, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__69)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">252</span>:                      np.ndarray[complex3264, ndim=6] jhwj,</pre>
<pre class="cython line score-0">&#xA0;<span class="">253</span>:                      np.ndarray[complex3264, ndim=6] upd):</pre>
<pre class="cython line score-0">&#xA0;<span class="">254</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">255</span>:     This computes the update by computing the product of jhwj and jhwr. These should already have been</pre>
<pre class="cython line score-0">&#xA0;<span class="">256</span>:     reduced to the correct dimension so that this operation is very simple.</pre>
<pre class="cython line score-0">&#xA0;<span class="">257</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">258</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">259</span>:     cdef int d, t, f, aa = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_aa = 0;
/* … */
  __pyx_v_aa = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">260</span>:     cdef int n_dir, n_tim, n_fre, n_ant</pre>
<pre class="cython line score-0">&#xA0;<span class="">261</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">262</span>:     n_dir = jhwr.shape[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_dir = (__pyx_v_jhwr-&gt;dimensions[0]);
/* … */
  __pyx_v_n_dir = (__pyx_v_jhwr-&gt;dimensions[0]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">263</span>:     n_tim = jhwr.shape[1]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_tim = (__pyx_v_jhwr-&gt;dimensions[1]);
/* … */
  __pyx_v_n_tim = (__pyx_v_jhwr-&gt;dimensions[1]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">264</span>:     n_fre = jhwr.shape[2]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_fre = (__pyx_v_jhwr-&gt;dimensions[2]);
/* … */
  __pyx_v_n_fre = (__pyx_v_jhwr-&gt;dimensions[2]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">265</span>:     n_ant = jhwr.shape[3]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_ant = (__pyx_v_jhwr-&gt;dimensions[3]);
/* … */
  __pyx_v_n_ant = (__pyx_v_jhwr-&gt;dimensions[3]);
</pre><pre class="cython line score-0">&#xA0;<span class="">266</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">267</span>:     for d in xrange(n_dir):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_n_dir;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
/* … */
  __pyx_t_1 = __pyx_v_n_dir;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">268</span>:         for t in xrange(n_tim):</pre>
<pre class='cython code score-0 '>    __pyx_t_3 = __pyx_v_n_tim;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_t = __pyx_t_4;
/* … */
    __pyx_t_3 = __pyx_v_n_tim;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_t = __pyx_t_4;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">269</span>:             for f in xrange(n_fre):</pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_n_fre;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_f = __pyx_t_6;
/* … */
      __pyx_t_5 = __pyx_v_n_fre;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_f = __pyx_t_6;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">270</span>:                 for aa in xrange(n_ant):</pre>
<pre class='cython code score-0 '>        __pyx_t_7 = __pyx_v_n_ant;
        for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_aa = __pyx_t_8;
/* … */
        __pyx_t_7 = __pyx_v_n_ant;
        for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_aa = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">271</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">272</span>:                     upd[d,t,f,aa,0,0] = jhwr[d,t,f,aa,0,0]*jhwj[d,t,f,aa,0,0] + \</pre>
<pre class='cython code score-0 '>          __pyx_t_9 = __pyx_v_d;
          __pyx_t_10 = __pyx_v_t;
          __pyx_t_11 = __pyx_v_f;
          __pyx_t_12 = __pyx_v_aa;
          __pyx_t_13 = 0;
          __pyx_t_14 = 0;
          __pyx_t_15 = __pyx_v_d;
          __pyx_t_16 = __pyx_v_t;
          __pyx_t_17 = __pyx_v_f;
          __pyx_t_18 = __pyx_v_aa;
          __pyx_t_19 = 0;
          __pyx_t_20 = 0;
/* … */
          __pyx_t_33 = __pyx_v_d;
          __pyx_t_34 = __pyx_v_t;
          __pyx_t_35 = __pyx_v_f;
          __pyx_t_36 = __pyx_v_aa;
          __pyx_t_37 = 0;
          __pyx_t_38 = 0;
          *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_upd.diminfo[0].strides, __pyx_t_34, __pyx_pybuffernd_upd.diminfo[1].strides, __pyx_t_35, __pyx_pybuffernd_upd.diminfo[2].strides, __pyx_t_36, __pyx_pybuffernd_upd.diminfo[3].strides, __pyx_t_37, __pyx_pybuffernd_upd.diminfo[4].strides, __pyx_t_38, __pyx_pybuffernd_upd.diminfo[5].strides) = __Pyx_c_sumf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_11, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_12, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_13, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_14, __pyx_pybuffernd_jhwr.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_17, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_18, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_19, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_20, __pyx_pybuffernd_jhwj.diminfo[5].strides))), __Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_23, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_24, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_25, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_26, __pyx_pybuffernd_jhwr.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_28, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_29, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_30, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_31, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_32, __pyx_pybuffernd_jhwj.diminfo[5].strides))));
/* … */
          __pyx_t_9 = __pyx_v_d;
          __pyx_t_10 = __pyx_v_t;
          __pyx_t_11 = __pyx_v_f;
          __pyx_t_12 = __pyx_v_aa;
          __pyx_t_13 = 0;
          __pyx_t_14 = 0;
          __pyx_t_15 = __pyx_v_d;
          __pyx_t_16 = __pyx_v_t;
          __pyx_t_17 = __pyx_v_f;
          __pyx_t_18 = __pyx_v_aa;
          __pyx_t_19 = 0;
          __pyx_t_20 = 0;
/* … */
          __pyx_t_33 = __pyx_v_d;
          __pyx_t_34 = __pyx_v_t;
          __pyx_t_35 = __pyx_v_f;
          __pyx_t_36 = __pyx_v_aa;
          __pyx_t_37 = 0;
          __pyx_t_38 = 0;
          *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_upd.diminfo[0].strides, __pyx_t_34, __pyx_pybuffernd_upd.diminfo[1].strides, __pyx_t_35, __pyx_pybuffernd_upd.diminfo[2].strides, __pyx_t_36, __pyx_pybuffernd_upd.diminfo[3].strides, __pyx_t_37, __pyx_pybuffernd_upd.diminfo[4].strides, __pyx_t_38, __pyx_pybuffernd_upd.diminfo[5].strides) = __Pyx_c_sum(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_11, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_12, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_13, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_14, __pyx_pybuffernd_jhwr.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_17, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_18, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_19, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_20, __pyx_pybuffernd_jhwj.diminfo[5].strides))), __Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_23, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_24, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_25, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_26, __pyx_pybuffernd_jhwr.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_28, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_29, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_30, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_31, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_32, __pyx_pybuffernd_jhwj.diminfo[5].strides))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">273</span>:                                         jhwr[d,t,f,aa,0,1]*jhwj[d,t,f,aa,1,0]</pre>
<pre class='cython code score-0 '>          __pyx_t_21 = __pyx_v_d;
          __pyx_t_22 = __pyx_v_t;
          __pyx_t_23 = __pyx_v_f;
          __pyx_t_24 = __pyx_v_aa;
          __pyx_t_25 = 0;
          __pyx_t_26 = 1;
          __pyx_t_27 = __pyx_v_d;
          __pyx_t_28 = __pyx_v_t;
          __pyx_t_29 = __pyx_v_f;
          __pyx_t_30 = __pyx_v_aa;
          __pyx_t_31 = 1;
          __pyx_t_32 = 0;
/* … */
          __pyx_t_21 = __pyx_v_d;
          __pyx_t_22 = __pyx_v_t;
          __pyx_t_23 = __pyx_v_f;
          __pyx_t_24 = __pyx_v_aa;
          __pyx_t_25 = 0;
          __pyx_t_26 = 1;
          __pyx_t_27 = __pyx_v_d;
          __pyx_t_28 = __pyx_v_t;
          __pyx_t_29 = __pyx_v_f;
          __pyx_t_30 = __pyx_v_aa;
          __pyx_t_31 = 1;
          __pyx_t_32 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">274</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">275</span>:                     upd[d,t,f,aa,0,1] = jhwr[d,t,f,aa,0,0]*jhwj[d,t,f,aa,0,1] + \</pre>
<pre class='cython code score-0 '>          __pyx_t_39 = __pyx_v_d;
          __pyx_t_40 = __pyx_v_t;
          __pyx_t_41 = __pyx_v_f;
          __pyx_t_42 = __pyx_v_aa;
          __pyx_t_43 = 0;
          __pyx_t_44 = 0;
          __pyx_t_45 = __pyx_v_d;
          __pyx_t_46 = __pyx_v_t;
          __pyx_t_47 = __pyx_v_f;
          __pyx_t_48 = __pyx_v_aa;
          __pyx_t_49 = 0;
          __pyx_t_50 = 1;
/* … */
          __pyx_t_63 = __pyx_v_d;
          __pyx_t_64 = __pyx_v_t;
          __pyx_t_65 = __pyx_v_f;
          __pyx_t_66 = __pyx_v_aa;
          __pyx_t_67 = 0;
          __pyx_t_68 = 1;
          *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.buf, __pyx_t_63, __pyx_pybuffernd_upd.diminfo[0].strides, __pyx_t_64, __pyx_pybuffernd_upd.diminfo[1].strides, __pyx_t_65, __pyx_pybuffernd_upd.diminfo[2].strides, __pyx_t_66, __pyx_pybuffernd_upd.diminfo[3].strides, __pyx_t_67, __pyx_pybuffernd_upd.diminfo[4].strides, __pyx_t_68, __pyx_pybuffernd_upd.diminfo[5].strides) = __Pyx_c_sumf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_39, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_40, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_41, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_42, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_43, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_44, __pyx_pybuffernd_jhwr.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_45, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_46, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_47, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_48, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_49, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_50, __pyx_pybuffernd_jhwj.diminfo[5].strides))), __Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_51, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_52, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_53, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_54, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_55, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_56, __pyx_pybuffernd_jhwr.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_57, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_58, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_59, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_60, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_61, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_62, __pyx_pybuffernd_jhwj.diminfo[5].strides))));
/* … */
          __pyx_t_39 = __pyx_v_d;
          __pyx_t_40 = __pyx_v_t;
          __pyx_t_41 = __pyx_v_f;
          __pyx_t_42 = __pyx_v_aa;
          __pyx_t_43 = 0;
          __pyx_t_44 = 0;
          __pyx_t_45 = __pyx_v_d;
          __pyx_t_46 = __pyx_v_t;
          __pyx_t_47 = __pyx_v_f;
          __pyx_t_48 = __pyx_v_aa;
          __pyx_t_49 = 0;
          __pyx_t_50 = 1;
/* … */
          __pyx_t_63 = __pyx_v_d;
          __pyx_t_64 = __pyx_v_t;
          __pyx_t_65 = __pyx_v_f;
          __pyx_t_66 = __pyx_v_aa;
          __pyx_t_67 = 0;
          __pyx_t_68 = 1;
          *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.buf, __pyx_t_63, __pyx_pybuffernd_upd.diminfo[0].strides, __pyx_t_64, __pyx_pybuffernd_upd.diminfo[1].strides, __pyx_t_65, __pyx_pybuffernd_upd.diminfo[2].strides, __pyx_t_66, __pyx_pybuffernd_upd.diminfo[3].strides, __pyx_t_67, __pyx_pybuffernd_upd.diminfo[4].strides, __pyx_t_68, __pyx_pybuffernd_upd.diminfo[5].strides) = __Pyx_c_sum(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_39, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_40, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_41, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_42, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_43, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_44, __pyx_pybuffernd_jhwr.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_45, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_46, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_47, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_48, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_49, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_50, __pyx_pybuffernd_jhwj.diminfo[5].strides))), __Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_51, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_52, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_53, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_54, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_55, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_56, __pyx_pybuffernd_jhwr.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_57, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_58, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_59, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_60, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_61, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_62, __pyx_pybuffernd_jhwj.diminfo[5].strides))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">276</span>:                                         jhwr[d,t,f,aa,0,1]*jhwj[d,t,f,aa,1,1]</pre>
<pre class='cython code score-0 '>          __pyx_t_51 = __pyx_v_d;
          __pyx_t_52 = __pyx_v_t;
          __pyx_t_53 = __pyx_v_f;
          __pyx_t_54 = __pyx_v_aa;
          __pyx_t_55 = 0;
          __pyx_t_56 = 1;
          __pyx_t_57 = __pyx_v_d;
          __pyx_t_58 = __pyx_v_t;
          __pyx_t_59 = __pyx_v_f;
          __pyx_t_60 = __pyx_v_aa;
          __pyx_t_61 = 1;
          __pyx_t_62 = 1;
/* … */
          __pyx_t_51 = __pyx_v_d;
          __pyx_t_52 = __pyx_v_t;
          __pyx_t_53 = __pyx_v_f;
          __pyx_t_54 = __pyx_v_aa;
          __pyx_t_55 = 0;
          __pyx_t_56 = 1;
          __pyx_t_57 = __pyx_v_d;
          __pyx_t_58 = __pyx_v_t;
          __pyx_t_59 = __pyx_v_f;
          __pyx_t_60 = __pyx_v_aa;
          __pyx_t_61 = 1;
          __pyx_t_62 = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">277</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">278</span>:                     upd[d,t,f,aa,1,0] = jhwr[d,t,f,aa,1,0]*jhwj[d,t,f,aa,0,0] + \</pre>
<pre class='cython code score-0 '>          __pyx_t_69 = __pyx_v_d;
          __pyx_t_70 = __pyx_v_t;
          __pyx_t_71 = __pyx_v_f;
          __pyx_t_72 = __pyx_v_aa;
          __pyx_t_73 = 1;
          __pyx_t_74 = 0;
          __pyx_t_75 = __pyx_v_d;
          __pyx_t_76 = __pyx_v_t;
          __pyx_t_77 = __pyx_v_f;
          __pyx_t_78 = __pyx_v_aa;
          __pyx_t_79 = 0;
          __pyx_t_80 = 0;
/* … */
          __pyx_t_93 = __pyx_v_d;
          __pyx_t_94 = __pyx_v_t;
          __pyx_t_95 = __pyx_v_f;
          __pyx_t_96 = __pyx_v_aa;
          __pyx_t_97 = 1;
          __pyx_t_98 = 0;
          *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.buf, __pyx_t_93, __pyx_pybuffernd_upd.diminfo[0].strides, __pyx_t_94, __pyx_pybuffernd_upd.diminfo[1].strides, __pyx_t_95, __pyx_pybuffernd_upd.diminfo[2].strides, __pyx_t_96, __pyx_pybuffernd_upd.diminfo[3].strides, __pyx_t_97, __pyx_pybuffernd_upd.diminfo[4].strides, __pyx_t_98, __pyx_pybuffernd_upd.diminfo[5].strides) = __Pyx_c_sumf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_69, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_70, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_71, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_72, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_73, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_74, __pyx_pybuffernd_jhwr.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_75, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_76, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_77, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_78, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_79, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_80, __pyx_pybuffernd_jhwj.diminfo[5].strides))), __Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_81, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_82, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_83, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_84, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_85, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_86, __pyx_pybuffernd_jhwr.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_87, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_88, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_89, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_90, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_91, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_92, __pyx_pybuffernd_jhwj.diminfo[5].strides))));
/* … */
          __pyx_t_69 = __pyx_v_d;
          __pyx_t_70 = __pyx_v_t;
          __pyx_t_71 = __pyx_v_f;
          __pyx_t_72 = __pyx_v_aa;
          __pyx_t_73 = 1;
          __pyx_t_74 = 0;
          __pyx_t_75 = __pyx_v_d;
          __pyx_t_76 = __pyx_v_t;
          __pyx_t_77 = __pyx_v_f;
          __pyx_t_78 = __pyx_v_aa;
          __pyx_t_79 = 0;
          __pyx_t_80 = 0;
/* … */
          __pyx_t_93 = __pyx_v_d;
          __pyx_t_94 = __pyx_v_t;
          __pyx_t_95 = __pyx_v_f;
          __pyx_t_96 = __pyx_v_aa;
          __pyx_t_97 = 1;
          __pyx_t_98 = 0;
          *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.buf, __pyx_t_93, __pyx_pybuffernd_upd.diminfo[0].strides, __pyx_t_94, __pyx_pybuffernd_upd.diminfo[1].strides, __pyx_t_95, __pyx_pybuffernd_upd.diminfo[2].strides, __pyx_t_96, __pyx_pybuffernd_upd.diminfo[3].strides, __pyx_t_97, __pyx_pybuffernd_upd.diminfo[4].strides, __pyx_t_98, __pyx_pybuffernd_upd.diminfo[5].strides) = __Pyx_c_sum(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_69, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_70, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_71, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_72, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_73, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_74, __pyx_pybuffernd_jhwr.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_75, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_76, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_77, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_78, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_79, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_80, __pyx_pybuffernd_jhwj.diminfo[5].strides))), __Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_81, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_82, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_83, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_84, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_85, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_86, __pyx_pybuffernd_jhwr.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_87, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_88, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_89, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_90, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_91, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_92, __pyx_pybuffernd_jhwj.diminfo[5].strides))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">279</span>:                                         jhwr[d,t,f,aa,1,1]*jhwj[d,t,f,aa,1,0]</pre>
<pre class='cython code score-0 '>          __pyx_t_81 = __pyx_v_d;
          __pyx_t_82 = __pyx_v_t;
          __pyx_t_83 = __pyx_v_f;
          __pyx_t_84 = __pyx_v_aa;
          __pyx_t_85 = 1;
          __pyx_t_86 = 1;
          __pyx_t_87 = __pyx_v_d;
          __pyx_t_88 = __pyx_v_t;
          __pyx_t_89 = __pyx_v_f;
          __pyx_t_90 = __pyx_v_aa;
          __pyx_t_91 = 1;
          __pyx_t_92 = 0;
/* … */
          __pyx_t_81 = __pyx_v_d;
          __pyx_t_82 = __pyx_v_t;
          __pyx_t_83 = __pyx_v_f;
          __pyx_t_84 = __pyx_v_aa;
          __pyx_t_85 = 1;
          __pyx_t_86 = 1;
          __pyx_t_87 = __pyx_v_d;
          __pyx_t_88 = __pyx_v_t;
          __pyx_t_89 = __pyx_v_f;
          __pyx_t_90 = __pyx_v_aa;
          __pyx_t_91 = 1;
          __pyx_t_92 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">280</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">281</span>:                     upd[d,t,f,aa,1,1] = jhwr[d,t,f,aa,1,0]*jhwj[d,t,f,aa,0,1] + \</pre>
<pre class='cython code score-0 '>          __pyx_t_99 = __pyx_v_d;
          __pyx_t_100 = __pyx_v_t;
          __pyx_t_101 = __pyx_v_f;
          __pyx_t_102 = __pyx_v_aa;
          __pyx_t_103 = 1;
          __pyx_t_104 = 0;
          __pyx_t_105 = __pyx_v_d;
          __pyx_t_106 = __pyx_v_t;
          __pyx_t_107 = __pyx_v_f;
          __pyx_t_108 = __pyx_v_aa;
          __pyx_t_109 = 0;
          __pyx_t_110 = 1;
/* … */
          __pyx_t_123 = __pyx_v_d;
          __pyx_t_124 = __pyx_v_t;
          __pyx_t_125 = __pyx_v_f;
          __pyx_t_126 = __pyx_v_aa;
          __pyx_t_127 = 1;
          __pyx_t_128 = 1;
          *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.buf, __pyx_t_123, __pyx_pybuffernd_upd.diminfo[0].strides, __pyx_t_124, __pyx_pybuffernd_upd.diminfo[1].strides, __pyx_t_125, __pyx_pybuffernd_upd.diminfo[2].strides, __pyx_t_126, __pyx_pybuffernd_upd.diminfo[3].strides, __pyx_t_127, __pyx_pybuffernd_upd.diminfo[4].strides, __pyx_t_128, __pyx_pybuffernd_upd.diminfo[5].strides) = __Pyx_c_sumf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_99, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_100, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_101, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_102, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_103, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_104, __pyx_pybuffernd_jhwr.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_105, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_106, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_107, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_108, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_109, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_110, __pyx_pybuffernd_jhwj.diminfo[5].strides))), __Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_111, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_112, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_113, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_114, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_115, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_116, __pyx_pybuffernd_jhwr.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_117, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_118, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_119, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_120, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_121, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_122, __pyx_pybuffernd_jhwj.diminfo[5].strides))));
        }
      }
    }
  }
/* … */
          __pyx_t_99 = __pyx_v_d;
          __pyx_t_100 = __pyx_v_t;
          __pyx_t_101 = __pyx_v_f;
          __pyx_t_102 = __pyx_v_aa;
          __pyx_t_103 = 1;
          __pyx_t_104 = 0;
          __pyx_t_105 = __pyx_v_d;
          __pyx_t_106 = __pyx_v_t;
          __pyx_t_107 = __pyx_v_f;
          __pyx_t_108 = __pyx_v_aa;
          __pyx_t_109 = 0;
          __pyx_t_110 = 1;
/* … */
          __pyx_t_123 = __pyx_v_d;
          __pyx_t_124 = __pyx_v_t;
          __pyx_t_125 = __pyx_v_f;
          __pyx_t_126 = __pyx_v_aa;
          __pyx_t_127 = 1;
          __pyx_t_128 = 1;
          *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_upd.rcbuffer-&gt;pybuffer.buf, __pyx_t_123, __pyx_pybuffernd_upd.diminfo[0].strides, __pyx_t_124, __pyx_pybuffernd_upd.diminfo[1].strides, __pyx_t_125, __pyx_pybuffernd_upd.diminfo[2].strides, __pyx_t_126, __pyx_pybuffernd_upd.diminfo[3].strides, __pyx_t_127, __pyx_pybuffernd_upd.diminfo[4].strides, __pyx_t_128, __pyx_pybuffernd_upd.diminfo[5].strides) = __Pyx_c_sum(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_99, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_100, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_101, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_102, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_103, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_104, __pyx_pybuffernd_jhwr.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_105, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_106, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_107, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_108, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_109, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_110, __pyx_pybuffernd_jhwj.diminfo[5].strides))), __Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwr.rcbuffer-&gt;pybuffer.buf, __pyx_t_111, __pyx_pybuffernd_jhwr.diminfo[0].strides, __pyx_t_112, __pyx_pybuffernd_jhwr.diminfo[1].strides, __pyx_t_113, __pyx_pybuffernd_jhwr.diminfo[2].strides, __pyx_t_114, __pyx_pybuffernd_jhwr.diminfo[3].strides, __pyx_t_115, __pyx_pybuffernd_jhwr.diminfo[4].strides, __pyx_t_116, __pyx_pybuffernd_jhwr.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_jhwj.rcbuffer-&gt;pybuffer.buf, __pyx_t_117, __pyx_pybuffernd_jhwj.diminfo[0].strides, __pyx_t_118, __pyx_pybuffernd_jhwj.diminfo[1].strides, __pyx_t_119, __pyx_pybuffernd_jhwj.diminfo[2].strides, __pyx_t_120, __pyx_pybuffernd_jhwj.diminfo[3].strides, __pyx_t_121, __pyx_pybuffernd_jhwj.diminfo[4].strides, __pyx_t_122, __pyx_pybuffernd_jhwj.diminfo[5].strides))));
        }
      }
    }
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">282</span>:                                         jhwr[d,t,f,aa,1,1]*jhwj[d,t,f,aa,1,1]</pre>
<pre class='cython code score-0 '>          __pyx_t_111 = __pyx_v_d;
          __pyx_t_112 = __pyx_v_t;
          __pyx_t_113 = __pyx_v_f;
          __pyx_t_114 = __pyx_v_aa;
          __pyx_t_115 = 1;
          __pyx_t_116 = 1;
          __pyx_t_117 = __pyx_v_d;
          __pyx_t_118 = __pyx_v_t;
          __pyx_t_119 = __pyx_v_f;
          __pyx_t_120 = __pyx_v_aa;
          __pyx_t_121 = 1;
          __pyx_t_122 = 1;
/* … */
          __pyx_t_111 = __pyx_v_d;
          __pyx_t_112 = __pyx_v_t;
          __pyx_t_113 = __pyx_v_f;
          __pyx_t_114 = __pyx_v_aa;
          __pyx_t_115 = 1;
          __pyx_t_116 = 1;
          __pyx_t_117 = __pyx_v_d;
          __pyx_t_118 = __pyx_v_t;
          __pyx_t_119 = __pyx_v_f;
          __pyx_t_120 = __pyx_v_aa;
          __pyx_t_121 = 1;
          __pyx_t_122 = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">283</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">284</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">285</span>: @cython.cdivision(True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">286</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">287</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">288</span>: @cython.nonecheck(False)</pre>
<pre class="cython line score-671" onclick='toggleDiv(this)'>+<span class="">289</span>: def cycompute_corrected(np.ndarray[complex3264, ndim=6] o,</pre>
<pre class='cython code score-671 '>/* Python wrapper */
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_13cycompute_corrected(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_12cycompute_corrected[] = "\n    This computes the corrected visiblities, given the observed visiblities and the inverse of the \n    gains. Note that the observed array expected here MUST NOT have a model index. This is because \n    we only obtain a single gain estimate across all models and want to apply it to the raw the \n    visibility data.\n    ";
static PyMethodDef __pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_13cycompute_corrected = {"cycompute_corrected", (PyCFunction)__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_13cycompute_corrected, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_12cycompute_corrected};
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_13cycompute_corrected(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_signatures = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED PyObject *__pyx_v_defaults = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fused_cpdef (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_signatures,&amp;__pyx_n_s_args,&amp;__pyx_n_s_kwargs,&amp;__pyx_n_s_defaults,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_signatures)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_args)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_kwargs)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_defaults)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_fused_cpdef") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_signatures = values[0];
    __pyx_v_args = values[1];
    __pyx_v_kwargs = values[2];
    __pyx_v_defaults = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_12cycompute_corrected(__pyx_self, __pyx_v_signatures, __pyx_v_args, __pyx_v_kwargs, __pyx_v_defaults);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_12cycompute_corrected(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_signatures, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs, CYTHON_UNUSED PyObject *__pyx_v_defaults) {
  PyObject *__pyx_v_dest_sig = NULL;
  PyTypeObject *__pyx_v_ndarray = 0;
  PyObject *__pyx_v_numpy = NULL;
  __Pyx_memviewslice __pyx_v_memslice;
  Py_ssize_t __pyx_v_itemsize;
  CYTHON_UNUSED int __pyx_v_dtype_signed;
  char __pyx_v_kind;
  PyObject *__pyx_v_arg = NULL;
  PyObject *__pyx_v_dtype = NULL;
  PyObject *__pyx_v_arg_base = NULL;
  PyObject *__pyx_v_candidates = NULL;
  PyObject *__pyx_v_sig = NULL;
  int __pyx_v_match_found;
  PyObject *__pyx_v_src_type = NULL;
  PyObject *__pyx_v_dst_type = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_corrected", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kwargs);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, Py_None);
  __pyx_v_dest_sig = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_2 = (__pyx_v_kwargs == Py_None);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kwargs, __pyx_t_1);
    __pyx_t_1 = 0;
  }
  {
    /*try:*/ {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_v_numpy = __pyx_t_1;
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_numpy, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!(likely(<span class='py_c_api'>PyType_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "type", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      __pyx_v_ndarray = ((PyTypeObject*)__pyx_t_1);
      __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L11_try_end;
    __pyx_L4_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_ImportError) || <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_AttributeError) || <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_TypeError);
    if (__pyx_t_7) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_1, &amp;__pyx_t_8, &amp;__pyx_t_9) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L6_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ndarray, ((PyTypeObject*)Py_None));
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L5_exception_handled;
    }
    goto __pyx_L6_except_error;
    __pyx_L6_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    goto __pyx_L1_error;
    __pyx_L5_exception_handled:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    __pyx_L11_try_end:;
  }
  __pyx_v_itemsize = -1L;
  if (unlikely(__pyx_v_args == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = ((0 &lt; __pyx_t_10) != 0);
  if (__pyx_t_3) {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(((PyObject*)__pyx_v_args), 0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
    __pyx_v_arg = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L14;
  }
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyDict_ContainsTF</span>(__pyx_n_s_o, ((PyObject*)__pyx_v_kwargs), Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {
    if (unlikely(__pyx_v_kwargs == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_kwargs), __pyx_n_s_o);<span class='error_goto'> if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_v_arg = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L14;
  }
  /*else*/ {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_Expected_at_least_d_arguments, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_L14:;
  while (1) {
    __pyx_t_2 = (__pyx_v_ndarray != ((PyTypeObject*)Py_None));
    __pyx_t_3 = (__pyx_t_2 != 0);
    if (__pyx_t_3) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_arg, __pyx_v_ndarray); 
      __pyx_t_2 = (__pyx_t_3 != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_v_dtype = __pyx_t_8;
        __pyx_t_8 = 0;
        goto __pyx_L18;
      }
      __pyx_t_2 = (__pyx_memoryview_check(__pyx_v_arg) != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_base);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_v_arg_base = __pyx_t_8;
        __pyx_t_8 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_arg_base, __pyx_v_ndarray); 
        __pyx_t_3 = (__pyx_t_2 != 0);
        if (__pyx_t_3) {
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg_base, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_v_dtype = __pyx_t_8;
          __pyx_t_8 = 0;
          goto __pyx_L19;
        }
        /*else*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
          __pyx_v_dtype = Py_None;
        }
        __pyx_L19:;
        goto __pyx_L18;
      }
      /*else*/ {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
        __pyx_v_dtype = Py_None;
      }
      __pyx_L18:;
      __pyx_v_itemsize = -1L;
      __pyx_t_3 = (__pyx_v_dtype != Py_None);
      __pyx_t_2 = (__pyx_t_3 != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dtype, __pyx_n_s_itemsize);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_itemsize = __pyx_t_10;
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dtype, __pyx_n_s_kind);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Ord</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(__pyx_t_11 == (long)(Py_UCS4)-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_kind = __pyx_t_11;
        __pyx_v_dtype_signed = (__pyx_v_kind == 'i');
        switch (__pyx_v_kind) {
          case 'i':
          case 'u':
          break;
          case 'f':
          break;
          case 'c':
          __pyx_t_3 = (((sizeof(__pyx_t_float_complex)) == __pyx_v_itemsize) != 0);
          if (__pyx_t_3) {
          } else {
            __pyx_t_2 = __pyx_t_3;
            goto __pyx_L22_bool_binop_done;
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_3 = ((((Py_ssize_t)__pyx_t_10) == 6) != 0);
          __pyx_t_2 = __pyx_t_3;
          __pyx_L22_bool_binop_done:;
          if (__pyx_t_2) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            goto __pyx_L16_break;
          }
          __pyx_t_3 = (((sizeof(__pyx_t_double_complex)) == __pyx_v_itemsize) != 0);
          if (__pyx_t_3) {
          } else {
            __pyx_t_2 = __pyx_t_3;
            goto __pyx_L25_bool_binop_done;
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_3 = ((((Py_ssize_t)__pyx_t_10) == 6) != 0);
          __pyx_t_2 = __pyx_t_3;
          __pyx_L25_bool_binop_done:;
          if (__pyx_t_2) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            goto __pyx_L16_break;
          }
          break;
          case 'O':
          break;
          default: break;
        }
      }
    }
    __pyx_t_3 = ((__pyx_v_itemsize == -1L) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L28_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_itemsize == (sizeof(__pyx_t_float_complex))) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L28_bool_binop_done:;
    if (__pyx_t_2) {
      __pyx_v_memslice = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsdsds___pyx_t_float_complex</span>(__pyx_v_arg);
      __pyx_t_2 = (__pyx_v_memslice.memview != 0);
      if (__pyx_t_2) {
        __PYX_XDEC_MEMVIEW((&amp;__pyx_v_memslice), 1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L16_break;
      }
      /*else*/ {
        <span class='py_c_api'>PyErr_Clear</span>();
      }
    }
    __pyx_t_3 = ((__pyx_v_itemsize == -1L) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L32_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_itemsize == (sizeof(__pyx_t_double_complex))) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L32_bool_binop_done:;
    if (__pyx_t_2) {
      __pyx_v_memslice = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsdsds___pyx_t_double_complex</span>(__pyx_v_arg);
      __pyx_t_2 = (__pyx_v_memslice.memview != 0);
      if (__pyx_t_2) {
        __PYX_XDEC_MEMVIEW((&amp;__pyx_v_memslice), 1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L16_break;
      }
      /*else*/ {
        <span class='py_c_api'>PyErr_Clear</span>();
      }
    }
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, Py_None, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L16_break;
  }
  __pyx_L16_break:;
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_v_candidates = ((PyObject*)__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_10 = 0;
  if (unlikely(__pyx_v_signatures == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_9 = __Pyx_dict_iterator(((PyObject*)__pyx_v_signatures), 1, ((PyObject *)NULL), (&amp;__pyx_t_12), (&amp;__pyx_t_7));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __pyx_t_8 = __pyx_t_9;
  __pyx_t_9 = 0;
  while (1) {
    __pyx_t_13 = __Pyx_dict_iter_next(__pyx_t_8, __pyx_t_12, &amp;__pyx_t_10, &amp;__pyx_t_9, NULL, NULL, __pyx_t_7);
    if (unlikely(__pyx_t_13 == 0)) break;
    if (unlikely(__pyx_t_13 == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_sig, __pyx_t_9);
    __pyx_t_9 = 0;
    __pyx_v_match_found = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_sig, __pyx_n_s_strip);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__27, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_split);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__27 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_);<span class='error_goto'> if (unlikely(!__pyx_tuple__27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__27);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__27);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__28, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dest_sig);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dest_sig);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_dest_sig);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_9 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_14 = 0;
      __pyx_t_15 = NULL;
    } else {
      __pyx_t_14 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_15 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_15)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_15(__pyx_t_9);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        PyObject* sequence = __pyx_t_1;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_16 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_17 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_16 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_17 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
        #else
        __pyx_t_16 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        __pyx_t_17 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_18 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_19 = Py_TYPE(__pyx_t_18)-&gt;tp_iternext;
        index = 0; __pyx_t_16 = __pyx_t_19(__pyx_t_18); if (unlikely(!__pyx_t_16)) goto __pyx_L39_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        index = 1; __pyx_t_17 = __pyx_t_19(__pyx_t_18); if (unlikely(!__pyx_t_17)) goto __pyx_L39_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_19(__pyx_t_18), 2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_19 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        goto __pyx_L40_unpacking_done;
        __pyx_L39_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_t_19 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_L40_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_src_type, __pyx_t_16);
      __pyx_t_16 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dst_type, __pyx_t_17);
      __pyx_t_17 = 0;
      __pyx_t_2 = (__pyx_v_dst_type != Py_None);
      __pyx_t_3 = (__pyx_t_2 != 0);
      if (__pyx_t_3) {
        __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_src_type, __pyx_v_dst_type, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (__pyx_t_3) {
          __pyx_v_match_found = 1;
          goto __pyx_L42;
        }
        /*else*/ {
          __pyx_v_match_found = 0;
          goto __pyx_L38_break;
        }
        __pyx_L42:;
      }
    }
    __pyx_L38_break:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_3 = (__pyx_v_match_found != 0);
    if (__pyx_t_3) {
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_candidates, __pyx_v_sig);<span class='error_goto'> if (unlikely(__pyx_t_20 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_3 = (__pyx_v_candidates != Py_None) &amp;&amp; (<span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates) != 0);
  __pyx_t_2 = ((!__pyx_t_3) != 0);
  if (__pyx_t_2) {
  __pyx_tuple__28 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s__3);<span class='error_goto'> if (unlikely(!__pyx_tuple__28)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__28);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__28);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__29, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_12 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates);<span class='error_goto'> if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = ((__pyx_t_12 &gt; 1) != 0);
  if (__pyx_t_2) {
  __pyx_tuple__29 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_No_matching_signature_found);<span class='error_goto'> if (unlikely(!__pyx_tuple__29)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__29);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__29);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__30, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(__pyx_v_signatures == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_signatures), <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_candidates, 0));<span class='error_goto'> if (unlikely(__pyx_t_8 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_r = __pyx_t_8;
    __pyx_t_8 = 0;
    goto __pyx_L0;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dest_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_numpy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dtype);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg_base);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_candidates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_src_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dst_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_53cycompute_corrected(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_fuse_0__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_53cycompute_corrected = {"__pyx_fuse_0cycompute_corrected", (PyCFunction)__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_53cycompute_corrected, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_12cycompute_corrected};
static PyObject *__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_53cycompute_corrected(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_o = 0;
  PyArrayObject *__pyx_v_g = 0;
  PyArrayObject *__pyx_v_gh = 0;
  PyArrayObject *__pyx_v_corr = 0;
  int __pyx_v_t_int;
  int __pyx_v_f_int;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_corrected (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_o,&amp;__pyx_n_s_g,&amp;__pyx_n_s_gh,&amp;__pyx_n_s_corr,&amp;__pyx_n_s_t_int,&amp;__pyx_n_s_f_int,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_o)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_g)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_corrected", 1, 6, 6, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_gh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_corrected", 1, 6, 6, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_corr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_corrected", 1, 6, 6, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_t_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_corrected", 1, 6, 6, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_corrected", 1, 6, 6, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cycompute_corrected") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 6) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
    }
    __pyx_v_o = ((PyArrayObject *)values[0]);
    __pyx_v_g = ((PyArrayObject *)values[1]);
    __pyx_v_gh = ((PyArrayObject *)values[2]);
    __pyx_v_corr = ((PyArrayObject *)values[3]);
    __pyx_v_t_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_t_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_f_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_f_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_corrected", 1, 6, 6, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_corrected", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_o), __pyx_ptype_5numpy_ndarray, 1, "o", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_gh), __pyx_ptype_5numpy_ndarray, 1, "gh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_corr), __pyx_ptype_5numpy_ndarray, 1, "corr", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_52cycompute_corrected(__pyx_self, __pyx_v_o, __pyx_v_g, __pyx_v_gh, __pyx_v_corr, __pyx_v_t_int, __pyx_v_f_int);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_52cycompute_corrected(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_o, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_gh, PyArrayObject *__pyx_v_corr, int __pyx_v_t_int, int __pyx_v_f_int) {
  int __pyx_v_d;
  int __pyx_v_t;
  int __pyx_v_f;
  int __pyx_v_aa;
  int __pyx_v_ab;
  int __pyx_v_rr;
  int __pyx_v_rc;
  int __pyx_v_n_dir;
  int __pyx_v_n_tim;
  int __pyx_v_n_fre;
  int __pyx_v_n_ant;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_corr;
  __Pyx_Buffer __pyx_pybuffer_corr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_g;
  __Pyx_Buffer __pyx_pybuffer_g;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_gh;
  __Pyx_Buffer __pyx_pybuffer_gh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_o;
  __Pyx_Buffer __pyx_pybuffer_o;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_0cycompute_corrected", 0);
  __pyx_pybuffer_o.pybuffer.buf = NULL;
  __pyx_pybuffer_o.refcount = 0;
  __pyx_pybuffernd_o.data = NULL;
  __pyx_pybuffernd_o.rcbuffer = &amp;__pyx_pybuffer_o;
  __pyx_pybuffer_g.pybuffer.buf = NULL;
  __pyx_pybuffer_g.refcount = 0;
  __pyx_pybuffernd_g.data = NULL;
  __pyx_pybuffernd_g.rcbuffer = &amp;__pyx_pybuffer_g;
  __pyx_pybuffer_gh.pybuffer.buf = NULL;
  __pyx_pybuffer_gh.refcount = 0;
  __pyx_pybuffernd_gh.data = NULL;
  __pyx_pybuffernd_gh.rcbuffer = &amp;__pyx_pybuffer_gh;
  __pyx_pybuffer_corr.pybuffer.buf = NULL;
  __pyx_pybuffer_corr.refcount = 0;
  __pyx_pybuffernd_corr.data = NULL;
  __pyx_pybuffernd_corr.rcbuffer = &amp;__pyx_pybuffer_corr;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_o.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_o, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_o.diminfo[0].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_o.diminfo[0].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_o.diminfo[1].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_o.diminfo[1].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_o.diminfo[2].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_o.diminfo[2].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_o.diminfo[3].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_o.diminfo[3].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_o.diminfo[4].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_o.diminfo[4].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_o.diminfo[5].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_o.diminfo[5].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_g, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_g.diminfo[0].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_g.diminfo[0].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_g.diminfo[1].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_g.diminfo[1].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_g.diminfo[2].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_g.diminfo[2].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_g.diminfo[3].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_g.diminfo[3].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_g.diminfo[4].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_g.diminfo[4].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_g.diminfo[5].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_g.diminfo[5].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_gh, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_gh.diminfo[0].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_gh.diminfo[0].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_gh.diminfo[1].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_gh.diminfo[1].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_gh.diminfo[2].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_gh.diminfo[2].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_gh.diminfo[3].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_gh.diminfo[3].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_gh.diminfo[4].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_gh.diminfo[4].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_gh.diminfo[5].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_gh.diminfo[5].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_corr, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_corr.diminfo[0].strides = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_corr.diminfo[0].shape = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_corr.diminfo[1].strides = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_corr.diminfo[1].shape = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_corr.diminfo[2].strides = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_corr.diminfo[2].shape = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_corr.diminfo[3].strides = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_corr.diminfo[3].shape = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_corr.diminfo[4].strides = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_corr.diminfo[4].shape = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_corr.diminfo[5].strides = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_corr.diminfo[5].shape = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.shape[5];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_o.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_corrected", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_o.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_55cycompute_corrected(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_fuse_1__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_55cycompute_corrected = {"__pyx_fuse_1cycompute_corrected", (PyCFunction)__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_55cycompute_corrected, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_12cycompute_corrected};
static PyObject *__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_55cycompute_corrected(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_o = 0;
  PyArrayObject *__pyx_v_g = 0;
  PyArrayObject *__pyx_v_gh = 0;
  PyArrayObject *__pyx_v_corr = 0;
  int __pyx_v_t_int;
  int __pyx_v_f_int;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_corrected (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_o,&amp;__pyx_n_s_g,&amp;__pyx_n_s_gh,&amp;__pyx_n_s_corr,&amp;__pyx_n_s_t_int,&amp;__pyx_n_s_f_int,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_o)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_g)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_corrected", 1, 6, 6, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_gh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_corrected", 1, 6, 6, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_corr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_corrected", 1, 6, 6, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_t_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_corrected", 1, 6, 6, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_corrected", 1, 6, 6, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cycompute_corrected") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 6) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
    }
    __pyx_v_o = ((PyArrayObject *)values[0]);
    __pyx_v_g = ((PyArrayObject *)values[1]);
    __pyx_v_gh = ((PyArrayObject *)values[2]);
    __pyx_v_corr = ((PyArrayObject *)values[3]);
    __pyx_v_t_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_t_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_f_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_f_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_corrected", 1, 6, 6, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_corrected", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_o), __pyx_ptype_5numpy_ndarray, 1, "o", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_gh), __pyx_ptype_5numpy_ndarray, 1, "gh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_corr), __pyx_ptype_5numpy_ndarray, 1, "corr", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_54cycompute_corrected(__pyx_self, __pyx_v_o, __pyx_v_g, __pyx_v_gh, __pyx_v_corr, __pyx_v_t_int, __pyx_v_f_int);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_54cycompute_corrected(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_o, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_gh, PyArrayObject *__pyx_v_corr, int __pyx_v_t_int, int __pyx_v_f_int) {
  int __pyx_v_d;
  int __pyx_v_t;
  int __pyx_v_f;
  int __pyx_v_aa;
  int __pyx_v_ab;
  int __pyx_v_rr;
  int __pyx_v_rc;
  int __pyx_v_n_dir;
  int __pyx_v_n_tim;
  int __pyx_v_n_fre;
  int __pyx_v_n_ant;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_corr;
  __Pyx_Buffer __pyx_pybuffer_corr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_g;
  __Pyx_Buffer __pyx_pybuffer_g;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_gh;
  __Pyx_Buffer __pyx_pybuffer_gh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_o;
  __Pyx_Buffer __pyx_pybuffer_o;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_1cycompute_corrected", 0);
  __pyx_pybuffer_o.pybuffer.buf = NULL;
  __pyx_pybuffer_o.refcount = 0;
  __pyx_pybuffernd_o.data = NULL;
  __pyx_pybuffernd_o.rcbuffer = &amp;__pyx_pybuffer_o;
  __pyx_pybuffer_g.pybuffer.buf = NULL;
  __pyx_pybuffer_g.refcount = 0;
  __pyx_pybuffernd_g.data = NULL;
  __pyx_pybuffernd_g.rcbuffer = &amp;__pyx_pybuffer_g;
  __pyx_pybuffer_gh.pybuffer.buf = NULL;
  __pyx_pybuffer_gh.refcount = 0;
  __pyx_pybuffernd_gh.data = NULL;
  __pyx_pybuffernd_gh.rcbuffer = &amp;__pyx_pybuffer_gh;
  __pyx_pybuffer_corr.pybuffer.buf = NULL;
  __pyx_pybuffer_corr.refcount = 0;
  __pyx_pybuffernd_corr.data = NULL;
  __pyx_pybuffernd_corr.rcbuffer = &amp;__pyx_pybuffer_corr;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_o.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_o, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_o.diminfo[0].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_o.diminfo[0].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_o.diminfo[1].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_o.diminfo[1].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_o.diminfo[2].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_o.diminfo[2].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_o.diminfo[3].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_o.diminfo[3].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_o.diminfo[4].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_o.diminfo[4].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_o.diminfo[5].strides = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_o.diminfo[5].shape = __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_g, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_g.diminfo[0].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_g.diminfo[0].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_g.diminfo[1].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_g.diminfo[1].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_g.diminfo[2].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_g.diminfo[2].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_g.diminfo[3].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_g.diminfo[3].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_g.diminfo[4].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_g.diminfo[4].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_g.diminfo[5].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_g.diminfo[5].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_gh, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_gh.diminfo[0].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_gh.diminfo[0].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_gh.diminfo[1].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_gh.diminfo[1].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_gh.diminfo[2].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_gh.diminfo[2].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_gh.diminfo[3].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_gh.diminfo[3].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_gh.diminfo[4].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_gh.diminfo[4].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_gh.diminfo[5].strides = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_gh.diminfo[5].shape = __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.shape[5];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_corr, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 6, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_corr.diminfo[0].strides = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_corr.diminfo[0].shape = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_corr.diminfo[1].strides = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_corr.diminfo[1].shape = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_corr.diminfo[2].strides = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_corr.diminfo[2].shape = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_corr.diminfo[3].strides = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_corr.diminfo[3].shape = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_corr.diminfo[4].strides = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_corr.diminfo[4].shape = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_corr.diminfo[5].strides = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_corr.diminfo[5].shape = __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.shape[5];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_o.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_corrected", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_o.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
  __pyx_tuple__30 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Function_call_with_ambiguous_arg);<span class='error_goto'> if (unlikely(!__pyx_tuple__30)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__30);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__30);
/* … */
  __pyx_tuple__70 = <span class='py_c_api'>PyTuple_Pack</span>(17, __pyx_n_s_o, __pyx_n_s_g, __pyx_n_s_gh, __pyx_n_s_corr, __pyx_n_s_t_int, __pyx_n_s_f_int, __pyx_n_s_d, __pyx_n_s_t, __pyx_n_s_f, __pyx_n_s_aa, __pyx_n_s_ab, __pyx_n_s_rr, __pyx_n_s_rc, __pyx_n_s_n_dir, __pyx_n_s_n_tim, __pyx_n_s_n_fre, __pyx_n_s_n_ant);<span class='error_goto'> if (unlikely(!__pyx_tuple__70)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__70);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__70);
/* … */
  __pyx_t_13 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_14 = __pyx_FusedFunction_NewEx(&amp;__pyx_fuse_0__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_53cycompute_corrected, 0, __pyx_n_s_cycompute_corrected, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__71));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_14, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_kp_s_float_complex, __pyx_t_14) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_t_14 = __pyx_FusedFunction_NewEx(&amp;__pyx_fuse_1__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_55cycompute_corrected, 0, __pyx_n_s_cycompute_corrected, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__71));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_14, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_kp_s_double_complex, __pyx_t_14) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_t_14 = __pyx_FusedFunction_NewEx(&amp;__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_13cycompute_corrected, 0, __pyx_n_s_cycompute_corrected, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__71));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_14, __pyx_empty_tuple);
  ((__pyx_FusedFunctionObject *) __pyx_t_14)-&gt;__signatures__ = __pyx_t_13;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_cycompute_corrected, __pyx_t_14) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_codeobj__71 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(6, 0, 17, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__70, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_ulrich_CubeCal_cubecal_ker, __pyx_n_s_cycompute_corrected, 289, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__71)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">290</span>:                         np.ndarray[complex3264, ndim=6] g,</pre>
<pre class="cython line score-0">&#xA0;<span class="">291</span>:                         np.ndarray[complex3264, ndim=6] gh,</pre>
<pre class="cython line score-0">&#xA0;<span class="">292</span>:                         np.ndarray[complex3264, ndim=6] corr,</pre>
<pre class="cython line score-0">&#xA0;<span class="">293</span>:                         int t_int,</pre>
<pre class="cython line score-0">&#xA0;<span class="">294</span>:                         int f_int):</pre>
<pre class="cython line score-0">&#xA0;<span class="">295</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">296</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">297</span>:     This computes the corrected visiblities, given the observed visiblities and the inverse of the</pre>
<pre class="cython line score-0">&#xA0;<span class="">298</span>:     gains. Note that the observed array expected here MUST NOT have a model index. This is because</pre>
<pre class="cython line score-0">&#xA0;<span class="">299</span>:     we only obtain a single gain estimate across all models and want to apply it to the raw the</pre>
<pre class="cython line score-0">&#xA0;<span class="">300</span>:     visibility data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">301</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">302</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">303</span>:     cdef int d, t, f, aa, ab, rr, rc = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_rc = 0;
/* … */
  __pyx_v_rc = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">304</span>:     cdef int n_dir, n_tim, n_fre, n_ant</pre>
<pre class="cython line score-0">&#xA0;<span class="">305</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">306</span>:     n_dir = g.shape[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_dir = (__pyx_v_g-&gt;dimensions[0]);
/* … */
  __pyx_v_n_dir = (__pyx_v_g-&gt;dimensions[0]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">307</span>:     n_tim = o.shape[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_tim = (__pyx_v_o-&gt;dimensions[0]);
/* … */
  __pyx_v_n_tim = (__pyx_v_o-&gt;dimensions[0]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">308</span>:     n_fre = o.shape[1]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_fre = (__pyx_v_o-&gt;dimensions[1]);
/* … */
  __pyx_v_n_fre = (__pyx_v_o-&gt;dimensions[1]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">309</span>:     n_ant = o.shape[2]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_ant = (__pyx_v_o-&gt;dimensions[2]);
/* … */
  __pyx_v_n_ant = (__pyx_v_o-&gt;dimensions[2]);
</pre><pre class="cython line score-0">&#xA0;<span class="">310</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">311</span>:     for d in xrange(n_dir):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_n_dir;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
/* … */
  __pyx_t_1 = __pyx_v_n_dir;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">312</span>:         for t in xrange(n_tim):</pre>
<pre class='cython code score-0 '>    __pyx_t_3 = __pyx_v_n_tim;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_t = __pyx_t_4;
/* … */
    __pyx_t_3 = __pyx_v_n_tim;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_t = __pyx_t_4;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">313</span>:             rr = t/t_int</pre>
<pre class='cython code score-0 '>      __pyx_v_rr = (__pyx_v_t / __pyx_v_t_int);
/* … */
      __pyx_v_rr = (__pyx_v_t / __pyx_v_t_int);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">314</span>:             for f in xrange(n_fre):</pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_n_fre;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_f = __pyx_t_6;
/* … */
      __pyx_t_5 = __pyx_v_n_fre;
      for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_f = __pyx_t_6;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">315</span>:                 rc = f/f_int</pre>
<pre class='cython code score-0 '>        __pyx_v_rc = (__pyx_v_f / __pyx_v_f_int);
/* … */
        __pyx_v_rc = (__pyx_v_f / __pyx_v_f_int);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">316</span>:                 for aa in xrange(n_ant):</pre>
<pre class='cython code score-0 '>        __pyx_t_7 = __pyx_v_n_ant;
        for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_aa = __pyx_t_8;
/* … */
        __pyx_t_7 = __pyx_v_n_ant;
        for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_aa = __pyx_t_8;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">317</span>:                     for ab in xrange(n_ant):</pre>
<pre class='cython code score-0 '>          __pyx_t_9 = __pyx_v_n_ant;
          for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
            __pyx_v_ab = __pyx_t_10;
/* … */
          __pyx_t_9 = __pyx_v_n_ant;
          for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
            __pyx_v_ab = __pyx_t_10;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">318</span>:                         corr[t,f,aa,ab,0,0] = \</pre>
<pre class='cython code score-0 '>            __pyx_t_83 = __pyx_v_t;
            __pyx_t_84 = __pyx_v_f;
            __pyx_t_85 = __pyx_v_aa;
            __pyx_t_86 = __pyx_v_ab;
            __pyx_t_87 = 0;
            __pyx_t_88 = 0;
            *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.buf, __pyx_t_83, __pyx_pybuffernd_corr.diminfo[0].strides, __pyx_t_84, __pyx_pybuffernd_corr.diminfo[1].strides, __pyx_t_85, __pyx_pybuffernd_corr.diminfo[2].strides, __pyx_t_86, __pyx_pybuffernd_corr.diminfo[3].strides, __pyx_t_87, __pyx_pybuffernd_corr.diminfo[4].strides, __pyx_t_88, __pyx_pybuffernd_corr.diminfo[5].strides) = __Pyx_c_sumf(__Pyx_c_sumf(__Pyx_c_sumf(__Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_13, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_14, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_15, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_16, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_19, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_20, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_21, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_22, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_24, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_25, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_26, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_27, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_28, __pyx_pybuffernd_gh.diminfo[5].strides))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_30, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_31, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_32, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_33, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_34, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_35, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_36, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_37, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_38, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_39, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_40, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_41, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_42, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_43, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_44, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_45, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_46, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_47, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_48, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_49, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_50, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_51, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_52, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_53, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_54, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_55, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_56, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_57, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_58, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_59, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_60, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_61, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_62, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_63, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_64, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_65, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_66, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_67, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_68, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_69, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_70, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_71, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_72, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_73, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_74, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_75, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_76, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_77, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_78, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_79, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_80, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_81, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_82, __pyx_pybuffernd_gh.diminfo[5].strides))));
/* … */
            __pyx_t_83 = __pyx_v_t;
            __pyx_t_84 = __pyx_v_f;
            __pyx_t_85 = __pyx_v_aa;
            __pyx_t_86 = __pyx_v_ab;
            __pyx_t_87 = 0;
            __pyx_t_88 = 0;
            *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.buf, __pyx_t_83, __pyx_pybuffernd_corr.diminfo[0].strides, __pyx_t_84, __pyx_pybuffernd_corr.diminfo[1].strides, __pyx_t_85, __pyx_pybuffernd_corr.diminfo[2].strides, __pyx_t_86, __pyx_pybuffernd_corr.diminfo[3].strides, __pyx_t_87, __pyx_pybuffernd_corr.diminfo[4].strides, __pyx_t_88, __pyx_pybuffernd_corr.diminfo[5].strides) = __Pyx_c_sum(__Pyx_c_sum(__Pyx_c_sum(__Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_13, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_14, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_15, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_16, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_19, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_20, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_21, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_22, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_24, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_25, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_26, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_27, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_28, __pyx_pybuffernd_gh.diminfo[5].strides))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_30, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_31, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_32, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_33, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_34, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_35, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_36, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_37, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_38, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_39, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_40, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_41, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_42, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_43, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_44, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_45, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_46, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_47, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_48, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_49, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_50, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_51, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_52, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_53, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_54, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_55, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_56, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_57, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_58, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_59, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_60, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_61, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_62, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_63, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_64, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_65, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_66, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_67, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_68, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_69, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_70, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_71, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_72, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_73, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_74, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_75, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_76, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_77, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_78, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_79, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_80, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_81, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_82, __pyx_pybuffernd_gh.diminfo[5].strides))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">319</span>:                         g[d,rr,rc,aa,0,0]*o[t,f,aa,ab,0,0]*gh[d,rr,rc,ab,0,0] + \</pre>
<pre class='cython code score-0 '>            __pyx_t_11 = __pyx_v_d;
            __pyx_t_12 = __pyx_v_rr;
            __pyx_t_13 = __pyx_v_rc;
            __pyx_t_14 = __pyx_v_aa;
            __pyx_t_15 = 0;
            __pyx_t_16 = 0;
            __pyx_t_17 = __pyx_v_t;
            __pyx_t_18 = __pyx_v_f;
            __pyx_t_19 = __pyx_v_aa;
            __pyx_t_20 = __pyx_v_ab;
            __pyx_t_21 = 0;
            __pyx_t_22 = 0;
            __pyx_t_23 = __pyx_v_d;
            __pyx_t_24 = __pyx_v_rr;
            __pyx_t_25 = __pyx_v_rc;
            __pyx_t_26 = __pyx_v_ab;
            __pyx_t_27 = 0;
            __pyx_t_28 = 0;
/* … */
            __pyx_t_11 = __pyx_v_d;
            __pyx_t_12 = __pyx_v_rr;
            __pyx_t_13 = __pyx_v_rc;
            __pyx_t_14 = __pyx_v_aa;
            __pyx_t_15 = 0;
            __pyx_t_16 = 0;
            __pyx_t_17 = __pyx_v_t;
            __pyx_t_18 = __pyx_v_f;
            __pyx_t_19 = __pyx_v_aa;
            __pyx_t_20 = __pyx_v_ab;
            __pyx_t_21 = 0;
            __pyx_t_22 = 0;
            __pyx_t_23 = __pyx_v_d;
            __pyx_t_24 = __pyx_v_rr;
            __pyx_t_25 = __pyx_v_rc;
            __pyx_t_26 = __pyx_v_ab;
            __pyx_t_27 = 0;
            __pyx_t_28 = 0;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">320</span>:                         g[d,rr,rc,aa,0,1]*o[t,f,aa,ab,1,0]*gh[d,rr,rc,ab,0,0] + \</pre>
<pre class='cython code score-0 '>            __pyx_t_29 = __pyx_v_d;
            __pyx_t_30 = __pyx_v_rr;
            __pyx_t_31 = __pyx_v_rc;
            __pyx_t_32 = __pyx_v_aa;
            __pyx_t_33 = 0;
            __pyx_t_34 = 1;
            __pyx_t_35 = __pyx_v_t;
            __pyx_t_36 = __pyx_v_f;
            __pyx_t_37 = __pyx_v_aa;
            __pyx_t_38 = __pyx_v_ab;
            __pyx_t_39 = 1;
            __pyx_t_40 = 0;
            __pyx_t_41 = __pyx_v_d;
            __pyx_t_42 = __pyx_v_rr;
            __pyx_t_43 = __pyx_v_rc;
            __pyx_t_44 = __pyx_v_ab;
            __pyx_t_45 = 0;
            __pyx_t_46 = 0;
/* … */
            __pyx_t_29 = __pyx_v_d;
            __pyx_t_30 = __pyx_v_rr;
            __pyx_t_31 = __pyx_v_rc;
            __pyx_t_32 = __pyx_v_aa;
            __pyx_t_33 = 0;
            __pyx_t_34 = 1;
            __pyx_t_35 = __pyx_v_t;
            __pyx_t_36 = __pyx_v_f;
            __pyx_t_37 = __pyx_v_aa;
            __pyx_t_38 = __pyx_v_ab;
            __pyx_t_39 = 1;
            __pyx_t_40 = 0;
            __pyx_t_41 = __pyx_v_d;
            __pyx_t_42 = __pyx_v_rr;
            __pyx_t_43 = __pyx_v_rc;
            __pyx_t_44 = __pyx_v_ab;
            __pyx_t_45 = 0;
            __pyx_t_46 = 0;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">321</span>:                         g[d,rr,rc,aa,0,0]*o[t,f,aa,ab,0,1]*gh[d,rr,rc,ab,1,0] + \</pre>
<pre class='cython code score-0 '>            __pyx_t_47 = __pyx_v_d;
            __pyx_t_48 = __pyx_v_rr;
            __pyx_t_49 = __pyx_v_rc;
            __pyx_t_50 = __pyx_v_aa;
            __pyx_t_51 = 0;
            __pyx_t_52 = 0;
            __pyx_t_53 = __pyx_v_t;
            __pyx_t_54 = __pyx_v_f;
            __pyx_t_55 = __pyx_v_aa;
            __pyx_t_56 = __pyx_v_ab;
            __pyx_t_57 = 0;
            __pyx_t_58 = 1;
            __pyx_t_59 = __pyx_v_d;
            __pyx_t_60 = __pyx_v_rr;
            __pyx_t_61 = __pyx_v_rc;
            __pyx_t_62 = __pyx_v_ab;
            __pyx_t_63 = 1;
            __pyx_t_64 = 0;
/* … */
            __pyx_t_47 = __pyx_v_d;
            __pyx_t_48 = __pyx_v_rr;
            __pyx_t_49 = __pyx_v_rc;
            __pyx_t_50 = __pyx_v_aa;
            __pyx_t_51 = 0;
            __pyx_t_52 = 0;
            __pyx_t_53 = __pyx_v_t;
            __pyx_t_54 = __pyx_v_f;
            __pyx_t_55 = __pyx_v_aa;
            __pyx_t_56 = __pyx_v_ab;
            __pyx_t_57 = 0;
            __pyx_t_58 = 1;
            __pyx_t_59 = __pyx_v_d;
            __pyx_t_60 = __pyx_v_rr;
            __pyx_t_61 = __pyx_v_rc;
            __pyx_t_62 = __pyx_v_ab;
            __pyx_t_63 = 1;
            __pyx_t_64 = 0;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">322</span>:                         g[d,rr,rc,aa,0,1]*o[t,f,aa,ab,1,1]*gh[d,rr,rc,ab,1,0]</pre>
<pre class='cython code score-0 '>            __pyx_t_65 = __pyx_v_d;
            __pyx_t_66 = __pyx_v_rr;
            __pyx_t_67 = __pyx_v_rc;
            __pyx_t_68 = __pyx_v_aa;
            __pyx_t_69 = 0;
            __pyx_t_70 = 1;
            __pyx_t_71 = __pyx_v_t;
            __pyx_t_72 = __pyx_v_f;
            __pyx_t_73 = __pyx_v_aa;
            __pyx_t_74 = __pyx_v_ab;
            __pyx_t_75 = 1;
            __pyx_t_76 = 1;
            __pyx_t_77 = __pyx_v_d;
            __pyx_t_78 = __pyx_v_rr;
            __pyx_t_79 = __pyx_v_rc;
            __pyx_t_80 = __pyx_v_ab;
            __pyx_t_81 = 1;
            __pyx_t_82 = 0;
/* … */
            __pyx_t_65 = __pyx_v_d;
            __pyx_t_66 = __pyx_v_rr;
            __pyx_t_67 = __pyx_v_rc;
            __pyx_t_68 = __pyx_v_aa;
            __pyx_t_69 = 0;
            __pyx_t_70 = 1;
            __pyx_t_71 = __pyx_v_t;
            __pyx_t_72 = __pyx_v_f;
            __pyx_t_73 = __pyx_v_aa;
            __pyx_t_74 = __pyx_v_ab;
            __pyx_t_75 = 1;
            __pyx_t_76 = 1;
            __pyx_t_77 = __pyx_v_d;
            __pyx_t_78 = __pyx_v_rr;
            __pyx_t_79 = __pyx_v_rc;
            __pyx_t_80 = __pyx_v_ab;
            __pyx_t_81 = 1;
            __pyx_t_82 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">323</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">324</span>:                         corr[t,f,aa,ab,0,1] = \</pre>
<pre class='cython code score-0 '>            __pyx_t_161 = __pyx_v_t;
            __pyx_t_162 = __pyx_v_f;
            __pyx_t_163 = __pyx_v_aa;
            __pyx_t_164 = __pyx_v_ab;
            __pyx_t_165 = 0;
            __pyx_t_166 = 1;
            *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.buf, __pyx_t_161, __pyx_pybuffernd_corr.diminfo[0].strides, __pyx_t_162, __pyx_pybuffernd_corr.diminfo[1].strides, __pyx_t_163, __pyx_pybuffernd_corr.diminfo[2].strides, __pyx_t_164, __pyx_pybuffernd_corr.diminfo[3].strides, __pyx_t_165, __pyx_pybuffernd_corr.diminfo[4].strides, __pyx_t_166, __pyx_pybuffernd_corr.diminfo[5].strides) = __Pyx_c_sumf(__Pyx_c_sumf(__Pyx_c_sumf(__Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_89, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_90, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_91, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_92, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_93, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_94, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_95, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_96, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_97, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_98, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_99, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_100, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_101, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_102, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_103, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_104, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_105, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_106, __pyx_pybuffernd_gh.diminfo[5].strides))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_107, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_108, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_109, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_110, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_111, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_112, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_113, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_114, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_115, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_116, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_117, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_118, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_119, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_120, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_121, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_122, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_123, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_124, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_125, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_126, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_127, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_128, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_129, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_130, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_131, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_132, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_133, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_134, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_135, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_136, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_137, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_138, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_139, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_140, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_141, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_142, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_143, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_144, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_145, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_146, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_147, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_148, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_149, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_150, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_151, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_152, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_153, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_154, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_155, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_156, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_157, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_158, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_159, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_160, __pyx_pybuffernd_gh.diminfo[5].strides))));
/* … */
            __pyx_t_161 = __pyx_v_t;
            __pyx_t_162 = __pyx_v_f;
            __pyx_t_163 = __pyx_v_aa;
            __pyx_t_164 = __pyx_v_ab;
            __pyx_t_165 = 0;
            __pyx_t_166 = 1;
            *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.buf, __pyx_t_161, __pyx_pybuffernd_corr.diminfo[0].strides, __pyx_t_162, __pyx_pybuffernd_corr.diminfo[1].strides, __pyx_t_163, __pyx_pybuffernd_corr.diminfo[2].strides, __pyx_t_164, __pyx_pybuffernd_corr.diminfo[3].strides, __pyx_t_165, __pyx_pybuffernd_corr.diminfo[4].strides, __pyx_t_166, __pyx_pybuffernd_corr.diminfo[5].strides) = __Pyx_c_sum(__Pyx_c_sum(__Pyx_c_sum(__Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_89, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_90, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_91, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_92, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_93, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_94, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_95, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_96, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_97, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_98, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_99, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_100, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_101, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_102, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_103, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_104, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_105, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_106, __pyx_pybuffernd_gh.diminfo[5].strides))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_107, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_108, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_109, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_110, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_111, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_112, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_113, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_114, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_115, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_116, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_117, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_118, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_119, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_120, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_121, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_122, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_123, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_124, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_125, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_126, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_127, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_128, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_129, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_130, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_131, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_132, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_133, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_134, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_135, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_136, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_137, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_138, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_139, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_140, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_141, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_142, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_143, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_144, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_145, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_146, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_147, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_148, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_149, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_150, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_151, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_152, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_153, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_154, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_155, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_156, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_157, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_158, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_159, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_160, __pyx_pybuffernd_gh.diminfo[5].strides))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">325</span>:                         g[d,rr,rc,aa,0,0]*o[t,f,aa,ab,0,0]*gh[d,rr,rc,ab,0,1] + \</pre>
<pre class='cython code score-0 '>            __pyx_t_89 = __pyx_v_d;
            __pyx_t_90 = __pyx_v_rr;
            __pyx_t_91 = __pyx_v_rc;
            __pyx_t_92 = __pyx_v_aa;
            __pyx_t_93 = 0;
            __pyx_t_94 = 0;
            __pyx_t_95 = __pyx_v_t;
            __pyx_t_96 = __pyx_v_f;
            __pyx_t_97 = __pyx_v_aa;
            __pyx_t_98 = __pyx_v_ab;
            __pyx_t_99 = 0;
            __pyx_t_100 = 0;
            __pyx_t_101 = __pyx_v_d;
            __pyx_t_102 = __pyx_v_rr;
            __pyx_t_103 = __pyx_v_rc;
            __pyx_t_104 = __pyx_v_ab;
            __pyx_t_105 = 0;
            __pyx_t_106 = 1;
/* … */
            __pyx_t_89 = __pyx_v_d;
            __pyx_t_90 = __pyx_v_rr;
            __pyx_t_91 = __pyx_v_rc;
            __pyx_t_92 = __pyx_v_aa;
            __pyx_t_93 = 0;
            __pyx_t_94 = 0;
            __pyx_t_95 = __pyx_v_t;
            __pyx_t_96 = __pyx_v_f;
            __pyx_t_97 = __pyx_v_aa;
            __pyx_t_98 = __pyx_v_ab;
            __pyx_t_99 = 0;
            __pyx_t_100 = 0;
            __pyx_t_101 = __pyx_v_d;
            __pyx_t_102 = __pyx_v_rr;
            __pyx_t_103 = __pyx_v_rc;
            __pyx_t_104 = __pyx_v_ab;
            __pyx_t_105 = 0;
            __pyx_t_106 = 1;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">326</span>:                         g[d,rr,rc,aa,0,1]*o[t,f,aa,ab,1,0]*gh[d,rr,rc,ab,0,1] + \</pre>
<pre class='cython code score-0 '>            __pyx_t_107 = __pyx_v_d;
            __pyx_t_108 = __pyx_v_rr;
            __pyx_t_109 = __pyx_v_rc;
            __pyx_t_110 = __pyx_v_aa;
            __pyx_t_111 = 0;
            __pyx_t_112 = 1;
            __pyx_t_113 = __pyx_v_t;
            __pyx_t_114 = __pyx_v_f;
            __pyx_t_115 = __pyx_v_aa;
            __pyx_t_116 = __pyx_v_ab;
            __pyx_t_117 = 1;
            __pyx_t_118 = 0;
            __pyx_t_119 = __pyx_v_d;
            __pyx_t_120 = __pyx_v_rr;
            __pyx_t_121 = __pyx_v_rc;
            __pyx_t_122 = __pyx_v_ab;
            __pyx_t_123 = 0;
            __pyx_t_124 = 1;
/* … */
            __pyx_t_107 = __pyx_v_d;
            __pyx_t_108 = __pyx_v_rr;
            __pyx_t_109 = __pyx_v_rc;
            __pyx_t_110 = __pyx_v_aa;
            __pyx_t_111 = 0;
            __pyx_t_112 = 1;
            __pyx_t_113 = __pyx_v_t;
            __pyx_t_114 = __pyx_v_f;
            __pyx_t_115 = __pyx_v_aa;
            __pyx_t_116 = __pyx_v_ab;
            __pyx_t_117 = 1;
            __pyx_t_118 = 0;
            __pyx_t_119 = __pyx_v_d;
            __pyx_t_120 = __pyx_v_rr;
            __pyx_t_121 = __pyx_v_rc;
            __pyx_t_122 = __pyx_v_ab;
            __pyx_t_123 = 0;
            __pyx_t_124 = 1;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">327</span>:                         g[d,rr,rc,aa,0,0]*o[t,f,aa,ab,0,1]*gh[d,rr,rc,ab,1,1] + \</pre>
<pre class='cython code score-0 '>            __pyx_t_125 = __pyx_v_d;
            __pyx_t_126 = __pyx_v_rr;
            __pyx_t_127 = __pyx_v_rc;
            __pyx_t_128 = __pyx_v_aa;
            __pyx_t_129 = 0;
            __pyx_t_130 = 0;
            __pyx_t_131 = __pyx_v_t;
            __pyx_t_132 = __pyx_v_f;
            __pyx_t_133 = __pyx_v_aa;
            __pyx_t_134 = __pyx_v_ab;
            __pyx_t_135 = 0;
            __pyx_t_136 = 1;
            __pyx_t_137 = __pyx_v_d;
            __pyx_t_138 = __pyx_v_rr;
            __pyx_t_139 = __pyx_v_rc;
            __pyx_t_140 = __pyx_v_ab;
            __pyx_t_141 = 1;
            __pyx_t_142 = 1;
/* … */
            __pyx_t_125 = __pyx_v_d;
            __pyx_t_126 = __pyx_v_rr;
            __pyx_t_127 = __pyx_v_rc;
            __pyx_t_128 = __pyx_v_aa;
            __pyx_t_129 = 0;
            __pyx_t_130 = 0;
            __pyx_t_131 = __pyx_v_t;
            __pyx_t_132 = __pyx_v_f;
            __pyx_t_133 = __pyx_v_aa;
            __pyx_t_134 = __pyx_v_ab;
            __pyx_t_135 = 0;
            __pyx_t_136 = 1;
            __pyx_t_137 = __pyx_v_d;
            __pyx_t_138 = __pyx_v_rr;
            __pyx_t_139 = __pyx_v_rc;
            __pyx_t_140 = __pyx_v_ab;
            __pyx_t_141 = 1;
            __pyx_t_142 = 1;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">328</span>:                         g[d,rr,rc,aa,0,1]*o[t,f,aa,ab,1,1]*gh[d,rr,rc,ab,1,1]</pre>
<pre class='cython code score-0 '>            __pyx_t_143 = __pyx_v_d;
            __pyx_t_144 = __pyx_v_rr;
            __pyx_t_145 = __pyx_v_rc;
            __pyx_t_146 = __pyx_v_aa;
            __pyx_t_147 = 0;
            __pyx_t_148 = 1;
            __pyx_t_149 = __pyx_v_t;
            __pyx_t_150 = __pyx_v_f;
            __pyx_t_151 = __pyx_v_aa;
            __pyx_t_152 = __pyx_v_ab;
            __pyx_t_153 = 1;
            __pyx_t_154 = 1;
            __pyx_t_155 = __pyx_v_d;
            __pyx_t_156 = __pyx_v_rr;
            __pyx_t_157 = __pyx_v_rc;
            __pyx_t_158 = __pyx_v_ab;
            __pyx_t_159 = 1;
            __pyx_t_160 = 1;
/* … */
            __pyx_t_143 = __pyx_v_d;
            __pyx_t_144 = __pyx_v_rr;
            __pyx_t_145 = __pyx_v_rc;
            __pyx_t_146 = __pyx_v_aa;
            __pyx_t_147 = 0;
            __pyx_t_148 = 1;
            __pyx_t_149 = __pyx_v_t;
            __pyx_t_150 = __pyx_v_f;
            __pyx_t_151 = __pyx_v_aa;
            __pyx_t_152 = __pyx_v_ab;
            __pyx_t_153 = 1;
            __pyx_t_154 = 1;
            __pyx_t_155 = __pyx_v_d;
            __pyx_t_156 = __pyx_v_rr;
            __pyx_t_157 = __pyx_v_rc;
            __pyx_t_158 = __pyx_v_ab;
            __pyx_t_159 = 1;
            __pyx_t_160 = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">329</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">330</span>:                         corr[t,f,aa,ab,1,0] = \</pre>
<pre class='cython code score-0 '>            __pyx_t_239 = __pyx_v_t;
            __pyx_t_240 = __pyx_v_f;
            __pyx_t_241 = __pyx_v_aa;
            __pyx_t_242 = __pyx_v_ab;
            __pyx_t_243 = 1;
            __pyx_t_244 = 0;
            *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.buf, __pyx_t_239, __pyx_pybuffernd_corr.diminfo[0].strides, __pyx_t_240, __pyx_pybuffernd_corr.diminfo[1].strides, __pyx_t_241, __pyx_pybuffernd_corr.diminfo[2].strides, __pyx_t_242, __pyx_pybuffernd_corr.diminfo[3].strides, __pyx_t_243, __pyx_pybuffernd_corr.diminfo[4].strides, __pyx_t_244, __pyx_pybuffernd_corr.diminfo[5].strides) = __Pyx_c_sumf(__Pyx_c_sumf(__Pyx_c_sumf(__Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_167, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_168, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_169, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_170, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_171, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_172, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_173, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_174, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_175, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_176, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_177, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_178, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_179, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_180, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_181, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_182, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_183, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_184, __pyx_pybuffernd_gh.diminfo[5].strides))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_185, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_186, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_187, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_188, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_189, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_190, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_191, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_192, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_193, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_194, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_195, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_196, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_197, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_198, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_199, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_200, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_201, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_202, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_203, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_204, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_205, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_206, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_207, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_208, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_209, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_210, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_211, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_212, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_213, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_214, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_215, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_216, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_217, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_218, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_219, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_220, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_221, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_222, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_223, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_224, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_225, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_226, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_227, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_228, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_229, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_230, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_231, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_232, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_233, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_234, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_235, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_236, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_237, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_238, __pyx_pybuffernd_gh.diminfo[5].strides))));
/* … */
            __pyx_t_239 = __pyx_v_t;
            __pyx_t_240 = __pyx_v_f;
            __pyx_t_241 = __pyx_v_aa;
            __pyx_t_242 = __pyx_v_ab;
            __pyx_t_243 = 1;
            __pyx_t_244 = 0;
            *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.buf, __pyx_t_239, __pyx_pybuffernd_corr.diminfo[0].strides, __pyx_t_240, __pyx_pybuffernd_corr.diminfo[1].strides, __pyx_t_241, __pyx_pybuffernd_corr.diminfo[2].strides, __pyx_t_242, __pyx_pybuffernd_corr.diminfo[3].strides, __pyx_t_243, __pyx_pybuffernd_corr.diminfo[4].strides, __pyx_t_244, __pyx_pybuffernd_corr.diminfo[5].strides) = __Pyx_c_sum(__Pyx_c_sum(__Pyx_c_sum(__Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_167, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_168, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_169, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_170, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_171, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_172, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_173, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_174, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_175, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_176, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_177, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_178, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_179, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_180, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_181, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_182, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_183, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_184, __pyx_pybuffernd_gh.diminfo[5].strides))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_185, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_186, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_187, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_188, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_189, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_190, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_191, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_192, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_193, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_194, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_195, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_196, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_197, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_198, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_199, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_200, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_201, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_202, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_203, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_204, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_205, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_206, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_207, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_208, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_209, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_210, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_211, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_212, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_213, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_214, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_215, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_216, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_217, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_218, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_219, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_220, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_221, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_222, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_223, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_224, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_225, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_226, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_227, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_228, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_229, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_230, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_231, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_232, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_233, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_234, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_235, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_236, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_237, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_238, __pyx_pybuffernd_gh.diminfo[5].strides))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">331</span>:                         g[d,rr,rc,aa,1,0]*o[t,f,aa,ab,0,0]*gh[d,rr,rc,ab,0,0] + \</pre>
<pre class='cython code score-0 '>            __pyx_t_167 = __pyx_v_d;
            __pyx_t_168 = __pyx_v_rr;
            __pyx_t_169 = __pyx_v_rc;
            __pyx_t_170 = __pyx_v_aa;
            __pyx_t_171 = 1;
            __pyx_t_172 = 0;
            __pyx_t_173 = __pyx_v_t;
            __pyx_t_174 = __pyx_v_f;
            __pyx_t_175 = __pyx_v_aa;
            __pyx_t_176 = __pyx_v_ab;
            __pyx_t_177 = 0;
            __pyx_t_178 = 0;
            __pyx_t_179 = __pyx_v_d;
            __pyx_t_180 = __pyx_v_rr;
            __pyx_t_181 = __pyx_v_rc;
            __pyx_t_182 = __pyx_v_ab;
            __pyx_t_183 = 0;
            __pyx_t_184 = 0;
/* … */
            __pyx_t_167 = __pyx_v_d;
            __pyx_t_168 = __pyx_v_rr;
            __pyx_t_169 = __pyx_v_rc;
            __pyx_t_170 = __pyx_v_aa;
            __pyx_t_171 = 1;
            __pyx_t_172 = 0;
            __pyx_t_173 = __pyx_v_t;
            __pyx_t_174 = __pyx_v_f;
            __pyx_t_175 = __pyx_v_aa;
            __pyx_t_176 = __pyx_v_ab;
            __pyx_t_177 = 0;
            __pyx_t_178 = 0;
            __pyx_t_179 = __pyx_v_d;
            __pyx_t_180 = __pyx_v_rr;
            __pyx_t_181 = __pyx_v_rc;
            __pyx_t_182 = __pyx_v_ab;
            __pyx_t_183 = 0;
            __pyx_t_184 = 0;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">332</span>:                         g[d,rr,rc,aa,1,1]*o[t,f,aa,ab,1,0]*gh[d,rr,rc,ab,0,0] + \</pre>
<pre class='cython code score-0 '>            __pyx_t_185 = __pyx_v_d;
            __pyx_t_186 = __pyx_v_rr;
            __pyx_t_187 = __pyx_v_rc;
            __pyx_t_188 = __pyx_v_aa;
            __pyx_t_189 = 1;
            __pyx_t_190 = 1;
            __pyx_t_191 = __pyx_v_t;
            __pyx_t_192 = __pyx_v_f;
            __pyx_t_193 = __pyx_v_aa;
            __pyx_t_194 = __pyx_v_ab;
            __pyx_t_195 = 1;
            __pyx_t_196 = 0;
            __pyx_t_197 = __pyx_v_d;
            __pyx_t_198 = __pyx_v_rr;
            __pyx_t_199 = __pyx_v_rc;
            __pyx_t_200 = __pyx_v_ab;
            __pyx_t_201 = 0;
            __pyx_t_202 = 0;
/* … */
            __pyx_t_185 = __pyx_v_d;
            __pyx_t_186 = __pyx_v_rr;
            __pyx_t_187 = __pyx_v_rc;
            __pyx_t_188 = __pyx_v_aa;
            __pyx_t_189 = 1;
            __pyx_t_190 = 1;
            __pyx_t_191 = __pyx_v_t;
            __pyx_t_192 = __pyx_v_f;
            __pyx_t_193 = __pyx_v_aa;
            __pyx_t_194 = __pyx_v_ab;
            __pyx_t_195 = 1;
            __pyx_t_196 = 0;
            __pyx_t_197 = __pyx_v_d;
            __pyx_t_198 = __pyx_v_rr;
            __pyx_t_199 = __pyx_v_rc;
            __pyx_t_200 = __pyx_v_ab;
            __pyx_t_201 = 0;
            __pyx_t_202 = 0;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">333</span>:                         g[d,rr,rc,aa,1,0]*o[t,f,aa,ab,0,1]*gh[d,rr,rc,ab,1,0] + \</pre>
<pre class='cython code score-0 '>            __pyx_t_203 = __pyx_v_d;
            __pyx_t_204 = __pyx_v_rr;
            __pyx_t_205 = __pyx_v_rc;
            __pyx_t_206 = __pyx_v_aa;
            __pyx_t_207 = 1;
            __pyx_t_208 = 0;
            __pyx_t_209 = __pyx_v_t;
            __pyx_t_210 = __pyx_v_f;
            __pyx_t_211 = __pyx_v_aa;
            __pyx_t_212 = __pyx_v_ab;
            __pyx_t_213 = 0;
            __pyx_t_214 = 1;
            __pyx_t_215 = __pyx_v_d;
            __pyx_t_216 = __pyx_v_rr;
            __pyx_t_217 = __pyx_v_rc;
            __pyx_t_218 = __pyx_v_ab;
            __pyx_t_219 = 1;
            __pyx_t_220 = 0;
/* … */
            __pyx_t_203 = __pyx_v_d;
            __pyx_t_204 = __pyx_v_rr;
            __pyx_t_205 = __pyx_v_rc;
            __pyx_t_206 = __pyx_v_aa;
            __pyx_t_207 = 1;
            __pyx_t_208 = 0;
            __pyx_t_209 = __pyx_v_t;
            __pyx_t_210 = __pyx_v_f;
            __pyx_t_211 = __pyx_v_aa;
            __pyx_t_212 = __pyx_v_ab;
            __pyx_t_213 = 0;
            __pyx_t_214 = 1;
            __pyx_t_215 = __pyx_v_d;
            __pyx_t_216 = __pyx_v_rr;
            __pyx_t_217 = __pyx_v_rc;
            __pyx_t_218 = __pyx_v_ab;
            __pyx_t_219 = 1;
            __pyx_t_220 = 0;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">334</span>:                         g[d,rr,rc,aa,1,1]*o[t,f,aa,ab,1,1]*gh[d,rr,rc,ab,1,0]</pre>
<pre class='cython code score-0 '>            __pyx_t_221 = __pyx_v_d;
            __pyx_t_222 = __pyx_v_rr;
            __pyx_t_223 = __pyx_v_rc;
            __pyx_t_224 = __pyx_v_aa;
            __pyx_t_225 = 1;
            __pyx_t_226 = 1;
            __pyx_t_227 = __pyx_v_t;
            __pyx_t_228 = __pyx_v_f;
            __pyx_t_229 = __pyx_v_aa;
            __pyx_t_230 = __pyx_v_ab;
            __pyx_t_231 = 1;
            __pyx_t_232 = 1;
            __pyx_t_233 = __pyx_v_d;
            __pyx_t_234 = __pyx_v_rr;
            __pyx_t_235 = __pyx_v_rc;
            __pyx_t_236 = __pyx_v_ab;
            __pyx_t_237 = 1;
            __pyx_t_238 = 0;
/* … */
            __pyx_t_221 = __pyx_v_d;
            __pyx_t_222 = __pyx_v_rr;
            __pyx_t_223 = __pyx_v_rc;
            __pyx_t_224 = __pyx_v_aa;
            __pyx_t_225 = 1;
            __pyx_t_226 = 1;
            __pyx_t_227 = __pyx_v_t;
            __pyx_t_228 = __pyx_v_f;
            __pyx_t_229 = __pyx_v_aa;
            __pyx_t_230 = __pyx_v_ab;
            __pyx_t_231 = 1;
            __pyx_t_232 = 1;
            __pyx_t_233 = __pyx_v_d;
            __pyx_t_234 = __pyx_v_rr;
            __pyx_t_235 = __pyx_v_rc;
            __pyx_t_236 = __pyx_v_ab;
            __pyx_t_237 = 1;
            __pyx_t_238 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">335</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">336</span>:                         corr[t,f,aa,ab,1,1] = \</pre>
<pre class='cython code score-0 '>            __pyx_t_317 = __pyx_v_t;
            __pyx_t_318 = __pyx_v_f;
            __pyx_t_319 = __pyx_v_aa;
            __pyx_t_320 = __pyx_v_ab;
            __pyx_t_321 = 1;
            __pyx_t_322 = 1;
            *__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.buf, __pyx_t_317, __pyx_pybuffernd_corr.diminfo[0].strides, __pyx_t_318, __pyx_pybuffernd_corr.diminfo[1].strides, __pyx_t_319, __pyx_pybuffernd_corr.diminfo[2].strides, __pyx_t_320, __pyx_pybuffernd_corr.diminfo[3].strides, __pyx_t_321, __pyx_pybuffernd_corr.diminfo[4].strides, __pyx_t_322, __pyx_pybuffernd_corr.diminfo[5].strides) = __Pyx_c_sumf(__Pyx_c_sumf(__Pyx_c_sumf(__Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_245, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_246, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_247, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_248, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_249, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_250, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_251, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_252, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_253, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_254, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_255, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_256, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_257, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_258, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_259, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_260, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_261, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_262, __pyx_pybuffernd_gh.diminfo[5].strides))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_263, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_264, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_265, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_266, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_267, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_268, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_269, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_270, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_271, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_272, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_273, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_274, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_275, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_276, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_277, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_278, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_279, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_280, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_281, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_282, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_283, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_284, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_285, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_286, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_287, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_288, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_289, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_290, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_291, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_292, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_293, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_294, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_295, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_296, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_297, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_298, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prodf(__Pyx_c_prodf((*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_299, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_300, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_301, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_302, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_303, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_304, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_305, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_306, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_307, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_308, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_309, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_310, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_float_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_311, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_312, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_313, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_314, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_315, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_316, __pyx_pybuffernd_gh.diminfo[5].strides))));
          }
        }
      }
    }
  }
/* … */
            __pyx_t_317 = __pyx_v_t;
            __pyx_t_318 = __pyx_v_f;
            __pyx_t_319 = __pyx_v_aa;
            __pyx_t_320 = __pyx_v_ab;
            __pyx_t_321 = 1;
            __pyx_t_322 = 1;
            *__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_corr.rcbuffer-&gt;pybuffer.buf, __pyx_t_317, __pyx_pybuffernd_corr.diminfo[0].strides, __pyx_t_318, __pyx_pybuffernd_corr.diminfo[1].strides, __pyx_t_319, __pyx_pybuffernd_corr.diminfo[2].strides, __pyx_t_320, __pyx_pybuffernd_corr.diminfo[3].strides, __pyx_t_321, __pyx_pybuffernd_corr.diminfo[4].strides, __pyx_t_322, __pyx_pybuffernd_corr.diminfo[5].strides) = __Pyx_c_sum(__Pyx_c_sum(__Pyx_c_sum(__Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_245, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_246, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_247, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_248, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_249, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_250, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_251, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_252, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_253, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_254, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_255, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_256, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_257, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_258, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_259, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_260, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_261, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_262, __pyx_pybuffernd_gh.diminfo[5].strides))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_263, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_264, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_265, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_266, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_267, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_268, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_269, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_270, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_271, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_272, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_273, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_274, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_275, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_276, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_277, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_278, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_279, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_280, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_281, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_282, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_283, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_284, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_285, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_286, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_287, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_288, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_289, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_290, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_291, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_292, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_293, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_294, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_295, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_296, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_297, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_298, __pyx_pybuffernd_gh.diminfo[5].strides)))), __Pyx_c_prod(__Pyx_c_prod((*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.buf, __pyx_t_299, __pyx_pybuffernd_g.diminfo[0].strides, __pyx_t_300, __pyx_pybuffernd_g.diminfo[1].strides, __pyx_t_301, __pyx_pybuffernd_g.diminfo[2].strides, __pyx_t_302, __pyx_pybuffernd_g.diminfo[3].strides, __pyx_t_303, __pyx_pybuffernd_g.diminfo[4].strides, __pyx_t_304, __pyx_pybuffernd_g.diminfo[5].strides)), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_o.rcbuffer-&gt;pybuffer.buf, __pyx_t_305, __pyx_pybuffernd_o.diminfo[0].strides, __pyx_t_306, __pyx_pybuffernd_o.diminfo[1].strides, __pyx_t_307, __pyx_pybuffernd_o.diminfo[2].strides, __pyx_t_308, __pyx_pybuffernd_o.diminfo[3].strides, __pyx_t_309, __pyx_pybuffernd_o.diminfo[4].strides, __pyx_t_310, __pyx_pybuffernd_o.diminfo[5].strides))), (*__Pyx_BufPtrStrided6d(__pyx_t_double_complex *, __pyx_pybuffernd_gh.rcbuffer-&gt;pybuffer.buf, __pyx_t_311, __pyx_pybuffernd_gh.diminfo[0].strides, __pyx_t_312, __pyx_pybuffernd_gh.diminfo[1].strides, __pyx_t_313, __pyx_pybuffernd_gh.diminfo[2].strides, __pyx_t_314, __pyx_pybuffernd_gh.diminfo[3].strides, __pyx_t_315, __pyx_pybuffernd_gh.diminfo[4].strides, __pyx_t_316, __pyx_pybuffernd_gh.diminfo[5].strides))));
          }
        }
      }
    }
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">337</span>:                         g[d,rr,rc,aa,1,0]*o[t,f,aa,ab,0,0]*gh[d,rr,rc,ab,0,1] + \</pre>
<pre class='cython code score-0 '>            __pyx_t_245 = __pyx_v_d;
            __pyx_t_246 = __pyx_v_rr;
            __pyx_t_247 = __pyx_v_rc;
            __pyx_t_248 = __pyx_v_aa;
            __pyx_t_249 = 1;
            __pyx_t_250 = 0;
            __pyx_t_251 = __pyx_v_t;
            __pyx_t_252 = __pyx_v_f;
            __pyx_t_253 = __pyx_v_aa;
            __pyx_t_254 = __pyx_v_ab;
            __pyx_t_255 = 0;
            __pyx_t_256 = 0;
            __pyx_t_257 = __pyx_v_d;
            __pyx_t_258 = __pyx_v_rr;
            __pyx_t_259 = __pyx_v_rc;
            __pyx_t_260 = __pyx_v_ab;
            __pyx_t_261 = 0;
            __pyx_t_262 = 1;
/* … */
            __pyx_t_245 = __pyx_v_d;
            __pyx_t_246 = __pyx_v_rr;
            __pyx_t_247 = __pyx_v_rc;
            __pyx_t_248 = __pyx_v_aa;
            __pyx_t_249 = 1;
            __pyx_t_250 = 0;
            __pyx_t_251 = __pyx_v_t;
            __pyx_t_252 = __pyx_v_f;
            __pyx_t_253 = __pyx_v_aa;
            __pyx_t_254 = __pyx_v_ab;
            __pyx_t_255 = 0;
            __pyx_t_256 = 0;
            __pyx_t_257 = __pyx_v_d;
            __pyx_t_258 = __pyx_v_rr;
            __pyx_t_259 = __pyx_v_rc;
            __pyx_t_260 = __pyx_v_ab;
            __pyx_t_261 = 0;
            __pyx_t_262 = 1;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">338</span>:                         g[d,rr,rc,aa,1,1]*o[t,f,aa,ab,1,0]*gh[d,rr,rc,ab,0,1] + \</pre>
<pre class='cython code score-0 '>            __pyx_t_263 = __pyx_v_d;
            __pyx_t_264 = __pyx_v_rr;
            __pyx_t_265 = __pyx_v_rc;
            __pyx_t_266 = __pyx_v_aa;
            __pyx_t_267 = 1;
            __pyx_t_268 = 1;
            __pyx_t_269 = __pyx_v_t;
            __pyx_t_270 = __pyx_v_f;
            __pyx_t_271 = __pyx_v_aa;
            __pyx_t_272 = __pyx_v_ab;
            __pyx_t_273 = 1;
            __pyx_t_274 = 0;
            __pyx_t_275 = __pyx_v_d;
            __pyx_t_276 = __pyx_v_rr;
            __pyx_t_277 = __pyx_v_rc;
            __pyx_t_278 = __pyx_v_ab;
            __pyx_t_279 = 0;
            __pyx_t_280 = 1;
/* … */
            __pyx_t_263 = __pyx_v_d;
            __pyx_t_264 = __pyx_v_rr;
            __pyx_t_265 = __pyx_v_rc;
            __pyx_t_266 = __pyx_v_aa;
            __pyx_t_267 = 1;
            __pyx_t_268 = 1;
            __pyx_t_269 = __pyx_v_t;
            __pyx_t_270 = __pyx_v_f;
            __pyx_t_271 = __pyx_v_aa;
            __pyx_t_272 = __pyx_v_ab;
            __pyx_t_273 = 1;
            __pyx_t_274 = 0;
            __pyx_t_275 = __pyx_v_d;
            __pyx_t_276 = __pyx_v_rr;
            __pyx_t_277 = __pyx_v_rc;
            __pyx_t_278 = __pyx_v_ab;
            __pyx_t_279 = 0;
            __pyx_t_280 = 1;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">339</span>:                         g[d,rr,rc,aa,1,0]*o[t,f,aa,ab,0,1]*gh[d,rr,rc,ab,1,1] + \</pre>
<pre class='cython code score-0 '>            __pyx_t_281 = __pyx_v_d;
            __pyx_t_282 = __pyx_v_rr;
            __pyx_t_283 = __pyx_v_rc;
            __pyx_t_284 = __pyx_v_aa;
            __pyx_t_285 = 1;
            __pyx_t_286 = 0;
            __pyx_t_287 = __pyx_v_t;
            __pyx_t_288 = __pyx_v_f;
            __pyx_t_289 = __pyx_v_aa;
            __pyx_t_290 = __pyx_v_ab;
            __pyx_t_291 = 0;
            __pyx_t_292 = 1;
            __pyx_t_293 = __pyx_v_d;
            __pyx_t_294 = __pyx_v_rr;
            __pyx_t_295 = __pyx_v_rc;
            __pyx_t_296 = __pyx_v_ab;
            __pyx_t_297 = 1;
            __pyx_t_298 = 1;
/* … */
            __pyx_t_281 = __pyx_v_d;
            __pyx_t_282 = __pyx_v_rr;
            __pyx_t_283 = __pyx_v_rc;
            __pyx_t_284 = __pyx_v_aa;
            __pyx_t_285 = 1;
            __pyx_t_286 = 0;
            __pyx_t_287 = __pyx_v_t;
            __pyx_t_288 = __pyx_v_f;
            __pyx_t_289 = __pyx_v_aa;
            __pyx_t_290 = __pyx_v_ab;
            __pyx_t_291 = 0;
            __pyx_t_292 = 1;
            __pyx_t_293 = __pyx_v_d;
            __pyx_t_294 = __pyx_v_rr;
            __pyx_t_295 = __pyx_v_rc;
            __pyx_t_296 = __pyx_v_ab;
            __pyx_t_297 = 1;
            __pyx_t_298 = 1;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">340</span>:                         g[d,rr,rc,aa,1,1]*o[t,f,aa,ab,1,1]*gh[d,rr,rc,ab,1,1]</pre>
<pre class='cython code score-0 '>            __pyx_t_299 = __pyx_v_d;
            __pyx_t_300 = __pyx_v_rr;
            __pyx_t_301 = __pyx_v_rc;
            __pyx_t_302 = __pyx_v_aa;
            __pyx_t_303 = 1;
            __pyx_t_304 = 1;
            __pyx_t_305 = __pyx_v_t;
            __pyx_t_306 = __pyx_v_f;
            __pyx_t_307 = __pyx_v_aa;
            __pyx_t_308 = __pyx_v_ab;
            __pyx_t_309 = 1;
            __pyx_t_310 = 1;
            __pyx_t_311 = __pyx_v_d;
            __pyx_t_312 = __pyx_v_rr;
            __pyx_t_313 = __pyx_v_rc;
            __pyx_t_314 = __pyx_v_ab;
            __pyx_t_315 = 1;
            __pyx_t_316 = 1;
/* … */
            __pyx_t_299 = __pyx_v_d;
            __pyx_t_300 = __pyx_v_rr;
            __pyx_t_301 = __pyx_v_rc;
            __pyx_t_302 = __pyx_v_aa;
            __pyx_t_303 = 1;
            __pyx_t_304 = 1;
            __pyx_t_305 = __pyx_v_t;
            __pyx_t_306 = __pyx_v_f;
            __pyx_t_307 = __pyx_v_aa;
            __pyx_t_308 = __pyx_v_ab;
            __pyx_t_309 = 1;
            __pyx_t_310 = 1;
            __pyx_t_311 = __pyx_v_d;
            __pyx_t_312 = __pyx_v_rr;
            __pyx_t_313 = __pyx_v_rc;
            __pyx_t_314 = __pyx_v_ab;
            __pyx_t_315 = 1;
            __pyx_t_316 = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">341</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">342</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">343</span>: @cython.cdivision(True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">344</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">345</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">346</span>: @cython.nonecheck(False)</pre>
<pre class="cython line score-687" onclick='toggleDiv(this)'>+<span class="">347</span>: def cycompute_weights(np.ndarray[complex3264, ndim=7] r,</pre>
<pre class='cython code score-687 '>/* Python wrapper */
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_15cycompute_weights(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_14cycompute_weights[] = "\n    This computes the weights, given the latest residual visibilities and the v parameter.\n    w[i] = (v+2)/(v + 2*residual[i]^2). Next v is update using the newly compute weights.\n    ";
static PyMethodDef __pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_15cycompute_weights = {"cycompute_weights", (PyCFunction)__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_15cycompute_weights, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_14cycompute_weights};
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_15cycompute_weights(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_signatures = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED PyObject *__pyx_v_defaults = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fused_cpdef (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_signatures,&amp;__pyx_n_s_args,&amp;__pyx_n_s_kwargs,&amp;__pyx_n_s_defaults,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_signatures)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_args)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_kwargs)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_defaults)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_fused_cpdef") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_signatures = values[0];
    __pyx_v_args = values[1];
    __pyx_v_kwargs = values[2];
    __pyx_v_defaults = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__pyx_fused_cpdef", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_14cycompute_weights(__pyx_self, __pyx_v_signatures, __pyx_v_args, __pyx_v_kwargs, __pyx_v_defaults);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_14cycompute_weights(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_signatures, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs, CYTHON_UNUSED PyObject *__pyx_v_defaults) {
  PyObject *__pyx_v_dest_sig = NULL;
  PyTypeObject *__pyx_v_ndarray = 0;
  PyObject *__pyx_v_numpy = NULL;
  __Pyx_memviewslice __pyx_v_memslice;
  Py_ssize_t __pyx_v_itemsize;
  CYTHON_UNUSED int __pyx_v_dtype_signed;
  char __pyx_v_kind;
  PyObject *__pyx_v_arg = NULL;
  PyObject *__pyx_v_dtype = NULL;
  PyObject *__pyx_v_arg_base = NULL;
  PyObject *__pyx_v_candidates = NULL;
  PyObject *__pyx_v_sig = NULL;
  int __pyx_v_match_found;
  PyObject *__pyx_v_src_type = NULL;
  PyObject *__pyx_v_dst_type = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_weights", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kwargs);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, Py_None);
  __pyx_v_dest_sig = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_2 = (__pyx_v_kwargs == Py_None);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kwargs, __pyx_t_1);
    __pyx_t_1 = 0;
  }
  {
    /*try:*/ {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_v_numpy = __pyx_t_1;
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_numpy, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!(likely(<span class='py_c_api'>PyType_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "type", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
      __pyx_v_ndarray = ((PyTypeObject*)__pyx_t_1);
      __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L11_try_end;
    __pyx_L4_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_ImportError) || <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_AttributeError) || <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_TypeError);
    if (__pyx_t_7) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_1, &amp;__pyx_t_8, &amp;__pyx_t_9) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L6_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ndarray, ((PyTypeObject*)Py_None));
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L5_exception_handled;
    }
    goto __pyx_L6_except_error;
    __pyx_L6_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    goto __pyx_L1_error;
    __pyx_L5_exception_handled:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    __pyx_L11_try_end:;
  }
  __pyx_v_itemsize = -1L;
  if (unlikely(__pyx_v_args == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = ((0 &lt; __pyx_t_10) != 0);
  if (__pyx_t_3) {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(((PyObject*)__pyx_v_args), 0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
    __pyx_v_arg = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L14;
  }
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyDict_ContainsTF</span>(__pyx_n_s_r, ((PyObject*)__pyx_v_kwargs), Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {
    if (unlikely(__pyx_v_kwargs == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_kwargs), __pyx_n_s_r);<span class='error_goto'> if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_v_arg = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L14;
  }
  /*else*/ {
    if (unlikely(__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(((PyObject*)__pyx_v_args));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_Expected_at_least_d_arguments, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_L14:;
  while (1) {
    __pyx_t_2 = (__pyx_v_ndarray != ((PyTypeObject*)Py_None));
    __pyx_t_3 = (__pyx_t_2 != 0);
    if (__pyx_t_3) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_arg, __pyx_v_ndarray); 
      __pyx_t_2 = (__pyx_t_3 != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_v_dtype = __pyx_t_8;
        __pyx_t_8 = 0;
        goto __pyx_L18;
      }
      __pyx_t_2 = (__pyx_memoryview_check(__pyx_v_arg) != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_base);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_v_arg_base = __pyx_t_8;
        __pyx_t_8 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_arg_base, __pyx_v_ndarray); 
        __pyx_t_3 = (__pyx_t_2 != 0);
        if (__pyx_t_3) {
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg_base, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_v_dtype = __pyx_t_8;
          __pyx_t_8 = 0;
          goto __pyx_L19;
        }
        /*else*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
          __pyx_v_dtype = Py_None;
        }
        __pyx_L19:;
        goto __pyx_L18;
      }
      /*else*/ {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
        __pyx_v_dtype = Py_None;
      }
      __pyx_L18:;
      __pyx_v_itemsize = -1L;
      __pyx_t_3 = (__pyx_v_dtype != Py_None);
      __pyx_t_2 = (__pyx_t_3 != 0);
      if (__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dtype, __pyx_n_s_itemsize);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_itemsize = __pyx_t_10;
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dtype, __pyx_n_s_kind);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Ord</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(__pyx_t_11 == (long)(Py_UCS4)-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_kind = __pyx_t_11;
        __pyx_v_dtype_signed = (__pyx_v_kind == 'i');
        switch (__pyx_v_kind) {
          case 'i':
          case 'u':
          break;
          case 'f':
          break;
          case 'c':
          __pyx_t_3 = (((sizeof(__pyx_t_float_complex)) == __pyx_v_itemsize) != 0);
          if (__pyx_t_3) {
          } else {
            __pyx_t_2 = __pyx_t_3;
            goto __pyx_L22_bool_binop_done;
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_3 = ((((Py_ssize_t)__pyx_t_10) == 7) != 0);
          __pyx_t_2 = __pyx_t_3;
          __pyx_L22_bool_binop_done:;
          if (__pyx_t_2) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            goto __pyx_L16_break;
          }
          __pyx_t_3 = (((sizeof(__pyx_t_double_complex)) == __pyx_v_itemsize) != 0);
          if (__pyx_t_3) {
          } else {
            __pyx_t_2 = __pyx_t_3;
            goto __pyx_L25_bool_binop_done;
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arg, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_3 = ((((Py_ssize_t)__pyx_t_10) == 7) != 0);
          __pyx_t_2 = __pyx_t_3;
          __pyx_L25_bool_binop_done:;
          if (__pyx_t_2) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            goto __pyx_L16_break;
          }
          break;
          case 'O':
          break;
          default: break;
        }
      }
    }
    __pyx_t_3 = ((__pyx_v_itemsize == -1L) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L28_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_itemsize == (sizeof(__pyx_t_float_complex))) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L28_bool_binop_done:;
    if (__pyx_t_2) {
      __pyx_v_memslice = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsdsdsds___pyx_t_float_complex</span>(__pyx_v_arg);
      __pyx_t_2 = (__pyx_v_memslice.memview != 0);
      if (__pyx_t_2) {
        __PYX_XDEC_MEMVIEW((&amp;__pyx_v_memslice), 1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L16_break;
      }
      /*else*/ {
        <span class='py_c_api'>PyErr_Clear</span>();
      }
    }
    __pyx_t_3 = ((__pyx_v_itemsize == -1L) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L32_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_itemsize == (sizeof(__pyx_t_double_complex))) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L32_bool_binop_done:;
    if (__pyx_t_2) {
      __pyx_v_memslice = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsdsdsds___pyx_t_double_complex</span>(__pyx_v_arg);
      __pyx_t_2 = (__pyx_v_memslice.memview != 0);
      if (__pyx_t_2) {
        __PYX_XDEC_MEMVIEW((&amp;__pyx_v_memslice), 1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L16_break;
      }
      /*else*/ {
        <span class='py_c_api'>PyErr_Clear</span>();
      }
    }
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_dest_sig, 0, Py_None, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L16_break;
  }
  __pyx_L16_break:;
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_v_candidates = ((PyObject*)__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_10 = 0;
  if (unlikely(__pyx_v_signatures == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_9 = __Pyx_dict_iterator(((PyObject*)__pyx_v_signatures), 1, ((PyObject *)NULL), (&amp;__pyx_t_12), (&amp;__pyx_t_7));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __pyx_t_8 = __pyx_t_9;
  __pyx_t_9 = 0;
  while (1) {
    __pyx_t_13 = __Pyx_dict_iter_next(__pyx_t_8, __pyx_t_12, &amp;__pyx_t_10, &amp;__pyx_t_9, NULL, NULL, __pyx_t_7);
    if (unlikely(__pyx_t_13 == 0)) break;
    if (unlikely(__pyx_t_13 == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_sig, __pyx_t_9);
    __pyx_t_9 = 0;
    __pyx_v_match_found = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_sig, __pyx_n_s_strip);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__31, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_split);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__31 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_);<span class='error_goto'> if (unlikely(!__pyx_tuple__31)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__31);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__31);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__32, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dest_sig);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dest_sig);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_dest_sig);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_9 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_14 = 0;
      __pyx_t_15 = NULL;
    } else {
      __pyx_t_14 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_15 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_15)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_15(__pyx_t_9);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        PyObject* sequence = __pyx_t_1;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_16 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_17 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_16 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_17 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
        #else
        __pyx_t_16 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        __pyx_t_17 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_18 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_19 = Py_TYPE(__pyx_t_18)-&gt;tp_iternext;
        index = 0; __pyx_t_16 = __pyx_t_19(__pyx_t_18); if (unlikely(!__pyx_t_16)) goto __pyx_L39_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        index = 1; __pyx_t_17 = __pyx_t_19(__pyx_t_18); if (unlikely(!__pyx_t_17)) goto __pyx_L39_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_19(__pyx_t_18), 2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_19 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        goto __pyx_L40_unpacking_done;
        __pyx_L39_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_t_19 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_L40_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_src_type, __pyx_t_16);
      __pyx_t_16 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dst_type, __pyx_t_17);
      __pyx_t_17 = 0;
      __pyx_t_2 = (__pyx_v_dst_type != Py_None);
      __pyx_t_3 = (__pyx_t_2 != 0);
      if (__pyx_t_3) {
        __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_src_type, __pyx_v_dst_type, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (__pyx_t_3) {
          __pyx_v_match_found = 1;
          goto __pyx_L42;
        }
        /*else*/ {
          __pyx_v_match_found = 0;
          goto __pyx_L38_break;
        }
        __pyx_L42:;
      }
    }
    __pyx_L38_break:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_3 = (__pyx_v_match_found != 0);
    if (__pyx_t_3) {
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_candidates, __pyx_v_sig);<span class='error_goto'> if (unlikely(__pyx_t_20 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_3 = (__pyx_v_candidates != Py_None) &amp;&amp; (<span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates) != 0);
  __pyx_t_2 = ((!__pyx_t_3) != 0);
  if (__pyx_t_2) {
  __pyx_tuple__32 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s__3);<span class='error_goto'> if (unlikely(!__pyx_tuple__32)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__32);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__32);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__33, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_12 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_candidates);<span class='error_goto'> if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = ((__pyx_t_12 &gt; 1) != 0);
  if (__pyx_t_2) {
  __pyx_tuple__33 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_No_matching_signature_found);<span class='error_goto'> if (unlikely(!__pyx_tuple__33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__33);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__33);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__34, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(__pyx_v_signatures == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(((PyObject*)__pyx_v_signatures), <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_candidates, 0));<span class='error_goto'> if (unlikely(__pyx_t_8 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_r = __pyx_t_8;
    __pyx_t_8 = 0;
    goto __pyx_L0;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dest_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_numpy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dtype);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg_base);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_candidates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_src_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dst_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_59cycompute_weights(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_fuse_0__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_59cycompute_weights = {"__pyx_fuse_0cycompute_weights", (PyCFunction)__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_59cycompute_weights, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_14cycompute_weights};
static PyObject *__pyx_fuse_0__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_59cycompute_weights(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_r = 0;
  PyArrayObject *__pyx_v_w = 0;
  PyArrayObject *__pyx_v_v = 0;
  int __pyx_v_t_int;
  int __pyx_v_f_int;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_weights (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_r,&amp;__pyx_n_s_w,&amp;__pyx_n_s_v,&amp;__pyx_n_s_t_int,&amp;__pyx_n_s_f_int,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_w)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_weights", 1, 5, 5, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_weights", 1, 5, 5, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_t_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_weights", 1, 5, 5, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_weights", 1, 5, 5, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cycompute_weights") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_r = ((PyArrayObject *)values[0]);
    __pyx_v_w = ((PyArrayObject *)values[1]);
    __pyx_v_v = ((PyArrayObject *)values[2]);
    __pyx_v_t_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_t_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_f_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_f_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_weights", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_weights", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_r), __pyx_ptype_5numpy_ndarray, 1, "r", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_w), __pyx_ptype_5numpy_ndarray, 1, "w", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_58cycompute_weights(__pyx_self, __pyx_v_r, __pyx_v_w, __pyx_v_v, __pyx_v_t_int, __pyx_v_f_int);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_58cycompute_weights(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_r, PyArrayObject *__pyx_v_w, PyArrayObject *__pyx_v_v, int __pyx_v_t_int, int __pyx_v_f_int) {
  struct __pyx_obj_7cubecal_7kernels_16cyfull_W_complex___pyx_scope_struct____pyx_fuse_0cycompute_weights *__pyx_cur_scope;
  PyObject *__pyx_v_i = 0;
  PyObject *__pyx_v_t = 0;
  PyObject *__pyx_v_f = 0;
  PyObject *__pyx_v_aa = 0;
  PyObject *__pyx_v_ab = 0;
  PyObject *__pyx_v_rr = 0;
  PyObject *__pyx_v_rc = 0;
  int __pyx_v_n_mod;
  int __pyx_v_n_tim;
  int __pyx_v_n_fre;
  int __pyx_v_n_ant;
  double __pyx_v_d;
  PyArrayObject *__pyx_v_winit = 0;
  PyObject *__pyx_v_vfunc = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_r;
  __Pyx_Buffer __pyx_pybuffer_r;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
  __Pyx_Buffer __pyx_pybuffer_v;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_w;
  __Pyx_Buffer __pyx_pybuffer_w;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_winit;
  __Pyx_Buffer __pyx_pybuffer_winit;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_0cycompute_weights", 0);
  __pyx_cur_scope = (struct __pyx_obj_7cubecal_7kernels_16cyfull_W_complex___pyx_scope_struct____pyx_fuse_0cycompute_weights *)__pyx_tp_new_7cubecal_7kernels_16cyfull_W_complex___pyx_scope_struct____pyx_fuse_0cycompute_weights(__pyx_ptype_7cubecal_7kernels_16cyfull_W_complex___pyx_scope_struct____pyx_fuse_0cycompute_weights, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return NULL;
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope);
  __pyx_pybuffer_winit.pybuffer.buf = NULL;
  __pyx_pybuffer_winit.refcount = 0;
  __pyx_pybuffernd_winit.data = NULL;
  __pyx_pybuffernd_winit.rcbuffer = &amp;__pyx_pybuffer_winit;
  __pyx_pybuffer_r.pybuffer.buf = NULL;
  __pyx_pybuffer_r.refcount = 0;
  __pyx_pybuffernd_r.data = NULL;
  __pyx_pybuffernd_r.rcbuffer = &amp;__pyx_pybuffer_r;
  __pyx_pybuffer_w.pybuffer.buf = NULL;
  __pyx_pybuffer_w.refcount = 0;
  __pyx_pybuffernd_w.data = NULL;
  __pyx_pybuffernd_w.rcbuffer = &amp;__pyx_pybuffer_w;
  __pyx_pybuffer_v.pybuffer.buf = NULL;
  __pyx_pybuffer_v.refcount = 0;
  __pyx_pybuffernd_v.data = NULL;
  __pyx_pybuffernd_v.rcbuffer = &amp;__pyx_pybuffer_v;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_r, &amp;__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 7, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_r.diminfo[0].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_r.diminfo[0].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_r.diminfo[1].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_r.diminfo[1].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_r.diminfo[2].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_r.diminfo[2].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_r.diminfo[3].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_r.diminfo[3].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_r.diminfo[4].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_r.diminfo[4].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_r.diminfo[5].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_r.diminfo[5].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_r.diminfo[6].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_r.diminfo[6].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[6];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_w, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 5, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_w.diminfo[0].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_w.diminfo[0].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_w.diminfo[1].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_w.diminfo[1].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_w.diminfo[2].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_w.diminfo[2].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_w.diminfo[3].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_w.diminfo[3].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_w.diminfo[4].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_w.diminfo[4].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[4];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_v.diminfo[1].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_v.diminfo[1].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_v.diminfo[2].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_v.diminfo[2].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[2];
  __pyx_tuple__34 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Function_call_with_ambiguous_arg);<span class='error_goto'> if (unlikely(!__pyx_tuple__34)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__34);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__34);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_27, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_winit.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_weights", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_winit.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_f);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_aa);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ab);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rc);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_winit);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vfunc);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_61cycompute_weights(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_fuse_1__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_61cycompute_weights = {"__pyx_fuse_1cycompute_weights", (PyCFunction)__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_61cycompute_weights, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7cubecal_7kernels_16cyfull_W_complex_14cycompute_weights};
static PyObject *__pyx_fuse_1__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_61cycompute_weights(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_r = 0;
  PyArrayObject *__pyx_v_w = 0;
  PyArrayObject *__pyx_v_v = 0;
  int __pyx_v_t_int;
  int __pyx_v_f_int;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cycompute_weights (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_r,&amp;__pyx_n_s_w,&amp;__pyx_n_s_v,&amp;__pyx_n_s_t_int,&amp;__pyx_n_s_f_int,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_w)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_weights", 1, 5, 5, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_weights", 1, 5, 5, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_t_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_weights", 1, 5, 5, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_f_int)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_weights", 1, 5, 5, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cycompute_weights") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_r = ((PyArrayObject *)values[0]);
    __pyx_v_w = ((PyArrayObject *)values[1]);
    __pyx_v_v = ((PyArrayObject *)values[2]);
    __pyx_v_t_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_t_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_f_int = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_f_int == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cycompute_weights", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_weights", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_r), __pyx_ptype_5numpy_ndarray, 1, "r", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_w), __pyx_ptype_5numpy_ndarray, 1, "w", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_7cubecal_7kernels_16cyfull_W_complex_60cycompute_weights(__pyx_self, __pyx_v_r, __pyx_v_w, __pyx_v_v, __pyx_v_t_int, __pyx_v_f_int);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_7cubecal_7kernels_16cyfull_W_complex_60cycompute_weights(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_r, PyArrayObject *__pyx_v_w, PyArrayObject *__pyx_v_v, int __pyx_v_t_int, int __pyx_v_f_int) {
  struct __pyx_obj_7cubecal_7kernels_16cyfull_W_complex___pyx_scope_struct_1___pyx_fuse_1cycompute_weights *__pyx_cur_scope;
  PyObject *__pyx_v_i = 0;
  PyObject *__pyx_v_t = 0;
  PyObject *__pyx_v_f = 0;
  PyObject *__pyx_v_aa = 0;
  PyObject *__pyx_v_ab = 0;
  PyObject *__pyx_v_rr = 0;
  PyObject *__pyx_v_rc = 0;
  int __pyx_v_n_mod;
  int __pyx_v_n_tim;
  int __pyx_v_n_fre;
  int __pyx_v_n_ant;
  double __pyx_v_d;
  PyArrayObject *__pyx_v_winit = 0;
  PyObject *__pyx_v_vfunc = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_r;
  __Pyx_Buffer __pyx_pybuffer_r;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
  __Pyx_Buffer __pyx_pybuffer_v;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_w;
  __Pyx_Buffer __pyx_pybuffer_w;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_winit;
  __Pyx_Buffer __pyx_pybuffer_winit;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__pyx_fuse_1cycompute_weights", 0);
  __pyx_cur_scope = (struct __pyx_obj_7cubecal_7kernels_16cyfull_W_complex___pyx_scope_struct_1___pyx_fuse_1cycompute_weights *)__pyx_tp_new_7cubecal_7kernels_16cyfull_W_complex___pyx_scope_struct_1___pyx_fuse_1cycompute_weights(__pyx_ptype_7cubecal_7kernels_16cyfull_W_complex___pyx_scope_struct_1___pyx_fuse_1cycompute_weights, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return NULL;
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope);
  __pyx_pybuffer_winit.pybuffer.buf = NULL;
  __pyx_pybuffer_winit.refcount = 0;
  __pyx_pybuffernd_winit.data = NULL;
  __pyx_pybuffernd_winit.rcbuffer = &amp;__pyx_pybuffer_winit;
  __pyx_pybuffer_r.pybuffer.buf = NULL;
  __pyx_pybuffer_r.refcount = 0;
  __pyx_pybuffernd_r.data = NULL;
  __pyx_pybuffernd_r.rcbuffer = &amp;__pyx_pybuffer_r;
  __pyx_pybuffer_w.pybuffer.buf = NULL;
  __pyx_pybuffer_w.refcount = 0;
  __pyx_pybuffernd_w.data = NULL;
  __pyx_pybuffernd_w.rcbuffer = &amp;__pyx_pybuffer_w;
  __pyx_pybuffer_v.pybuffer.buf = NULL;
  __pyx_pybuffer_v.refcount = 0;
  __pyx_pybuffernd_v.data = NULL;
  __pyx_pybuffernd_v.rcbuffer = &amp;__pyx_pybuffer_v;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_r, &amp;__Pyx_TypeInfo___pyx_t_double_complex, PyBUF_FORMAT| PyBUF_STRIDES, 7, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_r.diminfo[0].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_r.diminfo[0].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_r.diminfo[1].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_r.diminfo[1].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_r.diminfo[2].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_r.diminfo[2].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_r.diminfo[3].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_r.diminfo[3].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_r.diminfo[4].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_r.diminfo[4].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[4]; __pyx_pybuffernd_r.diminfo[5].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[5]; __pyx_pybuffernd_r.diminfo[5].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[5]; __pyx_pybuffernd_r.diminfo[6].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[6]; __pyx_pybuffernd_r.diminfo[6].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[6];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_w, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 5, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_w.diminfo[0].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_w.diminfo[0].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_w.diminfo[1].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_w.diminfo[1].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_w.diminfo[2].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_w.diminfo[2].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_w.diminfo[3].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_w.diminfo[3].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_w.diminfo[4].strides = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_w.diminfo[4].shape = __pyx_pybuffernd_w.rcbuffer-&gt;pybuffer.shape[4];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_v.diminfo[1].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_v.diminfo[1].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_v.diminfo[2].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_v.diminfo[2].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[2];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_27, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_winit.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_weights", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_w.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_winit.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_f);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_aa);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ab);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rc);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_winit);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vfunc);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__72 = <span class='py_c_api'>PyTuple_Pack</span>(21, __pyx_n_s_r, __pyx_n_s_w, __pyx_n_s_v, __pyx_n_s_t_int, __pyx_n_s_f_int, __pyx_n_s_i, __pyx_n_s_t, __pyx_n_s_f, __pyx_n_s_aa, __pyx_n_s_ab, __pyx_n_s_rr, __pyx_n_s_rc, __pyx_n_s_n_mod, __pyx_n_s_n_tim, __pyx_n_s_n_fre, __pyx_n_s_n_ant, __pyx_n_s_m, __pyx_n_s_d, __pyx_n_s_winit, __pyx_n_s_wn, __pyx_n_s_vfunc);<span class='error_goto'> if (unlikely(!__pyx_tuple__72)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__72);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__72);
/* … */
  __pyx_t_15 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  __pyx_t_16 = __pyx_FusedFunction_NewEx(&amp;__pyx_fuse_0__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_59cycompute_weights, 0, __pyx_n_s_cycompute_weights, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__73));<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_16, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_15, __pyx_kp_s_float_complex, __pyx_t_16) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  __pyx_t_16 = __pyx_FusedFunction_NewEx(&amp;__pyx_fuse_1__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_61cycompute_weights, 0, __pyx_n_s_cycompute_weights, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__73));<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_16, __pyx_empty_tuple);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_15, __pyx_kp_s_double_complex, __pyx_t_16) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  __pyx_t_16 = __pyx_FusedFunction_NewEx(&amp;__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_15cycompute_weights, 0, __pyx_n_s_cycompute_weights, NULL, __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, ((PyObject *)__pyx_codeobj__73));<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_16, __pyx_empty_tuple);
  ((__pyx_FusedFunctionObject *) __pyx_t_16)-&gt;__signatures__ = __pyx_t_15;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_cycompute_weights, __pyx_t_16) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  __pyx_codeobj__73 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 21, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__72, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_ulrich_CubeCal_cubecal_ker, __pyx_n_s_cycompute_weights, 347, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__73)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
/* … */
struct __pyx_obj_7cubecal_7kernels_16cyfull_W_complex___pyx_scope_struct____pyx_fuse_0cycompute_weights {
  PyObject_HEAD
  int __pyx_v_m;
  __Pyx_memviewslice __pyx_v_wn;
};

struct __pyx_obj_7cubecal_7kernels_16cyfull_W_complex___pyx_scope_struct_1___pyx_fuse_1cycompute_weights {
  PyObject_HEAD
  int __pyx_v_m;
  __Pyx_memviewslice __pyx_v_wn;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">348</span>:                         np.ndarray[np.double_t, ndim=5] w,</pre>
<pre class="cython line score-0">&#xA0;<span class="">349</span>:                         np.ndarray[np.double_t, ndim=3] v,</pre>
<pre class="cython line score-0">&#xA0;<span class="">350</span>:                         int t_int,</pre>
<pre class="cython line score-0">&#xA0;<span class="">351</span>:                         int f_int):</pre>
<pre class="cython line score-0">&#xA0;<span class="">352</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">353</span>:     This computes the weights, given the latest residual visibilities and the v parameter.</pre>
<pre class="cython line score-0">&#xA0;<span class="">354</span>:     w[i] = (v+2)/(v + 2*residual[i]^2). Next v is update using the newly compute weights.</pre>
<pre class="cython line score-0">&#xA0;<span class="">355</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">356</span>: </pre>
<pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">357</span>:     cdef i, t, f, aa, ab, rr, rc = 0</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_v_rc = __pyx_int_0;
/* … */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_v_rc = __pyx_int_0;
</pre><pre class="cython line score-0">&#xA0;<span class="">358</span>:     cdef int n_mod, n_tim, n_fre, n_ant, m</pre>
<pre class="cython line score-0">&#xA0;<span class="">359</span>:     cdef double d</pre>
<pre class="cython line score-0">&#xA0;<span class="">360</span>:     cdef np.ndarray[np.double_t, ndim=1] winit</pre>
<pre class="cython line score-0">&#xA0;<span class="">361</span>:     cdef np.double_t[:] wn</pre>
<pre class="cython line score-0">&#xA0;<span class="">362</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">363</span>:     n_mod = r.shape[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_mod = (__pyx_v_r-&gt;dimensions[0]);
/* … */
  __pyx_v_n_mod = (__pyx_v_r-&gt;dimensions[0]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">364</span>:     n_tim = r.shape[1]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_tim = (__pyx_v_r-&gt;dimensions[1]);
/* … */
  __pyx_v_n_tim = (__pyx_v_r-&gt;dimensions[1]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">365</span>:     n_fre = r.shape[2]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_fre = (__pyx_v_r-&gt;dimensions[2]);
/* … */
  __pyx_v_n_fre = (__pyx_v_r-&gt;dimensions[2]);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">366</span>:     n_ant = r.shape[3]</pre>
<pre class='cython code score-0 '>  __pyx_v_n_ant = (__pyx_v_r-&gt;dimensions[3]);
/* … */
  __pyx_v_n_ant = (__pyx_v_r-&gt;dimensions[3]);
</pre><pre class="cython line score-0">&#xA0;<span class="">367</span>: </pre>
<pre class="cython line score-116" onclick='toggleDiv(this)'>+<span class="">368</span>:     for i in xrange(n_mod):</pre>
<pre class='cython code score-116 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_mod);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_xrange, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_mod);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_xrange, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-116" onclick='toggleDiv(this)'>+<span class="">369</span>:         for t in xrange(n_tim):</pre>
<pre class='cython code score-116 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_tim);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_xrange, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_5 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_6 = 0;
      __pyx_t_7 = NULL;
    } else {
      __pyx_t_6 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_7 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_7)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_7(__pyx_t_5);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t, __pyx_t_1);
      __pyx_t_1 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_tim);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_xrange, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_5 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_6 = 0;
      __pyx_t_7 = NULL;
    } else {
      __pyx_t_6 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_7 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_7)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_7(__pyx_t_5);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t, __pyx_t_1);
      __pyx_t_1 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-12" onclick='toggleDiv(this)'>+<span class="">370</span>:             rr = t/t_int</pre>
<pre class='cython code score-12 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_t_int);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_t, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_rr, __pyx_t_8);
      __pyx_t_8 = 0;
/* … */
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_t_int);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_t, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_rr, __pyx_t_8);
      __pyx_t_8 = 0;
</pre><pre class="cython line score-116" onclick='toggleDiv(this)'>+<span class="">371</span>:             for f in xrange(n_fre):</pre>
<pre class='cython code score-116 '>      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_fre);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_8);
      __pyx_t_8 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_xrange, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_8)) {
        __pyx_t_1 = __pyx_t_8; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_9 = 0;
        __pyx_t_10 = NULL;
      } else {
        __pyx_t_9 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_10 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      for (;;) {
        if (likely(!__pyx_t_10)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
            if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            #else
            __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            #endif
          } else {
            if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            #else
            __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            #endif
          }
        } else {
          __pyx_t_8 = __pyx_t_10(__pyx_t_1);
          if (unlikely(!__pyx_t_8)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_f, __pyx_t_8);
        __pyx_t_8 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_fre);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_8);
      __pyx_t_8 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_xrange, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_8)) {
        __pyx_t_1 = __pyx_t_8; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_9 = 0;
        __pyx_t_10 = NULL;
      } else {
        __pyx_t_9 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_10 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      for (;;) {
        if (likely(!__pyx_t_10)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
            if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            #else
            __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            #endif
          } else {
            if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            #else
            __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            #endif
          }
        } else {
          __pyx_t_8 = __pyx_t_10(__pyx_t_1);
          if (unlikely(!__pyx_t_8)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_f, __pyx_t_8);
        __pyx_t_8 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-12" onclick='toggleDiv(this)'>+<span class="">372</span>:                 rc = f/f_int</pre>
<pre class='cython code score-12 '>        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_f_int);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_f, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_rc, __pyx_t_11);
        __pyx_t_11 = 0;
/* … */
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_f_int);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_f, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_rc, __pyx_t_11);
        __pyx_t_11 = 0;
</pre><pre class="cython line score-116" onclick='toggleDiv(this)'>+<span class="">373</span>:                 for aa in xrange(n_ant):</pre>
<pre class='cython code score-116 '>        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_ant);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_11);
        __pyx_t_11 = 0;
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_xrange, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_11)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_11)) {
          __pyx_t_8 = __pyx_t_11; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_12 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_12 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_13 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {
              if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_8)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_12++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              #else
              __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
              #endif
            } else {
              if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_8)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_12++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              #else
              __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
              #endif
            }
          } else {
            __pyx_t_11 = __pyx_t_13(__pyx_t_8);
            if (unlikely(!__pyx_t_11)) {
              PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              }
              break;
            }
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_aa, __pyx_t_11);
          __pyx_t_11 = 0;
/* … */
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/* … */
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_ant);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_11);
        __pyx_t_11 = 0;
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_xrange, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_11)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_11)) {
          __pyx_t_8 = __pyx_t_11; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_12 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_12 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_13 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {
              if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_8)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_12++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              #else
              __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
              #endif
            } else {
              if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_8)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_12++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              #else
              __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
              #endif
            }
          } else {
            __pyx_t_11 = __pyx_t_13(__pyx_t_8);
            if (unlikely(!__pyx_t_11)) {
              PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              }
              break;
            }
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_aa, __pyx_t_11);
          __pyx_t_11 = 0;
/* … */
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-116" onclick='toggleDiv(this)'>+<span class="">374</span>:                     for ab in xrange(n_ant):</pre>
<pre class='cython code score-116 '>          __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_ant);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
          __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_11);
          __pyx_t_11 = 0;
          __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_xrange, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_11)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_11)) {
            __pyx_t_14 = __pyx_t_11; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14); __pyx_t_15 = 0;
            __pyx_t_16 = NULL;
          } else {
            __pyx_t_15 = -1; __pyx_t_14 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
            __pyx_t_16 = Py_TYPE(__pyx_t_14)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          for (;;) {
            if (likely(!__pyx_t_16)) {
              if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_14))) {
                if (__pyx_t_15 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_14)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_14, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_15++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                #else
                __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_14, __pyx_t_15); __pyx_t_15++;<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
                #endif
              } else {
                if (__pyx_t_15 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_14)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_14, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_15++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                #else
                __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_14, __pyx_t_15); __pyx_t_15++;<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
                #endif
              }
            } else {
              __pyx_t_11 = __pyx_t_16(__pyx_t_14);
              if (unlikely(!__pyx_t_11)) {
                PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
                if (exc_type) {
                  if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                  else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                }
                break;
              }
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
            }
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ab, __pyx_t_11);
            __pyx_t_11 = 0;
/* … */
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
/* … */
          __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_ant);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
          __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_11);
          __pyx_t_11 = 0;
          __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_xrange, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_11)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_11)) {
            __pyx_t_14 = __pyx_t_11; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14); __pyx_t_15 = 0;
            __pyx_t_16 = NULL;
          } else {
            __pyx_t_15 = -1; __pyx_t_14 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
            __pyx_t_16 = Py_TYPE(__pyx_t_14)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          for (;;) {
            if (likely(!__pyx_t_16)) {
              if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_14))) {
                if (__pyx_t_15 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_14)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_14, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_15++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                #else
                __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_14, __pyx_t_15); __pyx_t_15++;<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
                #endif
              } else {
                if (__pyx_t_15 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_14)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_14, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_15++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                #else
                __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_14, __pyx_t_15); __pyx_t_15++;<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
                #endif
              }
            } else {
              __pyx_t_11 = __pyx_t_16(__pyx_t_14);
              if (unlikely(!__pyx_t_11)) {
                PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
                if (exc_type) {
                  if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                  else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                }
                break;
              }
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
            }
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ab, __pyx_t_11);
            __pyx_t_11 = 0;
/* … */
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-140" onclick='toggleDiv(this)'>+<span class="">375</span>:                         w[i,t,f,aa,ab] = (v[i,rr,rc]+2)/(v[i,rr,rc] + \</pre>
<pre class='cython code score-140 '>            __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rr);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rr);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_v_rr);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rc);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rc);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2, __pyx_v_rc);
            __pyx_t_17 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_v), __pyx_t_11);<span class='error_goto'> if (unlikely(__pyx_t_17 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
            __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_17, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rr);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rr);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1, __pyx_v_rr);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rc);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rc);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 2, __pyx_v_rc);
            __pyx_t_18 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_v), __pyx_t_17);<span class='error_goto'> if (unlikely(__pyx_t_18 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
/* … */
            __pyx_t_17 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_18, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
            __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_11, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 4, __pyx_v_ab);
            if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_w), __pyx_t_17, __pyx_t_21) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
/* … */
            __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rr);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rr);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_v_rr);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rc);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rc);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2, __pyx_v_rc);
            __pyx_t_17 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_v), __pyx_t_11);<span class='error_goto'> if (unlikely(__pyx_t_17 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
            __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_17, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rr);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rr);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1, __pyx_v_rr);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rc);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rc);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 2, __pyx_v_rc);
            __pyx_t_18 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_v), __pyx_t_17);<span class='error_goto'> if (unlikely(__pyx_t_18 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
/* … */
            __pyx_t_17 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_18, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
            __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_11, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 4, __pyx_v_ab);
            if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_w), __pyx_t_17, __pyx_t_21) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
</pre><pre class="cython line score-178" onclick='toggleDiv(this)'>+<span class="">376</span>:                                 2*(r[i,t,f,aa,ab,0,0].conjugate()*r[i,t,f,aa,ab,0,0] + \</pre>
<pre class='cython code score-178 '>            __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 4, __pyx_v_ab);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 5, __pyx_int_0);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 6, __pyx_int_0);
            __pyx_t_20 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_r), __pyx_t_19);<span class='error_goto'> if (unlikely(__pyx_t_20 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_20, __pyx_n_s_conjugate);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
            __pyx_t_20 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_19))) {
              __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_19);
              if (likely(__pyx_t_20)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_19);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_19, function);
              }
            }
            if (__pyx_t_20) {
              __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_19, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
            } else {
              __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 4, __pyx_v_ab);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 5, __pyx_int_0);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 6, __pyx_int_0);
            __pyx_t_20 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_r), __pyx_t_19);<span class='error_goto'> if (unlikely(__pyx_t_20 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_17, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
/* … */
            __pyx_t_21 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_19, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
/* … */
            __pyx_t_21 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_2, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
/* … */
            __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 4, __pyx_v_ab);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 5, __pyx_int_0);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 6, __pyx_int_0);
            __pyx_t_20 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_r), __pyx_t_19);<span class='error_goto'> if (unlikely(__pyx_t_20 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_20, __pyx_n_s_conjugate);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
            __pyx_t_20 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_19))) {
              __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_19);
              if (likely(__pyx_t_20)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_19);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_19, function);
              }
            }
            if (__pyx_t_20) {
              __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_19, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
            } else {
              __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 4, __pyx_v_ab);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 5, __pyx_int_0);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 6, __pyx_int_0);
            __pyx_t_20 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_r), __pyx_t_19);<span class='error_goto'> if (unlikely(__pyx_t_20 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_17, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
/* … */
            __pyx_t_21 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_19, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
/* … */
            __pyx_t_21 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_2, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
</pre><pre class="cython line score-166" onclick='toggleDiv(this)'>+<span class="">377</span>:                                 r[i,t,f,aa,ab,0,1].conjugate()*r[i,t,f,aa,ab,0,1] + \</pre>
<pre class='cython code score-166 '>            __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 4, __pyx_v_ab);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 5, __pyx_int_0);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 6, __pyx_int_1);
            __pyx_t_21 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_r), __pyx_t_17);<span class='error_goto'> if (unlikely(__pyx_t_21 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_conjugate);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
            __pyx_t_21 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_17))) {
              __pyx_t_21 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_17);
              if (likely(__pyx_t_21)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_17);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_21);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_17, function);
              }
            }
            if (__pyx_t_21) {
              __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_17, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
            } else {
              __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 4, __pyx_v_ab);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 5, __pyx_int_0);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 6, __pyx_int_1);
            __pyx_t_21 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_r), __pyx_t_17);<span class='error_goto'> if (unlikely(__pyx_t_21 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            __pyx_t_17 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_20, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
/* … */
            __pyx_t_20 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_21, __pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
/* … */
            __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 4, __pyx_v_ab);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 5, __pyx_int_0);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 6, __pyx_int_1);
            __pyx_t_21 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_r), __pyx_t_17);<span class='error_goto'> if (unlikely(__pyx_t_21 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_conjugate);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
            __pyx_t_21 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_17))) {
              __pyx_t_21 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_17);
              if (likely(__pyx_t_21)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_17);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_21);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_17, function);
              }
            }
            if (__pyx_t_21) {
              __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_17, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
            } else {
              __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 4, __pyx_v_ab);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 5, __pyx_int_0);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 6, __pyx_int_1);
            __pyx_t_21 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_r), __pyx_t_17);<span class='error_goto'> if (unlikely(__pyx_t_21 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            __pyx_t_17 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_20, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
/* … */
            __pyx_t_20 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_21, __pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
</pre><pre class="cython line score-166" onclick='toggleDiv(this)'>+<span class="">378</span>:                                 r[i,t,f,aa,ab,1,0].conjugate()*r[i,t,f,aa,ab,1,0] + \</pre>
<pre class='cython code score-166 '>            __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 4, __pyx_v_ab);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 5, __pyx_int_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 6, __pyx_int_0);
            __pyx_t_20 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_r), __pyx_t_19);<span class='error_goto'> if (unlikely(__pyx_t_20 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_20, __pyx_n_s_conjugate);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
            __pyx_t_20 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_19))) {
              __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_19);
              if (likely(__pyx_t_20)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_19);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_19, function);
              }
            }
            if (__pyx_t_20) {
              __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_19, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
            } else {
              __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 4, __pyx_v_ab);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 5, __pyx_int_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 6, __pyx_int_0);
            __pyx_t_20 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_r), __pyx_t_19);<span class='error_goto'> if (unlikely(__pyx_t_20 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_17, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
/* … */
            __pyx_t_17 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_20, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
/* … */
            __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 4, __pyx_v_ab);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 5, __pyx_int_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 6, __pyx_int_0);
            __pyx_t_20 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_r), __pyx_t_19);<span class='error_goto'> if (unlikely(__pyx_t_20 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_20, __pyx_n_s_conjugate);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
            __pyx_t_20 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_19))) {
              __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_19);
              if (likely(__pyx_t_20)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_19);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_19, function);
              }
            }
            if (__pyx_t_20) {
              __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_19, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
            } else {
              __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 4, __pyx_v_ab);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 5, __pyx_int_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 6, __pyx_int_0);
            __pyx_t_20 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_r), __pyx_t_19);<span class='error_goto'> if (unlikely(__pyx_t_20 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_17, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
/* … */
            __pyx_t_17 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_20, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
</pre><pre class="cython line score-152" onclick='toggleDiv(this)'>+<span class="">379</span>:                                 r[i,t,f,aa,ab,1,1].conjugate()*r[i,t,f,aa,ab,1,1]))</pre>
<pre class='cython code score-152 '>            __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 4, __pyx_v_ab);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 5, __pyx_int_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 6, __pyx_int_1);
            __pyx_t_17 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_r), __pyx_t_21);<span class='error_goto'> if (unlikely(__pyx_t_17 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
            __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_17, __pyx_n_s_conjugate);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            __pyx_t_17 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_21))) {
              __pyx_t_17 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_21);
              if (likely(__pyx_t_17)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_21);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_21, function);
              }
            }
            if (__pyx_t_17) {
              __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_21, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            } else {
              __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
            __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 4, __pyx_v_ab);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 5, __pyx_int_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 6, __pyx_int_1);
            __pyx_t_17 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_r), __pyx_t_21);<span class='error_goto'> if (unlikely(__pyx_t_17 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
            __pyx_t_21 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_19, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
/* … */
            __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 4, __pyx_v_ab);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 5, __pyx_int_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 6, __pyx_int_1);
            __pyx_t_17 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_r), __pyx_t_21);<span class='error_goto'> if (unlikely(__pyx_t_17 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
            __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_17, __pyx_n_s_conjugate);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            __pyx_t_17 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_21))) {
              __pyx_t_17 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_21);
              if (likely(__pyx_t_17)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_21);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_21, function);
              }
            }
            if (__pyx_t_17) {
              __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_21, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
            } else {
              __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
            __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_v_i);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 1, __pyx_v_t);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 2, __pyx_v_f);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aa);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 3, __pyx_v_aa);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ab);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ab);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 4, __pyx_v_ab);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 5, __pyx_int_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 6, __pyx_int_1);
            __pyx_t_17 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_r), __pyx_t_21);<span class='error_goto'> if (unlikely(__pyx_t_17 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
            __pyx_t_21 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_19, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">380</span>: </pre>
<pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">381</span>:     rr = n_tim/t_int</pre>
<pre class='cython code score-6 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((__pyx_v_n_tim / __pyx_v_t_int));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_rr, __pyx_t_2);
  __pyx_t_2 = 0;
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((__pyx_v_n_tim / __pyx_v_t_int));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_rr, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">382</span>:     rc = n_fre/f_int</pre>
<pre class='cython code score-6 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((__pyx_v_n_fre / __pyx_v_f_int));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_rc, __pyx_t_2);
  __pyx_t_2 = 0;
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((__pyx_v_n_fre / __pyx_v_f_int));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_rc, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">383</span>: </pre>
<pre class="cython line score-116" onclick='toggleDiv(this)'>+<span class="">384</span>:     for i in xrange(n_mod):</pre>
<pre class='cython code score-116 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_mod);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_xrange, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_5 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_4(__pyx_t_5);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_mod);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_xrange, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_5 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_4(__pyx_t_5);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-126" onclick='toggleDiv(this)'>+<span class="">385</span>:         for t in xrange(0, n_tim, t_int):</pre>
<pre class='cython code score-126 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_tim);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_t_int);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_xrange, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_8 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_6 = 0;
      __pyx_t_7 = NULL;
    } else {
      __pyx_t_6 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_7 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_7)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_8)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_8)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_7(__pyx_t_8);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t, __pyx_t_1);
      __pyx_t_1 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/* … */
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_tim);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_t_int);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_xrange, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_8 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_6 = 0;
      __pyx_t_7 = NULL;
    } else {
      __pyx_t_6 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_7 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_7)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_8)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_8)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_7(__pyx_t_8);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t, __pyx_t_1);
      __pyx_t_1 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-126" onclick='toggleDiv(this)'>+<span class="">386</span>:             for f in xrange(0, n_fre, f_int):</pre>
<pre class='cython code score-126 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_fre);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_f_int);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 2, __pyx_t_2);
      __pyx_t_1 = 0;
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_xrange, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
        __pyx_t_14 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14); __pyx_t_9 = 0;
        __pyx_t_10 = NULL;
      } else {
        __pyx_t_9 = -1; __pyx_t_14 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        __pyx_t_10 = Py_TYPE(__pyx_t_14)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      for (;;) {
        if (likely(!__pyx_t_10)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_14))) {
            if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_14)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_14, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            #else
            __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_14, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            #endif
          } else {
            if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_14)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_14, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            #else
            __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_14, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            #endif
          }
        } else {
          __pyx_t_2 = __pyx_t_10(__pyx_t_14);
          if (unlikely(!__pyx_t_2)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_f, __pyx_t_2);
        __pyx_t_2 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
/* … */
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_fre);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_f_int);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 2, __pyx_t_2);
      __pyx_t_1 = 0;
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_xrange, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
        __pyx_t_14 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14); __pyx_t_9 = 0;
        __pyx_t_10 = NULL;
      } else {
        __pyx_t_9 = -1; __pyx_t_14 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        __pyx_t_10 = Py_TYPE(__pyx_t_14)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      for (;;) {
        if (likely(!__pyx_t_10)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_14))) {
            if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_14)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_14, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            #else
            __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_14, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            #endif
          } else {
            if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_14)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_14, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            #else
            __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_14, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            #endif
          }
        } else {
          __pyx_t_2 = __pyx_t_10(__pyx_t_14);
          if (unlikely(!__pyx_t_2)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_f, __pyx_t_2);
        __pyx_t_2 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-198" onclick='toggleDiv(this)'>+<span class="">387</span>:                 winit = np.reshape(w[t:t+t_int,f+f_int,:,:],(t_int*f_int*n_ant*n_ant))</pre>
<pre class='cython code score-198 '>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_t_int);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_17 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_t, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_t, __pyx_t_17, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_f_int);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        __pyx_t_11 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_f, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
/* … */
  __pyx_slice__35 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__35)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__35);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__35);
        __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1, __pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__35);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__35);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 2, __pyx_slice__35);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__36);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__36);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 3, __pyx_slice__36);
        __pyx_t_1 = 0;
        __pyx_t_11 = 0;
        __pyx_t_11 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_w), __pyx_t_17);<span class='error_goto'> if (unlikely(__pyx_t_11 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((((__pyx_v_t_int * __pyx_v_f_int) * __pyx_v_n_ant) * __pyx_v_n_ant));<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        __pyx_t_1 = NULL;
        __pyx_t_12 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_21))) {
          __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_21);
          if (likely(__pyx_t_1)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_21, function);
            __pyx_t_12 = 1;
          }
        }
        __pyx_t_18 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        if (__pyx_t_1) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0, __pyx_t_1); __pyx_t_1 = NULL;
        }
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0+__pyx_t_12, __pyx_t_11);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 1+__pyx_t_12, __pyx_t_17);
        __pyx_t_11 = 0;
        __pyx_t_17 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_21, __pyx_t_18, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
        if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_22 = ((PyArrayObject *)__pyx_t_2);
        {
          __Pyx_BufFmt_StackElem __pyx_stack[1];
          <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_winit.rcbuffer-&gt;pybuffer);
          __pyx_t_23 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_winit.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_22, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
          if (unlikely(__pyx_t_23 &lt; 0)) {
            <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_24, &amp;__pyx_t_25, &amp;__pyx_t_26);
            if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_winit.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_winit, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
              Py_XDECREF(__pyx_t_24); Py_XDECREF(__pyx_t_25); Py_XDECREF(__pyx_t_26);
              <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
            } else {
              <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_24, __pyx_t_25, __pyx_t_26);
            }
          }
          __pyx_pybuffernd_winit.diminfo[0].strides = __pyx_pybuffernd_winit.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_winit.diminfo[0].shape = __pyx_pybuffernd_winit.rcbuffer-&gt;pybuffer.shape[0];
          if (unlikely(__pyx_t_23 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_22 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_winit, ((PyArrayObject *)__pyx_t_2));
        __pyx_t_2 = 0;
/* … */
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_t_int);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_17 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_t, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_t, __pyx_t_17, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_f_int);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        __pyx_t_11 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_f, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  __pyx_slice__36 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__36)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__36);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__36);
  __pyx_slice__37 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__37)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__37);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__37);
        __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1, __pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__37);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__37);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 2, __pyx_slice__37);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__38);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__38);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 3, __pyx_slice__38);
        __pyx_t_1 = 0;
        __pyx_t_11 = 0;
        __pyx_t_11 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_w), __pyx_t_17);<span class='error_goto'> if (unlikely(__pyx_t_11 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((((__pyx_v_t_int * __pyx_v_f_int) * __pyx_v_n_ant) * __pyx_v_n_ant));<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        __pyx_t_1 = NULL;
        __pyx_t_12 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_21))) {
          __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_21);
          if (likely(__pyx_t_1)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_21);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_21, function);
            __pyx_t_12 = 1;
          }
        }
        __pyx_t_18 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        if (__pyx_t_1) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0, __pyx_t_1); __pyx_t_1 = NULL;
        }
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0+__pyx_t_12, __pyx_t_11);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 1+__pyx_t_12, __pyx_t_17);
        __pyx_t_11 = 0;
        __pyx_t_17 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_21, __pyx_t_18, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
        if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_22 = ((PyArrayObject *)__pyx_t_2);
        {
          __Pyx_BufFmt_StackElem __pyx_stack[1];
          <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_winit.rcbuffer-&gt;pybuffer);
          __pyx_t_23 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_winit.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_22, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
          if (unlikely(__pyx_t_23 &lt; 0)) {
            <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_24, &amp;__pyx_t_25, &amp;__pyx_t_26);
            if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_winit.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_winit, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
              Py_XDECREF(__pyx_t_24); Py_XDECREF(__pyx_t_25); Py_XDECREF(__pyx_t_26);
              <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
            } else {
              <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_24, __pyx_t_25, __pyx_t_26);
            }
          }
          __pyx_pybuffernd_winit.diminfo[0].strides = __pyx_pybuffernd_winit.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_winit.diminfo[0].shape = __pyx_pybuffernd_winit.rcbuffer-&gt;pybuffer.shape[0];
          if (unlikely(__pyx_t_23 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_22 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_winit, ((PyArrayObject *)__pyx_t_2));
        __pyx_t_2 = 0;
  __pyx_slice__38 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__38)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__38);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__38);
</pre><pre class="cython line score-82" onclick='toggleDiv(this)'>+<span class="">388</span>:                 wn = winit[np.where(winit!=0)]</pre>
<pre class='cython code score-82 '>        __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_where);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
        __pyx_t_21 = <span class='py_c_api'>PyObject_RichCompare</span>(((PyObject *)__pyx_v_winit), __pyx_int_0, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_17 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_18))) {
          __pyx_t_17 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_18);
          if (likely(__pyx_t_17)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_18);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_18, function);
          }
        }
        if (!__pyx_t_17) {
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_18, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        } else {
          __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_17); __pyx_t_17 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+1, __pyx_t_21);
          __pyx_t_21 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_18, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_t_18 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_winit), __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_18 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_27 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_5numpy_double_t(__pyx_t_18);
        if (unlikely(!__pyx_t_27.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __PYX_XDEC_MEMVIEW(&amp;__pyx_cur_scope-&gt;__pyx_v_wn, 1);
        __pyx_cur_scope-&gt;__pyx_v_wn = __pyx_t_27;
        __pyx_t_27.memview = NULL;
        __pyx_t_27.data = NULL;
/* … */
        __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_where);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
        __pyx_t_21 = <span class='py_c_api'>PyObject_RichCompare</span>(((PyObject *)__pyx_v_winit), __pyx_int_0, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_17 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_18))) {
          __pyx_t_17 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_18);
          if (likely(__pyx_t_17)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_18);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_18, function);
          }
        }
        if (!__pyx_t_17) {
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_18, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        } else {
          __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_17); __pyx_t_17 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+1, __pyx_t_21);
          __pyx_t_21 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_18, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_t_18 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_winit), __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_18 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_27 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_5numpy_double_t(__pyx_t_18);
        if (unlikely(!__pyx_t_27.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __PYX_XDEC_MEMVIEW(&amp;__pyx_cur_scope-&gt;__pyx_v_wn, 1);
        __pyx_cur_scope-&gt;__pyx_v_wn = __pyx_t_27;
        __pyx_t_27.memview = NULL;
        __pyx_t_27.data = NULL;
</pre><pre class="cython line score-12" onclick='toggleDiv(this)'>+<span class="">389</span>:                 m = len(wn)</pre>
<pre class='cython code score-12 '>        __pyx_t_18 = __pyx_memoryview_fromslice(__pyx_cur_scope-&gt;__pyx_v_wn, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_5numpy_double_t, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_5numpy_double_t, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_18);<span class='error_goto'> if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_cur_scope-&gt;__pyx_v_m = __pyx_t_12;
/* … */
        __pyx_t_18 = __pyx_memoryview_fromslice(__pyx_cur_scope-&gt;__pyx_v_wn, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_5numpy_double_t, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_5numpy_double_t, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_18);<span class='error_goto'> if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_cur_scope-&gt;__pyx_v_m = __pyx_t_12;
</pre><pre class="cython line score-0">&#xA0;<span class="">390</span>: </pre>
<pre class="cython line score-542" onclick='toggleDiv(this)'>+<span class="">391</span>:                 vfunc = lambda a: special.digamma(0.5*(a+2)) - np.log(0.5*(a+2)) - special.digamma(0.5*a) + np.log(0.5*a) + (1./m)*np.sum(np.log(wn) - wn) + 1</pre>
<pre class='cython code score-542 '>/* Python wrapper */
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_17cycompute_weights_lambda(PyObject *__pyx_self, PyObject *__pyx_v_a); /*proto*/
static PyMethodDef __pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_17cycompute_weights_lambda = {"lambda", (PyCFunction)__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_17cycompute_weights_lambda, METH_O, 0};
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_17cycompute_weights_lambda(PyObject *__pyx_self, PyObject *__pyx_v_a) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda(__pyx_self, ((PyObject *)__pyx_v_a));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda(PyObject *__pyx_self, PyObject *__pyx_v_a) {
  struct __pyx_obj_7cubecal_7kernels_16cyfull_W_complex___pyx_scope_struct____pyx_fuse_0cycompute_weights *__pyx_cur_scope;
  struct __pyx_obj_7cubecal_7kernels_16cyfull_W_complex___pyx_scope_struct____pyx_fuse_0cycompute_weights *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda", 0);
  __pyx_outer_scope = (struct __pyx_obj_7cubecal_7kernels_16cyfull_W_complex___pyx_scope_struct____pyx_fuse_0cycompute_weights *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_special);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_digamma);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_a, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_a, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_special);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_digamma);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_v_a);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_v_a);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1); __pyx_t_1 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((1. / __pyx_cur_scope-&gt;__pyx_v_m));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_wn.memview)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("wn"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_cur_scope-&gt;__pyx_v_wn, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_5numpy_double_t, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_5numpy_double_t, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  if (!__pyx_t_8) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8); __pyx_t_8 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_wn.memview)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("wn"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_cur_scope-&gt;__pyx_v_wn, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_5numpy_double_t, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_5numpy_double_t, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_7) {
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_7); __pyx_t_7 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_9);
    __pyx_t_9 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_6, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_weights.lambda", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
        __pyx_t_18 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_17cycompute_weights_lambda, 0, __pyx_n_s_pyx_fuse_0cycompute_weights_lo, ((PyObject*)__pyx_cur_scope), __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_vfunc, __pyx_t_18);
        __pyx_t_18 = 0;
/* … */
/* Python wrapper */
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_17cycompute_weights_1lambda1(PyObject *__pyx_self, PyObject *__pyx_v_a); /*proto*/
static PyMethodDef __pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_17cycompute_weights_1lambda1 = {"lambda1", (PyCFunction)__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_17cycompute_weights_1lambda1, METH_O, 0};
static PyObject *__pyx_pw_7cubecal_7kernels_16cyfull_W_complex_17cycompute_weights_1lambda1(PyObject *__pyx_self, PyObject *__pyx_v_a) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda1 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda1(__pyx_self, ((PyObject *)__pyx_v_a));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda1(PyObject *__pyx_self, PyObject *__pyx_v_a) {
  struct __pyx_obj_7cubecal_7kernels_16cyfull_W_complex___pyx_scope_struct_1___pyx_fuse_1cycompute_weights *__pyx_cur_scope;
  struct __pyx_obj_7cubecal_7kernels_16cyfull_W_complex___pyx_scope_struct_1___pyx_fuse_1cycompute_weights *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda1", 0);
  __pyx_outer_scope = (struct __pyx_obj_7cubecal_7kernels_16cyfull_W_complex___pyx_scope_struct_1___pyx_fuse_1cycompute_weights *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_special);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_digamma);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_a, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_a, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_special);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_digamma);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_v_a);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_v_a);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1); __pyx_t_1 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((1. / __pyx_cur_scope-&gt;__pyx_v_m));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_wn.memview)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("wn"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_cur_scope-&gt;__pyx_v_wn, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_5numpy_double_t, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_5numpy_double_t, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  if (!__pyx_t_8) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8); __pyx_t_8 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_wn.memview)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("wn"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_cur_scope-&gt;__pyx_v_wn, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_5numpy_double_t, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_5numpy_double_t, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_7) {
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_7); __pyx_t_7 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_9);
    __pyx_t_9 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_6, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cubecal.kernels.cyfull_W_complex.cycompute_weights.lambda1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
        __pyx_t_18 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_7cubecal_7kernels_16cyfull_W_complex_17cycompute_weights_1lambda1, 0, __pyx_n_s_pyx_fuse_1cycompute_weights_lo, ((PyObject*)__pyx_cur_scope), __pyx_n_s_cubecal_kernels_cyfull_W_complex, __pyx_d, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_vfunc, __pyx_t_18);
        __pyx_t_18 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">392</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">393</span>: </pre>
<pre class="cython line score-96" onclick='toggleDiv(this)'>+<span class="">394</span>:                 d = fsolve(vfunc,v[i,t,f])</pre>
<pre class='cython code score-96 '>        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_fsolve);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_v_i);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_v_t);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2, __pyx_v_f);
        __pyx_t_21 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_v), __pyx_t_11);<span class='error_goto'> if (unlikely(__pyx_t_21 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_11 = NULL;
        __pyx_t_12 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
          __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
          if (likely(__pyx_t_11)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
            __pyx_t_12 = 1;
          }
        }
        __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        if (__pyx_t_11) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_t_11); __pyx_t_11 = NULL;
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vfunc);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vfunc);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0+__pyx_t_12, __pyx_v_vfunc);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1+__pyx_t_12, __pyx_t_21);
        __pyx_t_21 = 0;
        __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_17, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_28 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_18);<span class='error_goto'> if (unlikely((__pyx_t_28 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_v_d = __pyx_t_28;
/* … */
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_fsolve);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_v_i);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_v_t);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2, __pyx_v_f);
        __pyx_t_21 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_v), __pyx_t_11);<span class='error_goto'> if (unlikely(__pyx_t_21 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_11 = NULL;
        __pyx_t_12 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
          __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
          if (likely(__pyx_t_11)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
            __pyx_t_12 = 1;
          }
        }
        __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        if (__pyx_t_11) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_t_11); __pyx_t_11 = NULL;
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vfunc);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vfunc);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0+__pyx_t_12, __pyx_v_vfunc);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1+__pyx_t_12, __pyx_t_21);
        __pyx_t_21 = 0;
        __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_17, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_28 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_18);<span class='error_goto'> if (unlikely((__pyx_t_28 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_v_d = __pyx_t_28;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">395</span>:                 if d &gt; 30 or d&lt;2:</pre>
<pre class='cython code score-0 '>        __pyx_t_30 = ((__pyx_v_d &gt; 30.0) != 0);
        if (!__pyx_t_30) {
        } else {
          __pyx_t_29 = __pyx_t_30;
          goto __pyx_L20_bool_binop_done;
        }
        __pyx_t_30 = ((__pyx_v_d &lt; 2.0) != 0);
        __pyx_t_29 = __pyx_t_30;
        __pyx_L20_bool_binop_done:;
        if (__pyx_t_29) {
/* … */
          goto __pyx_L19;
        }
/* … */
        __pyx_t_30 = ((__pyx_v_d &gt; 30.0) != 0);
        if (!__pyx_t_30) {
        } else {
          __pyx_t_29 = __pyx_t_30;
          goto __pyx_L20_bool_binop_done;
        }
        __pyx_t_30 = ((__pyx_v_d &lt; 2.0) != 0);
        __pyx_t_29 = __pyx_t_30;
        __pyx_L20_bool_binop_done:;
        if (__pyx_t_29) {
/* … */
          goto __pyx_L19;
        }
</pre><pre class="cython line score-70" onclick='toggleDiv(this)'>+<span class="">396</span>:                     v[i,t,f] = v[i,t,f]</pre>
<pre class='cython code score-70 '>          __pyx_t_18 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0, __pyx_v_i);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 1, __pyx_v_t);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 2, __pyx_v_f);
          __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_v), __pyx_t_18);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
          __pyx_t_18 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0, __pyx_v_i);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 1, __pyx_v_t);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 2, __pyx_v_f);
          if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_v), __pyx_t_18, __pyx_t_2) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
          __pyx_t_18 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0, __pyx_v_i);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 1, __pyx_v_t);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 2, __pyx_v_f);
          __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_v), __pyx_t_18);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
          __pyx_t_18 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0, __pyx_v_i);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 1, __pyx_v_t);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 2, __pyx_v_f);
          if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_v), __pyx_t_18, __pyx_t_2) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">397</span>:                 else:</pre>
<pre class="cython line score-46" onclick='toggleDiv(this)'>+<span class="">398</span>:                     v[i,t,f] = d</pre>
<pre class='cython code score-46 '>        /*else*/ {
          __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_d);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_18 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0, __pyx_v_i);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 1, __pyx_v_t);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 2, __pyx_v_f);
          if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_v), __pyx_t_18, __pyx_t_2) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        }
        __pyx_L19:;
/* … */
        /*else*/ {
          __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_d);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_18 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0, __pyx_v_i);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 1, __pyx_v_t);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_f);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_f);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 2, __pyx_v_f);
          if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_v), __pyx_t_18, __pyx_t_2) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        }
        __pyx_L19:;
</pre></div></body></html>
